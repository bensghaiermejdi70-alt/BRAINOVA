<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brainova Crash</title>
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Orbitron', 'Arial', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #00ffff;
            overflow: hidden;
            user-select: none;
        }

        .game-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: rgba(0, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid #00ffff;
            flex-wrap: wrap;
            gap: 10px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            text-shadow: 0 0 20px #00ffff;
            animation: glow 2s ease-in-out infinite alternate;
        }

        .game-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .control-btn {
            background: linear-gradient(45deg, #00ffff, #0080ff);
            border: none;
            color: #000;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
        }

        .control-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        .control-btn.active {
            background: linear-gradient(45deg, #ff0080, #ff4080);
            color: white;
        }

        @keyframes glow {
            from { text-shadow: 0 0 20px #00ffff; }
            to { text-shadow: 0 0 30px #00ffff, 0 0 40px #00ffff; }
        }

        .stats {
            display: flex;
            gap: 20px;
            font-size: 14px;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px 10px;
            background: rgba(0, 255, 255, 0.2);
            border-radius: 10px;
            border: 1px solid #00ffff;
        }

        .language-selector {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }

        .language-btn {
            background: rgba(0, 255, 255, 0.2);
            border: 1px solid #00ffff;
            color: #00ffff;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .game-board {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            grid-template-rows: repeat(8, 1fr);
            gap: 3px;
            width: min(80vw, 80vh);
            height: min(80vw, 80vh);
            background: rgba(0, 255, 255, 0.1);
            border: 3px solid #00ffff;
            border-radius: 15px;
            padding: 10px;
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.3);
        }

        .board.paused {
            filter: blur(5px);
            pointer-events: none;
        }

        .cell {
            aspect-ratio: 1;
            border-radius: 8px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            text-shadow: 0 0 10px currentColor;
            border: 2px solid transparent;
        }

        .cell:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px currentColor;
            cursor: pointer;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }
        
        .cell:active {
            transform: scale(0.95);
        }

        .cell.selected {
            border-color: #ffff00;
            box-shadow: 0 0 30px #ffff00;
            animation: pulse 0.5s ease-in-out infinite alternate;
        }

        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }

        .cell.matching {
            animation: match-glow 0.5s ease-in-out;
        }

        @keyframes match-glow {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); box-shadow: 0 0 40px currentColor; }
            100% { transform: scale(0); opacity: 0; }
        }

        .type-0 { background: linear-gradient(45deg, #ff0080, #ff4080); color: #ff0080; }
        .type-1 { background: linear-gradient(45deg, #00ff80, #40ff80); color: #00ff80; }
        .type-2 { background: linear-gradient(45deg, #8000ff, #a040ff); color: #8000ff; }
        .type-3 { background: linear-gradient(45deg, #ff8000, #ffa040); color: #ff8000; }
        .type-4 { background: linear-gradient(45deg, #0080ff, #4080ff); color: #0080ff; }
        .type-5 { background: linear-gradient(45deg, #ffff00, #ffff40); color: #ffff00; }

        .power-up {
            position: relative;
        }

        .power-up::after {
            content: '‚ö°';
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 12px;
            color: #ffff00;
            animation: spark 1s ease-in-out infinite;
        }

        @keyframes spark {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .sidebar {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 200px;
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid #00ffff;
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .power-ups {
            margin-bottom: 20px;
        }

        .power-up-btn {
            display: block;
            width: 100%;
            margin: 10px 0;
            padding: 10px;
            background: linear-gradient(45deg, #ff0080, #8000ff);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .power-up-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 0, 128, 0.5);
        }

        .power-up-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .leaderboard {
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid #00ffff;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .leaderboard h3 {
            margin: 0 0 10px 0;
            text-align: center;
            color: #00ffff;
        }

        .leaderboard-entry {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px solid rgba(0, 255, 255, 0.3);
        }

        .particles {
            position: absolute;
            pointer-events: none;
            z-index: 100;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #00ffff;
            border-radius: 50%;
            animation: particle-float 2s ease-out forwards;
        }

        @keyframes particle-float {
            0% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
            100% {
                opacity: 0;
                transform: scale(0) translateY(-100px);
            }
        }

        @keyframes slideDown {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            100% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        @keyframes slideUp {
            0% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
        }

        .level-complete {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .level-complete-content {
            background: linear-gradient(45deg, #1a1a2e, #16213e);
            border: 3px solid #00ffff;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.5);
        }

        .level-complete h2 {
            font-size: 36px;
            margin-bottom: 20px;
            animation: glow 1s ease-in-out infinite alternate;
        }

        .continue-btn {
            background: linear-gradient(45deg, #00ff80, #00ffff);
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            color: #000;
            font-weight: bold;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .continue-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(0, 255, 128, 0.5);
        }

        .pause-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .pause-content {
            background: linear-gradient(45deg, #1a1a2e, #16213e);
            border: 3px solid #00ffff;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.5);
        }

        .pause-content h2 {
            font-size: 36px;
            margin-bottom: 20px;
            color: #00ffff;
        }

        .game-over {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .game-over-content {
            background: linear-gradient(45deg, #1a1a2e, #16213e);
            border: 3px solid #ff0080;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 0 50px rgba(255, 0, 128, 0.5);
        }

        .game-over h2 {
            font-size: 36px;
            margin-bottom: 20px;
            color: #ff0080;
        }

        .start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .start-content {
            background: rgba(0, 255, 255, 0.1);
            border: 3px solid #00ffff;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.5);
            backdrop-filter: blur(10px);
            max-width: 500px;
            width: 90%;
        }

        .start-content h1 {
            font-size: 48px;
            margin-bottom: 20px;
            animation: glow 2s ease-in-out infinite alternate;
            color: #00ffff;
        }

        .start-content p {
            font-size: 18px;
            margin-bottom: 30px;
            color: #ffffff;
            opacity: 0.9;
        }

        .start-features {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 30px 0;
        }

        .feature {
            background: rgba(0, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #00ffff;
            font-size: 14px;
            color: #ffffff;
        }

        .start-btn {
            background: linear-gradient(45deg, #00ff80, #00ffff);
            border: none;
            padding: 20px 40px;
            border-radius: 15px;
            color: #000;
            font-weight: bold;
            font-size: 20px;
            cursor: pointer;
            margin: 20px 0;
            transition: all 0.3s ease;
            box-shadow: 0 0 30px rgba(0, 255, 128, 0.3);
        }

        .start-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 50px rgba(0, 255, 128, 0.5);
        }

        .difficulty-selector {
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .difficulty-selector label {
            color: #00ffff;
            font-weight: bold;
        }

        .difficulty-selector select {
            background: rgba(0, 255, 255, 0.2);
            border: 1px solid #00ffff;
            color: #00ffff;
            padding: 8px 12px;
            border-radius: 8px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 10px;
            }

            .game-controls {
                order: -1;
            }

            .control-btn {
                padding: 6px 8px;
                font-size: 10px;
            }

            .sidebar {
                position: fixed;
                bottom: 0;
                right: 0;
                left: 0;
                top: auto;
                transform: none;
                width: auto;
                border-radius: 15px 15px 0 0;
                display: flex;
                justify-content: space-around;
                align-items: center;
                padding: 10px;
            }

            .power-ups {
                display: flex;
                gap: 10px;
                margin: 0;
            }

            .power-up-btn {
                margin: 0;
                padding: 8px 12px;
                font-size: 12px;
            }

            .leaderboard {
                display: none;
            }

            .board {
                width: 90vw;
                height: 90vw;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="language-selector">
            <select class="language-btn" id="languageSelect">
                <option value="fr">Fran√ßais</option>
                <option value="en">English</option>
                <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                <option value="es">Espa√±ol</option>
                <option value="de">Deutsch</option>
                <option value="zh">‰∏≠Êñá</option>
            </select>
        </div>

        <div class="header">
            <div class="logo" id="gameTitle">BRAINOVA CRASH</div>
            <div class="game-controls">
                <button class="control-btn" onclick="pauseGame()" id="pauseBtn">‚è∏Ô∏è <span id="pauseText">Pause</span></button>
                <button class="control-btn" onclick="resetGame()" id="resetBtn">üîÑ <span id="resetText">Reset</span></button>
                <button class="control-btn" onclick="toggleSound()" id="soundBtn">üîä <span id="soundText">Son</span></button>
                <button class="control-btn" onclick="toggleFullscreen()" id="fullscreenBtn">‚õ∂ <span id="fullscreenText">Plein √©cran</span></button>
                <button class="control-btn" onclick="showHelp()" id="helpBtn">‚ùì <span id="helpText">Aide</span></button>
                <button class="control-btn" onclick="showRules()" id="rulesBtn">üìã <span id="rulesText">R√®gles</span></button>
            </div>
            <div class="stats">
                <div class="stat-item">
                    <span id="scoreLabel">Score</span>
                    <span id="score">0</span>
                </div>
                <div class="stat-item">
                    <span id="levelLabel">Niveau</span>
                    <span id="level">1</span>
                </div>
                <div class="stat-item">
                    <span id="movesLabel">Mouvements</span>
                    <span id="moves">30</span>
                </div>
                <div class="stat-item">
                    <span id="targetLabel">Objectif</span>
                    <span id="target">1000</span>
                </div>
            </div>
        </div>

        <div class="game-board">
            <div class="board" id="gameBoard"></div>
        </div>

        <div class="sidebar">
            <div class="power-ups">
                <button class="power-up-btn" id="lineClearBtn" onclick="activatePowerUp('line')">
                    <span id="lineClearText">üî• Ligne (3)</span>
                </button>
                <button class="power-up-btn" id="bombBtn" onclick="activatePowerUp('bomb')">
                    <span id="bombText">üí£ Bombe (2)</span>
                </button>
                <button class="power-up-btn" id="rainbowBtn" onclick="activatePowerUp('rainbow')">
                    <span id="rainbowText">üåà Arc-en-ciel (1)</span>
                </button>
            </div>
            
            <div class="leaderboard">
                <h3 id="leaderboardTitle">üèÜ Classement</h3>
                <div id="leaderboardList">
                    <div class="leaderboard-entry">
                        <span>1. Joueur</span>
                        <span id="topScore">0</span>
                    </div>
                    <div class="leaderboard-entry">
                        <span>2. IA</span>
                        <span>12,350</span>
                    </div>
                    <div class="leaderboard-entry">
                        <span>3. Bot</span>
                        <span>9,870</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pause Overlay -->
        <div class="pause-overlay" id="pauseOverlay">
            <div class="pause-content">
                <h2 id="pauseTitle">‚è∏Ô∏è Jeu en Pause</h2>
                <p id="pauseMessage">Cliquez sur Reprendre pour continuer</p>
                <button class="continue-btn" onclick="resumeGame()" id="resumeBtn">‚ñ∂Ô∏è Reprendre</button>
            </div>
        </div>

        <!-- Game Over Overlay -->
        <div class="game-over" id="gameOver">
            <div class="game-over-content">
                <h2 id="gameOverTitle">üíÄ Game Over</h2>
                <p id="gameOverMessage">Plus de mouvements! Score final: <span id="gameOverScore">0</span></p>
                <button class="continue-btn" onclick="restartGame()" id="restartBtn">üîÑ Recommencer</button>
            </div>
        </div>

        <!-- Start Screen -->
        <div class="start-screen" id="startScreen">
            <div class="start-content">
                <h1 id="startTitle">üöÄ BRAINOVA CRASH</h1>
                <p id="startDescription">Alignez 3 symboles identiques ou plus pour marquer des points!</p>
                <div class="start-features">
                    <div class="feature">üéØ <span id="feature1">Objectifs √† atteindre</span></div>
                    <div class="feature">‚ö° <span id="feature2">Power-ups magiques</span></div>
                    <div class="feature">üèÜ <span id="feature3">Syst√®me de score</span></div>
                    <div class="feature">üåç <span id="feature4">Multi-langues</span></div>
                </div>
                <button class="start-btn" onclick="startGame()" id="startBtn">üéÆ Commencer √† Jouer</button>
                <div class="difficulty-selector">
                    <label id="difficultyLabel">Difficult√©:</label>
                    <select id="difficultySelect">
                        <option value="easy" id="easyOption">Facile</option>
                        <option value="normal" id="normalOption" selected>Normal</option>
                        <option value="hard" id="hardOption">Difficile</option>
                    </select>
                </div>
                <div style="margin-top: 20px; font-size: 12px; color: #00ffff; opacity: 0.7;">
                    üí° Cliquez sur deux cellules adjacentes pour les √©changer
                </div>
            </div>
        </div>

        <!-- Level Complete -->
        <div class="level-complete" id="levelComplete">
            <div class="level-complete-content">
                <h2 id="levelCompleteTitle">üéâ Niveau Termin√©!</h2>
                <p id="levelCompleteText">F√©licitations! Vous avez termin√© le niveau avec un score de <span id="finalScore">0</span> points!</p>
                <button class="continue-btn" onclick="nextLevel()" id="continueBtn">‚û°Ô∏è Niveau Suivant</button>
            </div>
        </div>

        <div class="particles" id="particles"></div>
    </div>

    <script>
        // Syst√®me de traduction
        const translations = {
            fr: {
                gameTitle: "BRAINOVA CRASH",
                scoreLabel: "Score",
                levelLabel: "Niveau",
                movesLabel: "Mouvements",
                targetLabel: "Objectif",
                pauseText: "Pause",
                resetText: "Reset",
                soundText: "Son",
                fullscreenText: "Plein √©cran",
                helpText: "Aide",
                rulesText: "R√®gles",
                lineClearText: "üî• Ligne",
                bombText: "üí£ Bombe",
                rainbowText: "üåà Arc-en-ciel",
                leaderboardTitle: "üèÜ Classement",
                levelCompleteTitle: "üéâ Niveau Termin√©!",
                levelCompleteText: "F√©licitations! Vous avez termin√© le niveau avec un score de",
                continueBtn: "‚û°Ô∏è Niveau Suivant",
                pauseTitle: "‚è∏Ô∏è Jeu en Pause",
                pauseMessage: "Cliquez sur Reprendre pour continuer",
                resumeBtn: "‚ñ∂Ô∏è Reprendre",
                gameOverTitle: "üíÄ Game Over",
                gameOverMessage: "Plus de mouvements! Score final:",
                restartBtn: "üîÑ Recommencer",
                startTitle: "üöÄ BRAINOVA CRASH",
                startDescription: "Alignez 3 symboles identiques ou plus pour marquer des points!",
                startBtn: "üéÆ Commencer √† Jouer",
                feature1: "Objectifs √† atteindre",
                feature2: "Power-ups magiques",
                feature3: "Syst√®me de score",
                feature4: "Multi-langues",
                difficultyLabel: "Difficult√©:",
                easyOption: "Facile",
                normalOption: "Normal",
                hardOption: "Difficile"
            },
            en: {
                gameTitle: "BRAINOVA CRASH",
                scoreLabel: "Score",
                levelLabel: "Level",
                movesLabel: "Moves",
                targetLabel: "Target",
                pauseText: "Pause",
                resetText: "Reset",
                soundText: "Sound",
                fullscreenText: "Fullscreen",
                helpText: "Help",
                rulesText: "Rules",
                lineClearText: "üî• Line",
                bombText: "üí£ Bomb",
                rainbowText: "üåà Rainbow",
                leaderboardTitle: "üèÜ Leaderboard",
                levelCompleteTitle: "üéâ Level Complete!",
                levelCompleteText: "Congratulations! You completed the level with a score of",
                continueBtn: "‚û°Ô∏è Next Level",
                pauseTitle: "‚è∏Ô∏è Game Paused",
                pauseMessage: "Click Resume to continue",
                resumeBtn: "‚ñ∂Ô∏è Resume",
                gameOverTitle: "üíÄ Game Over",
                gameOverMessage: "No more moves! Final score:",
                restartBtn: "üîÑ Restart",
                startTitle: "üöÄ BRAINOVA CRASH",
                startDescription: "Match 3 or more identical symbols to score points!",
                startBtn: "üéÆ Start Playing",
                feature1: "Targets to reach",
                feature2: "Magic power-ups",
                feature3: "Scoring system",
                feature4: "Multi-language",
                difficultyLabel: "Difficulty:",
                easyOption: "Easy",
                normalOption: "Normal",
                hardOption: "Hard"
            },
            ar: {
                gameTitle: "ÿ®ÿ±ŸäŸÜŸàŸÅÿß ŸÉÿ±ÿßÿ¥",
                scoreLabel: "ÿßŸÑŸÜŸÇÿßÿ∑",
                levelLabel: "ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ",
                movesLabel: "ÿßŸÑÿ≠ÿ±ŸÉÿßÿ™",
                targetLabel: "ÿßŸÑŸáÿØŸÅ",
                pauseText: "ÿ•ŸäŸÇÿßŸÅ",
                resetText: "ÿ•ÿπÿßÿØÿ©",
                soundText: "ÿµŸàÿ™",
                fullscreenText: "ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©",
                helpText: "ŸÖÿ≥ÿßÿπÿØÿ©",
                rulesText: "ÿßŸÑŸÇŸàÿßÿπÿØ",
                lineClearText: "üî• ÿÆÿ∑",
                bombText: "üí£ ŸÇŸÜÿ®ŸÑÿ©",
                rainbowText: "üåà ŸÇŸàÿ≥ ŸÇÿ≤ÿ≠",
                leaderboardTitle: "üèÜ ÿßŸÑŸÖÿ™ÿµÿØÿ±ŸäŸÜ",
                levelCompleteTitle: "üéâ !ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ ŸÖŸÉÿ™ŸÖŸÑ",
                levelCompleteText: "ÿ™ŸáÿßŸÜŸäŸÜÿß! ŸÑŸÇÿØ ÿ£ŸÉŸÖŸÑÿ™ ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ ÿ®ŸÜŸÇÿßÿ∑",
                continueBtn: "‚û°Ô∏è ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ™ÿßŸÑŸä",
                pauseTitle: "‚è∏Ô∏è ÿßŸÑŸÑÿπÿ®ÿ© ŸÖÿ™ŸàŸÇŸÅÿ©",
                pauseMessage: "ÿßŸÜŸÇÿ± ÿπŸÑŸâ ÿßÿ≥ÿ™ÿ¶ŸÜÿßŸÅ ŸÑŸÑŸÖÿ™ÿßÿ®ÿπÿ©",
                resumeBtn: "‚ñ∂Ô∏è ÿßÿ≥ÿ™ÿ¶ŸÜÿßŸÅ",
                gameOverTitle: "üíÄ ÿßŸÜÿ™Ÿáÿ™ ÿßŸÑŸÑÿπÿ®ÿ©",
                gameOverMessage: "ŸÑÿß ŸÖÿ≤ŸäÿØ ŸÖŸÜ ÿßŸÑÿ≠ÿ±ŸÉÿßÿ™! ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© ÿßŸÑŸÜŸáÿßÿ¶Ÿäÿ©:",
                restartBtn: "üîÑ ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ®ÿØÿ°",
                startTitle: "üöÄ ÿ®ÿ±ŸäŸÜŸàŸÅÿß ŸÉÿ±ÿßÿ¥",
                startDescription: "!ÿßÿ±ÿ®ÿ∑ 3 ÿ±ŸÖŸàÿ≤ ŸÖÿ™ÿ∑ÿßÿ®ŸÇÿ© ÿ£Ÿà ÿ£ŸÉÿ´ÿ± ŸÑÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑŸÜŸÇÿßÿ∑",
                startBtn: "üéÆ ÿßÿ®ÿØÿ£ ÿßŸÑŸÑÿπÿ®",
                feature1: "ÿ£ŸáÿØÿßŸÅ ŸÑŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸäŸáÿß",
                feature2: "ŸÇŸàŸâ ÿ≥ÿ≠ÿ±Ÿäÿ©",
                feature3: "ŸÜÿ∏ÿßŸÖ ÿßŸÑŸÜŸÇÿßÿ∑",
                feature4: "ŸÖÿ™ÿπÿØÿØ ÿßŸÑŸÑÿ∫ÿßÿ™",
                difficultyLabel: ":ÿßŸÑÿµÿπŸàÿ®ÿ©",
                easyOption: "ÿ≥ŸáŸÑ",
                normalOption: "ÿπÿßÿØŸä",
                hardOption: "ÿµÿπÿ®"
            },
            es: {
                gameTitle: "BRAINOVA CRASH",
                scoreLabel: "Puntos",
                levelLabel: "Nivel",
                movesLabel: "Movimientos",
                targetLabel: "Objetivo",
                pauseText: "Pausa",
                resetText: "Reiniciar",
                soundText: "Sonido",
                fullscreenText: "Pantalla completa",
                helpText: "Ayuda",
                rulesText: "Reglas",
                lineClearText: "üî• L√≠nea",
                bombText: "üí£ Bomba",
                rainbowText: "üåà Arco√≠ris",
                leaderboardTitle: "üèÜ Clasificaci√≥n",
                levelCompleteTitle: "üéâ ¬°Nivel Completado!",
                levelCompleteText: "¬°Felicidades! Completaste el nivel con una puntuaci√≥n de",
                continueBtn: "‚û°Ô∏è Siguiente Nivel",
                pauseTitle: "‚è∏Ô∏è Juego Pausado",
                pauseMessage: "Haz clic en Reanudar para continuar",
                resumeBtn: "‚ñ∂Ô∏è Reanudar",
                gameOverTitle: "üíÄ Game Over",
                gameOverMessage: "¬°No m√°s movimientos! Puntuaci√≥n final:",
                restartBtn: "üîÑ Reiniciar",
                startTitle: "üöÄ BRAINOVA CRASH",
                startDescription: "¬°Conecta 3 o m√°s s√≠mbolos id√©nticos para anotar puntos!",
                startBtn: "üéÆ Empezar a Jugar",
                feature1: "Objetivos que alcanzar",
                feature2: "Power-ups m√°gicos",
                feature3: "Sistema de puntuaci√≥n",
                feature4: "Multi-idioma",
                difficultyLabel: "Dificultad:",
                easyOption: "F√°cil",
                normalOption: "Normal",
                hardOption: "Dif√≠cil"
            },
            de: {
                gameTitle: "BRAINOVA CRASH",
                scoreLabel: "Punkte",
                levelLabel: "Level",
                movesLabel: "Z√ºge",
                targetLabel: "Ziel",
                pauseText: "Pause",
                resetText: "Zur√ºcksetzen",
                soundText: "Ton",
                fullscreenText: "Vollbild",
                helpText: "Hilfe",
                rulesText: "Regeln",
                lineClearText: "üî• Linie",
                bombText: "üí£ Bombe",
                rainbowText: "üåà Regenbogen",
                leaderboardTitle: "üèÜ Bestenliste",
                levelCompleteTitle: "üéâ Level Abgeschlossen!",
                levelCompleteText: "Gl√ºckwunsch! Du hast das Level mit einer Punktzahl von",
                continueBtn: "‚û°Ô∏è N√§chstes Level",
                pauseTitle: "‚è∏Ô∏è Spiel Pausiert",
                pauseMessage: "Klicke auf Fortsetzen um weiterzumachen",
                resumeBtn: "‚ñ∂Ô∏è Fortsetzen",
                gameOverTitle: "üíÄ Game Over",
                gameOverMessage: "Keine Z√ºge mehr! Endpunktzahl:",
                restartBtn: "üîÑ Neustart",
                startTitle: "üöÄ BRAINOVA CRASH",
                startDescription: "Verbinde 3 oder mehr identische Symbole um Punkte zu erzielen!",
                startBtn: "üéÆ Spielen Starten",
                feature1: "Ziele zu erreichen",
                feature2: "Magische Power-ups",
                feature3: "Punktesystem",
                feature4: "Mehrsprachig",
                difficultyLabel: "Schwierigkeit:",
                easyOption: "Einfach",
                normalOption: "Normal",
                hardOption: "Schwer"
            },
            zh: {
                gameTitle: "ËÑëÂäõÂÜ≤Âáª",
                scoreLabel: "ÂàÜÊï∞",
                levelLabel: "ÂÖ≥Âç°",
                movesLabel: "ÁßªÂä®",
                targetLabel: "ÁõÆÊ†á",
                pauseText: "ÊöÇÂÅú",
                resetText: "ÈáçÁΩÆ",
                soundText: "Â£∞Èü≥",
                fullscreenText: "ÂÖ®Â±è",
                helpText: "Â∏ÆÂä©",
                rulesText: "ËßÑÂàô",
                lineClearText: "üî• Áõ¥Á∫ø",
                bombText: "üí£ ÁÇ∏Âºπ",
                rainbowText: "üåà ÂΩ©Ëôπ",
                leaderboardTitle: "üèÜ ÊéíË°åÊ¶ú",
                levelCompleteTitle: "üéâ ÂÖ≥Âç°ÂÆåÊàêÔºÅ",
                levelCompleteText: "ÊÅ≠ÂñúÔºÅÊÇ®‰ª•",
                continueBtn: "‚û°Ô∏è ‰∏ã‰∏ÄÂÖ≥",
                pauseTitle: "‚è∏Ô∏è Ê∏∏ÊàèÊöÇÂÅú",
                pauseMessage: "ÁÇπÂáªÁªßÁª≠Êù•ÁªßÁª≠Ê∏∏Êàè",
                resumeBtn: "‚ñ∂Ô∏è ÁªßÁª≠",
                gameOverTitle: "üíÄ Ê∏∏ÊàèÁªìÊùü",
                gameOverMessage: "Ê≤°ÊúâÊõ¥Â§öÁßªÂä®ÔºÅÊúÄÁªàÂæóÂàÜÔºö",
                restartBtn: "üîÑ ÈáçÊñ∞ÂºÄÂßã",
                startTitle: "üöÄ ËÑëÂäõÂÜ≤Âáª",
                startDescription: "ËøûÊé•3‰∏™ÊàñÊõ¥Â§öÁõ∏ÂêåÁ¨¶Âè∑Êù•ÂæóÂàÜÔºÅ",
                startBtn: "üéÆ ÂºÄÂßãÊ∏∏Êàè",
                feature1: "Ë¶ÅËææÊàêÁöÑÁõÆÊ†á",
                feature2: "È≠îÊ≥ïÈÅìÂÖ∑",
                feature3: "ËÆ°ÂàÜÁ≥ªÁªü",
                feature4: "Â§öËØ≠Ë®ÄÊîØÊåÅ",
                difficultyLabel: "ÈöæÂ∫¶Ôºö",
                easyOption: "ÁÆÄÂçï",
                normalOption: "ÊôÆÈÄö",
                hardOption: "Âõ∞Èöæ"
            }
        };

        // √âtat du jeu
        let gameState = {
            board: [],
            score: 0,
            level: 1,
            moves: 30,
            target: 1000,
            selectedCell: null,
            powerUps: { line: 3, bomb: 2, rainbow: 1 },
            activePowerUp: null,
            currentLanguage: 'fr',
            isPaused: false,
            soundEnabled: true,
            isGameActive: false,
            gameStarted: false,
            highScore: 0,
            comboMultiplier: 1,
            difficulty: 'normal'
        };

        const BOARD_SIZE = 8;
        const CELL_TYPES = 6;
        const symbols = ['‚óÜ', '‚óè', '‚ñ≤', '‚ñ†', '‚òÖ', '‚ô¶'];

        // Sons du jeu (simulation avec des effets visuels)
        function playSound(type) {
            if (!gameState.soundEnabled) return;
            
            // Simulation d'effets sonores avec des animations visuelles
            const soundIndicator = document.createElement('div');
            soundIndicator.style.position = 'fixed';
            soundIndicator.style.top = '20px';
            soundIndicator.style.right = '20px';
            soundIndicator.style.color = '#00ffff';
            soundIndicator.style.fontSize = '20px';
            soundIndicator.style.zIndex = '9999';
            soundIndicator.style.animation = 'glow 0.5s ease-out';
            
            switch(type) {
                case 'match':
                    soundIndicator.textContent = '‚ô™ Match!';
                    break;
                case 'powerup':
                    soundIndicator.textContent = '‚ô´ Power!';
                    break;
                case 'levelup':
                    soundIndicator.textContent = '‚ô¨ Level Up!';
                    break;
                case 'gameover':
                    soundIndicator.textContent = '‚ô≠ Game Over';
                    break;
            }
            
            document.body.appendChild(soundIndicator);
            setTimeout(() => soundIndicator.remove(), 1000);
        }

        // Fonction de d√©marrage du jeu - VERSION SIMPLE
        function startGame() {
            gameState.score = 0;
            gameState.level = 1;
            gameState.moves = 30;
            gameState.target = 1000;
            gameState.selectedCell = null;
            gameState.gameStarted = true;
            gameState.isGameActive = true;
            gameState.isPaused = false;
            
            document.getElementById('startScreen').style.display = 'none';
            
            createBoard();
            updateUI();
            
            // Notification de d√©marrage
            setTimeout(() => {
                showNotification('üéÆ Jeu d√©marr√©! Cliquez sur les cellules pour jouer!', 3000);
            }, 500);
        }

        // Fonction d'acc√®s direct au jeu
        function quickStart() {
            startGame();
        }

        // Mode d√©veloppeur pour tests rapides
        function devMode() {
            gameState.powerUps = { line: 99, bomb: 99, rainbow: 99 };
            gameState.moves = 999;
            gameState.score = gameState.target - 100;
            updateUI();
            console.log('Mode d√©veloppeur activ√©');
        }

        // Auto-hint syst√®me
        function showHint() {
            if (!gameState.isGameActive || gameState.isPaused) return;
            
            // Trouver les mouvements possibles
            const possibleMoves = findPossibleMoves();
            if (possibleMoves.length > 0) {
                const hint = possibleMoves[0];
                const cell1 = document.querySelector(`[data-row="${hint.row1}"][data-col="${hint.col1}"]`);
                const cell2 = document.querySelector(`[data-row="${hint.row2}"][data-col="${hint.col2}"]`);
                
                // Effet visuel d'indice
                cell1.style.border = '3px solid #ffff00';
                cell2.style.border = '3px solid #ffff00';
                cell1.style.animation = 'pulse 1s ease-in-out 3';
                cell2.style.animation = 'pulse 1s ease-in-out 3';
                
                setTimeout(() => {
                    cell1.style.border = '';
                    cell2.style.border = '';
                    cell1.style.animation = '';
                    cell2.style.animation = '';
                }, 3000);
            }
        }

        // Trouver les mouvements possibles
        function findPossibleMoves() {
            const moves = [];
            for (let row = 0; row < BOARD_SIZE; row++) {
                for (let col = 0; col < BOARD_SIZE; col++) {
                    // V√©rifier √©change horizontal
                    if (col < BOARD_SIZE - 1) {
                        swapForTest(row, col, row, col + 1);
                        if (findMatches().length > 0) {
                            moves.push({row1: row, col1: col, row2: row, col2: col + 1});
                        }
                        swapForTest(row, col, row, col + 1); // Remettre
                    }
                    // V√©rifier √©change vertical
                    if (row < BOARD_SIZE - 1) {
                        swapForTest(row, col, row + 1, col);
                        if (findMatches().length > 0) {
                            moves.push({row1: row, col1: col, row2: row + 1, col2: col});
                        }
                        swapForTest(row, col, row + 1, col); // Remettre
                    }
                }
            }
            return moves;
        }

        // √âchange temporaire pour test
        function swapForTest(row1, col1, row2, col2) {
            const temp = gameState.board[row1][col1];
            gameState.board[row1][col1] = gameState.board[row2][col2];
            gameState.board[row2][col2] = temp;
        }

        // Mode auto-play pour d√©monstration
        function autoPlay() {
            if (!gameState.isGameActive || gameState.isPaused) return;
            
            const moves = findPossibleMoves();
            if (moves.length > 0 && gameState.moves > 0) {
                const move = moves[0];
                swapCells(move.row1, move.col1, move.row2, move.col2);
                
                setTimeout(() => {
                    if (gameState.isGameActive && gameState.moves > 0) {
                        autoPlay();
                    }
                }, 2000);
            }
        }

        // Syst√®me de sauvegarde multiple
        function saveToCloud() {
            const saveData = {
                ...gameState,
                timestamp: Date.now(),
                version: '2.0'
            };
            
            // Sauvegarde locale
            localStorage.setItem('brainovaCrash', JSON.stringify(saveData));
            localStorage.setItem('brainovaCrash_backup', JSON.stringify(saveData));
            
            // Simulation sauvegarde cloud
            console.log('Jeu sauvegard√© dans le cloud');
            showNotification('üíæ Jeu sauvegard√©!');
        }



        // Syst√®me de succ√®s/achievements
        const achievements = {
            firstMatch: { unlocked: false, name: 'Premier Match', desc: 'Faire votre premier match' },
            combo5: { unlocked: false, name: 'Combo Master', desc: 'Faire un combo x5' },
            powerUser: { unlocked: false, name: 'Utilisateur Power', desc: 'Utiliser tous les power-ups' },
            speedster: { unlocked: false, name: 'Rapide', desc: 'Terminer un niveau en moins de 20 mouvements' },
            highScore: { unlocked: false, name: 'Score √âlev√©', desc: 'Atteindre 50,000 points' }
        };

        function checkAchievements() {
            // Premier match
            if (!achievements.firstMatch.unlocked && gameState.score > 0) {
                unlockAchievement('firstMatch');
            }
            
            // Combo master
            if (!achievements.combo5.unlocked && gameState.comboMultiplier >= 5) {
                unlockAchievement('combo5');
            }
            
            // High score
            if (!achievements.highScore.unlocked && gameState.score >= 50000) {
                unlockAchievement('highScore');
            }
            
            // Speedster
            if (!achievements.speedster.unlocked && gameState.score >= gameState.target && gameState.moves >= 10) {
                unlockAchievement('speedster');
            }
        }

        function unlockAchievement(id) {
            achievements[id].unlocked = true;
            showNotification(`üèÜ ${achievements[id].name} d√©bloqu√©!`, 5000);
            playSound('levelup');
            saveGame();
        }



        // Cr√©ation du plateau - VERSION SIMPLE ET FONCTIONNELLE
        function createBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            gameState.board = [];

            for (let row = 0; row < BOARD_SIZE; row++) {
                gameState.board[row] = [];
                for (let col = 0; col < BOARD_SIZE; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    
                    // Un seul √©v√©nement de clic simple
                    cell.addEventListener('click', handleCellClick);
                    
                    // G√©n√©rer un type al√©atoire
                    const type = Math.floor(Math.random() * CELL_TYPES);
                    gameState.board[row][col] = type;
                    
                    cell.classList.add(`type-${type}`);
                    cell.textContent = symbols[type];
                    
                    board.appendChild(cell);
                }
            }
        }

        // V√©rifier si placer un type cr√©erait un match
        function wouldCreateMatch(row, col, type) {
            // V√©rifier horizontal
            let count = 1;
            for (let c = col - 1; c >= 0 && gameState.board[row][c] === type; c--) count++;
            for (let c = col + 1; c < BOARD_SIZE && gameState.board[row][c] === type; c++) count++;
            if (count >= 3) return true;
            
            // V√©rifier vertical
            count = 1;
            for (let r = row - 1; r >= 0 && gameState.board[r][col] === type; r--) count++;
            for (let r = row + 1; r < BOARD_SIZE && gameState.board[r][col] === type; r++) count++;
            if (count >= 3) return true;
            
            return false;
        }

        // Gestion des clics sur les cellules - VERSION SIMPLIFI√âE
        function handleCellClick(event) {
            console.log('üñ±Ô∏è Clic d√©tect√© sur cellule');
            
            if (!gameState.isGameActive || gameState.isPaused) {
                console.log('‚ùå Jeu inactif ou en pause');
                return;
            }
            
            // R√©cup√©rer les coordonn√©es de la cellule cliqu√©e
            let target = event.target;
            let row = parseInt(target.dataset.row);
            let col = parseInt(target.dataset.col);
            
            // Si on a cliqu√© sur le contenu de la cellule, remonter au parent
            if (isNaN(row) || isNaN(col)) {
                target = target.closest('.cell');
                if (target) {
                    row = parseInt(target.dataset.row);
                    col = parseInt(target.dataset.col);
                }
            }
            
            if (isNaN(row) || isNaN(col)) {
                console.log('‚ùå Coordonn√©es invalides:', row, col);
                return;
            }
            
            console.log('‚úÖ Cellule cliqu√©e:', row, col);

            if (gameState.activePowerUp) {
                console.log('‚ö° Utilisation power-up');
                usePowerUp(row, col);
                return;
            }

            if (gameState.selectedCell) {
                const selectedRow = gameState.selectedCell.row;
                const selectedCol = gameState.selectedCell.col;
                
                console.log('üîÑ Cellule d√©j√† s√©lectionn√©e:', selectedRow, selectedCol);
                
                if (row === selectedRow && col === selectedCol) {
                    console.log('üîÑ D√©s√©lection de la m√™me cellule');
                    clearSelection();
                    return;
                }
                
                if (isAdjacent(selectedRow, selectedCol, row, col)) {
                    console.log('üîÑ √âchange de cellules adjacentes');
                    swapCells(selectedRow, selectedCol, row, col);
                    clearSelection();
                } else {
                    console.log('üîÑ S√©lection d\'une nouvelle cellule');
                    clearSelection();
                    selectCell(row, col);
                }
            } else {
                console.log('üéØ Premi√®re s√©lection');
                selectCell(row, col);
            }
        }

        // S√©lection d'une cellule
        function selectCell(row, col) {
            console.log('üéØ Selecting cell:', row, col);
            gameState.selectedCell = { row, col };
            const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
            if (cell) {
                cell.classList.add('selected');
                cell.style.border = '3px solid #ffff00';
                cell.style.boxShadow = '0 0 20px #ffff00';
                console.log('‚úÖ Cell selected and highlighted');
            } else {
                console.log('‚ùå Cell not found for selection');
            }
        }

        // Effacer la s√©lection
        function clearSelection() {
            if (gameState.selectedCell) {
                const cell = document.querySelector(`[data-row="${gameState.selectedCell.row}"][data-col="${gameState.selectedCell.col}"]`);
                if (cell) {
                    cell.classList.remove('selected');
                    cell.style.border = '';
                    cell.style.boxShadow = '';
                }
                gameState.selectedCell = null;
                console.log('üîÑ Selection cleared');
            }
        }

        // V√©rifier si deux cellules sont adjacentes
        function isAdjacent(row1, col1, row2, col2) {
            const rowDiff = Math.abs(row1 - row2);
            const colDiff = Math.abs(col1 - col2);
            return (rowDiff === 1 && colDiff === 0) || (rowDiff === 0 && colDiff === 1);
        }

        // √âchanger deux cellules
        function swapCells(row1, col1, row2, col2) {
            console.log('üîÑ Swapping cells:', row1, col1, 'with', row2, col2);
            
            // V√©rifier que les coordonn√©es sont valides
            if (row1 < 0 || row1 >= BOARD_SIZE || col1 < 0 || col1 >= BOARD_SIZE ||
                row2 < 0 || row2 >= BOARD_SIZE || col2 < 0 || col2 >= BOARD_SIZE) {
                console.log('‚ùå Invalid coordinates for swap');
                return;
            }
            
            const temp = gameState.board[row1][col1];
            gameState.board[row1][col1] = gameState.board[row2][col2];
            gameState.board[row2][col2] = temp;

            updateCellDisplay(row1, col1);
            updateCellDisplay(row2, col2);
            
            showNotification('üîÑ √âchange effectu√©!', 1000);

            const matches = findMatches();
            console.log('üéØ Matches found:', matches.length);
            
            if (matches.length > 0) {
                gameState.moves--;
                gameState.comboMultiplier = 1;
                showNotification(`‚ú® ${matches.length} matches trouv√©s!`, 2000);
                processMatches();
            } else {
                showNotification('‚ùå Aucun match - Annulation...', 1500);
                setTimeout(() => {
                    // Remettre les cellules √† leur place
                    const temp = gameState.board[row1][col1];
                    gameState.board[row1][col1] = gameState.board[row2][col2];
                    gameState.board[row2][col2] = temp;
                    updateCellDisplay(row1, col1);
                    updateCellDisplay(row2, col2);
                    console.log('üîÑ Swap reverted - no matches');
                }, 300);
            }
            updateUI();
        }

        // Mettre √† jour l'affichage d'une cellule
        function updateCellDisplay(row, col) {
            const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
            if (!cell) return;
            const type = gameState.board[row][col];
            cell.className = `cell type-${type}`;
            cell.textContent = symbols[type];
        }

        // Trouver les matches
        function findMatches() {
            const matches = [];
            
            // Matches horizontaux
            for (let row = 0; row < BOARD_SIZE; row++) {
                let count = 1;
                let currentType = gameState.board[row][0];
                
                for (let col = 1; col < BOARD_SIZE; col++) {
                    if (gameState.board[row][col] === currentType) {
                        count++;
                    } else {
                        if (count >= 3) {
                            for (let i = col - count; i < col; i++) {
                                matches.push({ row, col: i });
                            }
                        }
                        count = 1;
                        currentType = gameState.board[row][col];
                    }
                }
                
                if (count >= 3) {
                    for (let i = BOARD_SIZE - count; i < BOARD_SIZE; i++) {
                        matches.push({ row, col: i });
                    }
                }
            }
            
            // Matches verticaux
            for (let col = 0; col < BOARD_SIZE; col++) {
                let count = 1;
                let currentType = gameState.board[0][col];
                
                for (let row = 1; row < BOARD_SIZE; row++) {
                    if (gameState.board[row][col] === currentType) {
                        count++;
                    } else {
                        if (count >= 3) {
                            for (let i = row - count; i < row; i++) {
                                matches.push({ row: i, col });
                            }
                        }
                        count = 1;
                        currentType = gameState.board[row][col];
                    }
                }
                
                if (count >= 3) {
                    for (let i = BOARD_SIZE - count; i < BOARD_SIZE; i++) {
                        matches.push({ row: i, col });
                    }
                }
            }
            
            return matches;
        }

        // Traiter les matches
        function processMatches() {
            const matches = findMatches();
            if (matches.length > 0) {
                const baseScore = matches.length * 100;
                const comboScore = baseScore * gameState.comboMultiplier;
                gameState.score += comboScore;
                gameState.comboMultiplier += 0.5;
                
                playSound('match');
                removeMatches();
                createParticles(matches);
                
                // V√©rifier les succ√®s
                checkAchievements();
                
                setTimeout(() => {
                    dropCells();
                    fillEmptyCells();
                    
                    setTimeout(() => {
                        if (findMatches().length > 0) {
                            processMatches();
                        } else {
                            gameState.comboMultiplier = 1;
                        }
                    }, 300);
                }, 500);
            }
            
            checkGameState();
        }

        // Supprimer les matches
        function removeMatches() {
            const matches = findMatches();
            matches.forEach(match => {
                const cell = document.querySelector(`[data-row="${match.row}"][data-col="${match.col}"]`);
                if (cell) cell.classList.add('matching');
                gameState.board[match.row][match.col] = -1;
            });
        }

        // Faire tomber les cellules
        function dropCells() {
            for (let col = 0; col < BOARD_SIZE; col++) {
                let writePos = BOARD_SIZE - 1;
                
                for (let row = BOARD_SIZE - 1; row >= 0; row--) {
                    if (gameState.board[row][col] !== -1) {
                        gameState.board[writePos][col] = gameState.board[row][col];
                        if (writePos !== row) {
                            gameState.board[row][col] = -1;
                        }
                        writePos--;
                    }
                }
            }
            
            for (let row = 0; row < BOARD_SIZE; row++) {
                for (let col = 0; col < BOARD_SIZE; col++) {
                    updateCellDisplay(row, col);
                }
            }
        }

        // Remplir les cellules vides
        function fillEmptyCells() {
            for (let row = 0; row < BOARD_SIZE; row++) {
                for (let col = 0; col < BOARD_SIZE; col++) {
                    if (gameState.board[row][col] === -1) {
                        let type;
                        do {
                            type = Math.floor(Math.random() * CELL_TYPES);
                        } while (wouldCreateMatch(row, col, type));
                        
                        gameState.board[row][col] = type;
                        updateCellDisplay(row, col);
                    }
                }
            }
        }

        // Fonction de notification
        function showNotification(message, duration = 2000) {
            const notification = document.createElement('div');
            notification.style.position = 'fixed';
            notification.style.top = '50%';
            notification.style.left = '50%';
            notification.style.transform = 'translate(-50%, -50%)';
            notification.style.background = 'rgba(0, 255, 255, 0.9)';
            notification.style.color = '#000';
            notification.style.padding = '15px 25px';
            notification.style.borderRadius = '10px';
            notification.style.fontSize = '16px';
            notification.style.fontWeight = 'bold';
            notification.style.zIndex = '9999';
            notification.style.boxShadow = '0 0 20px rgba(0, 255, 255, 0.5)';
            notification.style.animation = 'slideDown 0.3s ease-out';
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideUp 0.3s ease-out';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, duration);
        }

        // Cr√©er des particules
        function createParticles(matches) {
            const particlesContainer = document.getElementById('particles');
            
            matches.forEach(match => {
                const cell = document.querySelector(`[data-row="${match.row}"][data-col="${match.col}"]`);
                if (!cell) return;
                const rect = cell.getBoundingClientRect();
                
                for (let i = 0; i < 8; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = (rect.left + rect.width / 2 + Math.random() * 20 - 10) + 'px';
                    particle.style.top = (rect.top + rect.height / 2 + Math.random() * 20 - 10) + 'px';
                    particle.style.background = `hsl(${Math.random() * 360}, 100%, 50%)`;
                    particle.style.animationDelay = Math.random() * 0.5 + 's';
                    
                    particlesContainer.appendChild(particle);
                    
                    setTimeout(() => {
                        if (particle.parentNode) particle.remove();
                    }, 2000);
                }
            });
        }

        // Activer un power-up
        function activatePowerUp(type) {
            if (gameState.powerUps[type] > 0 && gameState.isGameActive && !gameState.isPaused) {
                gameState.activePowerUp = type;
                document.body.style.cursor = 'crosshair';
                
                // Effet visuel sur le bouton
                const btn = document.getElementById(type === 'line' ? 'lineClearBtn' : type === 'bomb' ? 'bombBtn' : 'rainbowBtn');
                btn.classList.add('active');
            }
        }

        // Utiliser un power-up
        function usePowerUp(row, col) {
            if (!gameState.activePowerUp) return;
            
            const type = gameState.activePowerUp;
            gameState.powerUps[type]--;
            
            let cellsToRemove = [];
            
            switch (type) {
                case 'line':
                    for (let c = 0; c < BOARD_SIZE; c++) {
                        cellsToRemove.push({row, col: c});
                        gameState.board[row][c] = -1;
                    }
                    break;
                    
                case 'bomb':
                    for (let r = Math.max(0, row - 1); r <= Math.min(BOARD_SIZE - 1, row + 1); r++) {
                        for (let c = Math.max(0, col - 1); c <= Math.min(BOARD_SIZE - 1, col + 1); c++) {
                            cellsToRemove.push({row: r, col: c});
                            gameState.board[r][c] = -1;
                        }
                    }
                    break;
                    
                case 'rainbow':
                    const targetType = gameState.board[row][col];
                    for (let r = 0; r < BOARD_SIZE; r++) {
                        for (let c = 0; c < BOARD_SIZE; c++) {
                            if (gameState.board[r][c] === targetType) {
                                cellsToRemove.push({row: r, col: c});
                                gameState.board[r][c] = -1;
                            }
                        }
                    }
                    break;
            }
            
            gameState.activePowerUp = null;
            document.body.style.cursor = 'default';
            
            // Retirer l'effet visuel
            document.querySelectorAll('.power-up-btn').forEach(btn => btn.classList.remove('active'));
            
            playSound('powerup');
            createParticles(cellsToRemove);
            
            setTimeout(() => {
                dropCells();
                fillEmptyCells();
                processMatches();
                updateUI();
            }, 500);
        }

        // V√©rifier l'√©tat du jeu
        function checkGameState() {
            if (gameState.score >= gameState.target) {
                gameState.isGameActive = false;
                playSound('levelup');
                document.getElementById('levelComplete').style.display = 'flex';
                document.getElementById('finalScore').textContent = gameState.score;
                
                // Mettre √† jour le high score
                if (gameState.score > gameState.highScore) {
                    gameState.highScore = gameState.score;
                    document.getElementById('topScore').textContent = gameState.highScore;
                }
                
                saveGame();
            } else if (gameState.moves <= 0) {
                gameState.isGameActive = false;
                playSound('gameover');
                document.getElementById('gameOver').style.display = 'flex';
                document.getElementById('gameOverScore').textContent = gameState.score;
                
                if (gameState.score > gameState.highScore) {
                    gameState.highScore = gameState.score;
                    document.getElementById('topScore').textContent = gameState.highScore;
                }
                
                saveGame();
            }
        }

        // Niveau suivant
        function nextLevel() {
            gameState.level++;
            gameState.moves = 30 + (gameState.level * 2);
            gameState.target = Math.floor(gameState.target * 1.4);
            gameState.powerUps = { 
                line: Math.min(5, 3 + Math.floor(gameState.level / 3)), 
                bomb: Math.min(4, 2 + Math.floor(gameState.level / 4)), 
                rainbow: Math.min(3, 1 + Math.floor(gameState.level / 5)) 
            };
            
            document.getElementById('levelComplete').style.display = 'none';
            gameState.isGameActive = true;
            createBoard();
            updateUI();
            saveGame();
        }

        // Fonctions de contr√¥le du jeu
        function pauseGame() {
            if (!gameState.isGameActive) return;
            
            gameState.isPaused = !gameState.isPaused;
            const pauseOverlay = document.getElementById('pauseOverlay');
            const board = document.getElementById('gameBoard');
            
            if (gameState.isPaused) {
                pauseOverlay.style.display = 'flex';
                board.classList.add('paused');
                document.getElementById('pauseBtn').innerHTML = '‚ñ∂Ô∏è <span id="pauseText">' + translations[gameState.currentLanguage].resumeBtn.split(' ')[1] + '</span>';
            } else {
                pauseOverlay.style.display = 'none';
                board.classList.remove('paused');
                document.getElementById('pauseBtn').innerHTML = '‚è∏Ô∏è <span id="pauseText">' + translations[gameState.currentLanguage].pauseText + '</span>';
            }
        }

        function resumeGame() {
            pauseGame();
        }

        function resetGame() {
            // Non-blocking: post a confirm dialog request to parent and perform reset immediately
            try{ parent.postMessage({ action: 'dialog', dialogType: 'confirm', text: '√ätes-vous s√ªr de vouloir recommencer le niveau ?' }, '*'); }catch(e){}
            gameState.score = Math.max(0, gameState.score - Math.floor(gameState.target * 0.1));
            gameState.moves = 30 + (gameState.level * 2);
            gameState.isGameActive = true;
            gameState.isPaused = false;
            
            document.getElementById('pauseOverlay').style.display = 'none';
            document.getElementById('gameBoard').classList.remove('paused');
            
            createBoard();
            updateUI();
        }

        function restartGame() {
            gameState.level = 1;
            gameState.score = 0;
            gameState.isGameActive = false;
            gameState.isPaused = false;
            gameState.gameStarted = false;
            
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('pauseOverlay').style.display = 'none';
            document.getElementById('gameBoard').classList.remove('paused');
            document.getElementById('startScreen').style.display = 'flex';
            
            saveGame();
        }

        function toggleSound() {
            gameState.soundEnabled = !gameState.soundEnabled;
            const soundBtn = document.getElementById('soundBtn');
            if (gameState.soundEnabled) {
                soundBtn.innerHTML = 'üîä <span id="soundText">' + translations[gameState.currentLanguage].soundText + '</span>';
                soundBtn.classList.remove('active');
            } else {
                soundBtn.innerHTML = 'üîá <span id="soundText">' + translations[gameState.currentLanguage].soundText + '</span>';
                soundBtn.classList.add('active');
            }
            saveGame();
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log('Fullscreen not supported');
                });
            } else {
                document.exitFullscreen();
            }
        }

        function showHelp() {
            const helpText = gameState.currentLanguage === 'fr' ? 
                'Alignez 3 symboles identiques ou plus pour marquer des points!\n\nüî• Ligne: Supprime une ligne enti√®re\nüí£ Bombe: Supprime une zone 3x3\nüåà Arc-en-ciel: Supprime tous les symboles du m√™me type\n\nAtteignez l\'objectif avant d\'√©puiser vos mouvements!' :
                'Match 3 or more identical symbols to score points!\n\nüî• Line: Removes entire row\nüí£ Bomb: Removes 3x3 area\nüåà Rainbow: Removes all symbols of same type\n\nReach the target before running out of moves!';
            
            try{ parent.postMessage({ action: 'dialog', dialogType: 'alert', text: helpText }, '*'); }catch(e){}
        }

        function showRules() {
            const rulesText = {
                fr: 'üéÆ R√àGLES DU JEU\n\n' +
                    'üéØ OBJECTIF:\n' +
                    '‚Ä¢ Alignez 3 symboles identiques ou plus\n' +
                    '‚Ä¢ Atteignez le score cible avant d\'√©puiser vos mouvements\n\n' +
                    'üïπÔ∏è COMMENT JOUER:\n' +
                    '1. Cliquez sur une cellule pour la s√©lectionner\n' +
                    '2. Cliquez sur une cellule adjacente pour √©changer\n' +
                    '3. Les alignements de 3+ disparaissent automatiquement\n' +
                    '4. De nouveaux symboles tombent du haut\n\n' +
                    '‚ö° POWER-UPS:\n' +
                    '‚Ä¢ üî• Ligne: Supprime une ligne compl√®te\n' +
                    '‚Ä¢ üí£ Bombe: Supprime une zone 3x3\n' +
                    '‚Ä¢ üåà Arc-en-ciel: Supprime tous les symboles identiques\n\n' +
                    'üèÜ SCORING:\n' +
                    '‚Ä¢ Plus d\'alignements = plus de points\n' +
                    '‚Ä¢ Les combos multiplient le score\n' +
                    '‚Ä¢ Chaque niveau augmente la difficult√©',
                en: 'üéÆ GAME RULES\n\n' +
                    'üéØ OBJECTIVE:\n' +
                    '‚Ä¢ Match 3 or more identical symbols\n' +
                    '‚Ä¢ Reach target score before running out of moves\n\n' +
                    'üïπÔ∏è HOW TO PLAY:\n' +
                    '1. Click on a cell to select it\n' +
                    '2. Click on adjacent cell to swap\n' +
                    '3. Matches of 3+ disappear automatically\n' +
                    '4. New symbols fall from the top\n\n' +
                    '‚ö° POWER-UPS:\n' +
                    '‚Ä¢ üî• Line: Removes entire row\n' +
                    '‚Ä¢ üí£ Bomb: Removes 3x3 area\n' +
                    '‚Ä¢ üåà Rainbow: Removes all matching symbols\n\n' +
                    'üèÜ SCORING:\n' +
                    '‚Ä¢ More matches = more points\n' +
                    '‚Ä¢ Combos multiply score\n' +
                    '‚Ä¢ Each level increases difficulty',
                ar: 'üéÆ ŸÇŸàÿßÿπÿØ ÿßŸÑŸÑÿπÿ®ÿ©\n\n' +
                    'üéØ ÿßŸÑŸáÿØŸÅ:\n' +
                    '‚Ä¢ ÿßÿ±ÿ®ÿ∑ 3 ÿ±ŸÖŸàÿ≤ ŸÖÿ™ÿ∑ÿßÿ®ŸÇÿ© ÿ£Ÿà ÿ£ŸÉÿ´ÿ±\n' +
                    '‚Ä¢ ÿßŸàÿµŸÑ ŸÑŸÑŸÜŸÇÿßÿ∑ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ© ŸÇÿ®ŸÑ ÿßŸÜÿ™Ÿáÿßÿ° ÿßŸÑÿ≠ÿ±ŸÉÿßÿ™\n\n' +
                    'üïπÔ∏è ŸÉŸäŸÅŸäÿ© ÿßŸÑŸÑÿπÿ®:\n' +
                    '1. ÿßŸÜŸÇÿ± ÿπŸÑŸâ ÿÆŸÑŸäÿ© ŸÑÿ™ÿ≠ÿØŸäÿØŸáÿß\n' +
                    '2. ÿßŸÜŸÇÿ± ÿπŸÑŸâ ÿÆŸÑŸäÿ© ŸÖÿ¨ÿßŸàÿ±ÿ© ŸÑŸÑÿ™ÿ®ÿØŸäŸÑ\n' +
                    '3. ÿßŸÑÿ™ÿ∑ÿßÿ®ŸÇÿßÿ™ ŸÖŸÜ 3+ ÿ™ÿÆÿ™ŸÅŸä ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã\n' +
                    '4. ÿ±ŸÖŸàÿ≤ ÿ¨ÿØŸäÿØÿ© ÿ™ÿ≥ŸÇÿ∑ ŸÖŸÜ ÿßŸÑÿ£ÿπŸÑŸâ\n\n' +
                    '‚ö° ÿßŸÑŸÇŸàŸâ ÿßŸÑÿÆÿßÿµÿ©:\n' +
                    '‚Ä¢ üî• ÿÆÿ∑: Ÿäÿ≠ÿ∞ŸÅ ÿµŸÅ ŸÉÿßŸÖŸÑ\n' +
                    '‚Ä¢ üí£ ŸÇŸÜÿ®ŸÑÿ©: ÿ™ÿ≠ÿ∞ŸÅ ŸÖŸÜÿ∑ŸÇÿ© 3√ó3\n' +
                    '‚Ä¢ üåà ŸÇŸàÿ≥ ŸÇÿ≤ÿ≠: Ÿäÿ≠ÿ∞ŸÅ ŸÉŸÑ ÿßŸÑÿ±ŸÖŸàÿ≤ ÿßŸÑŸÖÿ™ÿ∑ÿßÿ®ŸÇÿ©\n\n' +
                    'üèÜ ÿßŸÑŸÜŸÇÿßÿ∑:\n' +
                    '‚Ä¢ ÿßŸÑŸÖÿ≤ŸäÿØ ŸÖŸÜ ÿßŸÑÿ™ÿ∑ÿßÿ®ŸÇÿßÿ™ = ÿßŸÑŸÖÿ≤ŸäÿØ ŸÖŸÜ ÿßŸÑŸÜŸÇÿßÿ∑\n' +
                    '‚Ä¢ ÿßŸÑŸÉŸàŸÖÿ®Ÿà Ÿäÿ∂ÿßÿπŸÅ ÿßŸÑŸÜŸÇÿßÿ∑\n' +
                    '‚Ä¢ ŸÉŸÑ ŸÖÿ≥ÿ™ŸàŸâ Ÿäÿ≤ŸäÿØ ÿßŸÑÿµÿπŸàÿ®ÿ©',
                es: 'üéÆ REGLAS DEL JUEGO\n\n' +
                    'üéØ OBJETIVO:\n' +
                    '‚Ä¢ Conecta 3 o m√°s s√≠mbolos id√©nticos\n' +
                    '‚Ä¢ Alcanza la puntuaci√≥n objetivo antes de quedarte sin movimientos\n\n' +
                    'üïπÔ∏è C√ìMO JUGAR:\n' +
                    '1. Haz clic en una celda para seleccionarla\n' +
                    '2. Haz clic en una celda adyacente para intercambiar\n' +
                    '3. Las coincidencias de 3+ desaparecen autom√°ticamente\n' +
                    '4. Nuevos s√≠mbolos caen desde arriba\n\n' +
                    '‚ö° POWER-UPS:\n' +
                    '‚Ä¢ üî• L√≠nea: Elimina fila completa\n' +
                    '‚Ä¢ üí£ Bomba: Elimina √°rea 3x3\n' +
                    '‚Ä¢ üåà Arco√≠ris: Elimina todos los s√≠mbolos iguales\n\n' +
                    'üèÜ PUNTUACI√ìN:\n' +
                    '‚Ä¢ M√°s coincidencias = m√°s puntos\n' +
                    '‚Ä¢ Los combos multiplican la puntuaci√≥n\n' +
                    '‚Ä¢ Cada nivel aumenta la dificultad',
                de: 'üéÆ SPIELREGELN\n\n' +
                    'üéØ ZIEL:\n' +
                    '‚Ä¢ Verbinde 3 oder mehr identische Symbole\n' +
                    '‚Ä¢ Erreiche die Zielpunktzahl bevor die Z√ºge ausgehen\n\n' +
                    'üïπÔ∏è WIE GESPIELT WIRD:\n' +
                    '1. Klicke auf eine Zelle um sie auszuw√§hlen\n' +
                    '2. Klicke auf eine benachbarte Zelle zum Tauschen\n' +
                    '3. √úbereinstimmungen von 3+ verschwinden automatisch\n' +
                    '4. Neue Symbole fallen von oben\n\n' +
                    '‚ö° POWER-UPS:\n' +
                    '‚Ä¢ üî• Linie: Entfernt ganze Reihe\n' +
                    '‚Ä¢ üí£ Bombe: Entfernt 3x3 Bereich\n' +
                    '‚Ä¢ üåà Regenbogen: Entfernt alle gleichen Symbole\n\n' +
                    'üèÜ PUNKTZAHL:\n' +
                    '‚Ä¢ Mehr √úbereinstimmungen = mehr Punkte\n' +
                    '‚Ä¢ Kombos multiplizieren die Punktzahl\n' +
                    '‚Ä¢ Jedes Level erh√∂ht die Schwierigkeit',
                zh: 'üéÆ Ê∏∏ÊàèËßÑÂàô\n\n' +
                    'üéØ ÁõÆÊ†á:\n' +
                    '‚Ä¢ ËøûÊé•3‰∏™ÊàñÊõ¥Â§öÁõ∏ÂêåÁ¨¶Âè∑\n' +
                    '‚Ä¢ Âú®ÁßªÂä®Áî®ÂÆåÂâçËææÂà∞ÁõÆÊ†áÂàÜÊï∞\n\n' +
                    'üïπÔ∏è Â¶Ç‰ΩïÊ∏∏Êàè:\n' +
                    '1. ÁÇπÂáªÂçïÂÖÉÊ†ºÈÄâÊã©ÂÆÉ\n' +
                    '2. ÁÇπÂáªÁõ∏ÈÇªÂçïÂÖÉÊ†º‰∫§Êç¢\n' +
                    '3. 3+ÂåπÈÖçËá™Âä®Ê∂àÂ§±\n' +
                    '4. Êñ∞Á¨¶Âè∑‰ªéÈ°∂ÈÉ®ÊéâËêΩ\n\n' +
                    '‚ö° ÈÅìÂÖ∑:\n' +
                    '‚Ä¢ üî• Áõ¥Á∫ø: ÁßªÈô§Êï¥Ë°å\n' +
                    '‚Ä¢ üí£ ÁÇ∏Âºπ: ÁßªÈô§3x3Âå∫Âüü\n' +
                    '‚Ä¢ üåà ÂΩ©Ëôπ: ÁßªÈô§ÊâÄÊúâÁõ∏ÂêåÁ¨¶Âè∑\n\n' +
                    'üèÜ ËÆ°ÂàÜ:\n' +
                    '‚Ä¢ Êõ¥Â§öÂåπÈÖç = Êõ¥Â§öÂàÜÊï∞\n' +
                    '‚Ä¢ ËøûÂáªÂÄçÂ¢ûÂàÜÊï∞\n' +
                    '‚Ä¢ ÊØèÁ∫ßÂ¢ûÂä†ÈöæÂ∫¶'
            };
            
            try{ parent.postMessage({ action: 'dialog', dialogType: 'alert', text: (rulesText[gameState.currentLanguage] || rulesText.en) }, '*'); }catch(e){}
        }

        // Mettre √† jour l'interface
        function updateUI() {
            document.getElementById('score').textContent = gameState.score.toLocaleString();
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('moves').textContent = gameState.moves;
            document.getElementById('target').textContent = gameState.target.toLocaleString();
            
            const t = translations[gameState.currentLanguage];
            document.getElementById('lineClearBtn').innerHTML = `${t.lineClearText} (${gameState.powerUps.line})`;
            document.getElementById('bombBtn').innerHTML = `${t.bombText} (${gameState.powerUps.bomb})`;
            document.getElementById('rainbowBtn').innerHTML = `${t.rainbowText} (${gameState.powerUps.rainbow})`;
            
            document.getElementById('lineClearBtn').disabled = gameState.powerUps.line <= 0;
            document.getElementById('bombBtn').disabled = gameState.powerUps.bomb <= 0;
            document.getElementById('rainbowBtn').disabled = gameState.powerUps.rainbow <= 0;
            
            // Mettre √† jour la barre de progression
            const progress = Math.min(100, (gameState.score / gameState.target) * 100);
            document.getElementById('target').style.background = `linear-gradient(90deg, #00ff80 ${progress}%, transparent ${progress}%)`;
        }

        // Changer de langue
        function changeLanguage(lang) {
            gameState.currentLanguage = lang;
            const t = translations[lang];
            
            // √âcran de d√©marrage
            document.getElementById('startTitle').textContent = t.startTitle;
            document.getElementById('startDescription').textContent = t.startDescription;
            document.getElementById('startBtn').textContent = t.startBtn;
            document.getElementById('feature1').textContent = t.feature1;
            document.getElementById('feature2').textContent = t.feature2;
            document.getElementById('feature3').textContent = t.feature3;
            document.getElementById('feature4').textContent = t.feature4;
            document.getElementById('difficultyLabel').textContent = t.difficultyLabel;
            document.getElementById('easyOption').textContent = t.easyOption;
            document.getElementById('normalOption').textContent = t.normalOption;
            document.getElementById('hardOption').textContent = t.hardOption;
            
            // Interface de jeu
            document.getElementById('gameTitle').textContent = t.gameTitle;
            document.getElementById('scoreLabel').textContent = t.scoreLabel;
            document.getElementById('levelLabel').textContent = t.levelLabel;
            document.getElementById('movesLabel').textContent = t.movesLabel;
            document.getElementById('targetLabel').textContent = t.targetLabel;
            document.getElementById('leaderboardTitle').textContent = t.leaderboardTitle;
            document.getElementById('levelCompleteTitle').textContent = t.levelCompleteTitle;
            document.getElementById('continueBtn').textContent = t.continueBtn;
            document.getElementById('pauseTitle').textContent = t.pauseTitle;
            document.getElementById('pauseMessage').textContent = t.pauseMessage;
            document.getElementById('resumeBtn').textContent = t.resumeBtn;
            document.getElementById('gameOverTitle').textContent = t.gameOverTitle;
            document.getElementById('restartBtn').textContent = t.restartBtn;
            
            // Mettre √† jour les boutons de contr√¥le
            document.getElementById('pauseBtn').innerHTML = `‚è∏Ô∏è <span>${t.pauseText}</span>`;
            document.getElementById('resetBtn').innerHTML = `üîÑ <span>${t.resetText}</span>`;
            document.getElementById('soundBtn').innerHTML = `${gameState.soundEnabled ? 'üîä' : 'üîá'} <span>${t.soundText}</span>`;
            document.getElementById('fullscreenBtn').innerHTML = `‚õ∂ <span>${t.fullscreenText}</span>`;
            document.getElementById('helpBtn').innerHTML = `‚ùì <span>${t.helpText}</span>`;
            document.getElementById('rulesBtn').innerHTML = `üìã <span>${t.rulesText}</span>`;
            
            updateUI();
            saveGame();
        }

        // Sauvegarder le jeu
        function saveGame() {
            localStorage.setItem('brainovaCrash', JSON.stringify(gameState));
        }

        // Charger le jeu
        function loadGame() {
            const saved = localStorage.getItem('brainovaCrash');
            if (saved) {
                try {
                    const savedState = JSON.parse(saved);
                    gameState = { ...gameState, ...savedState };
                    changeLanguage(gameState.currentLanguage);
                    document.getElementById('topScore').textContent = gameState.highScore;
                } catch (e) {
                    console.log('Erreur de chargement de la sauvegarde');
                }
            }
            updateUI();
        }

        // Gestionnaires d'√©v√©nements
        document.getElementById('languageSelect').addEventListener('change', (e) => {
            changeLanguage(e.target.value);
        });

        // Raccourcis clavier avanc√©s
        document.addEventListener('keydown', (e) => {
            // Si on est sur l'√©cran de d√©marrage et qu'on appuie sur Entr√©e
            if (!gameState.gameStarted && e.key === 'Enter') {
                e.preventDefault();
                startGame();
                return;
            }
            
            // Si le plateau est vide et qu'on appuie sur Entr√©e, forcer la cr√©ation
            if (gameState.gameStarted && e.key === 'Enter') {
                e.preventDefault();
                const board = document.getElementById('gameBoard');
                if (!board.children.length) {
                    console.log('Forcing board creation with Enter key');
                    createBoard();
                    updateUI();
                }
                return;
            }
            
            // Raccourcis globaux (fonctionnent toujours)
            switch(e.key) {
                case 'q':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        quickStart();
                    }
                    break;
                case 'd':
                    if (e.ctrlKey && e.shiftKey) {
                        e.preventDefault();
                        devMode();
                    }
                    break;
                case 'h':
                    e.preventDefault();
                    showHint();
                    break;
                case 'a':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        autoPlay();
                    }
                    break;
                case 'n':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        showNotification('üéÆ Raccourcis: H=Indice, Ctrl+A=Auto, Ctrl+D=Dev');
                    }
                    break;
            }
            
            if (!gameState.isGameActive) return;
            
            switch(e.key) {
                case ' ':
                case 'p':
                    e.preventDefault();
                    pauseGame();
                    break;
                case 'r':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        resetGame();
                    }
                    break;
                case 's':
                    e.preventDefault();
                    if (e.ctrlKey) {
                        saveToCloud();
                    } else {
                        toggleSound();
                    }
                    break;
                case 'f':
                    if (e.ctrlKey) {
                        e.preventDefault();
                        toggleFullscreen();
                    }
                    break;
                case '1':
                    activatePowerUp('line');
                    break;
                case '2':
                    activatePowerUp('bomb');
                    break;
                case '3':
                    activatePowerUp('rainbow');
                    break;
                case 'Escape':
                    e.preventDefault();
                    if (gameState.activePowerUp) {
                        gameState.activePowerUp = null;
                        document.body.style.cursor = 'default';
                        document.querySelectorAll('.power-up-btn').forEach(btn => btn.classList.remove('active'));
                    } else {
                        pauseGame();
                    }
                    break;
            }
        });

        // Fonction de secours pour forcer l'affichage du plateau
        function forceShowBoard() {
            if (gameState.gameStarted && !document.getElementById('gameBoard').children.length) {
                console.log('Emergency board creation triggered');
                createBoard();
                updateUI();
            }
        }

        // Fonction de diagnostic et cr√©ation forc√©e
        function forceCreateBoard() {
            console.log('üîß DIAGNOSTIC COMPLET:');
            const board = document.getElementById('gameBoard');
            
            console.log('- √âtat du jeu:', gameState.gameStarted, gameState.isGameActive);
            console.log('- Plateau DOM:', board ? 'Existe' : 'Manquant');
            console.log('- Enfants plateau:', board ? board.children.length : 'N/A');
            console.log('- Style display:', board ? board.style.display : 'N/A');
            console.log('- Visibilit√©:', board ? board.style.visibility : 'N/A');
            
            // Forcer l'√©tat du jeu
            gameState.gameStarted = true;
            gameState.isGameActive = true;
            gameState.isPaused = false;
            
            // Masquer l'√©cran de d√©marrage
            document.getElementById('startScreen').style.display = 'none';
            
            // R√©initialiser compl√®tement le plateau
            if (board) {
                board.innerHTML = '';
                board.style.display = 'grid';
                board.style.visibility = 'visible';
                board.style.opacity = '1';
                board.classList.remove('paused');
                
                console.log('üîß Cr√©ation forc√©e du plateau...');
                createBoard();
                updateUI();
                
                setTimeout(() => {
                    console.log('‚úÖ R√©sultat:', board.children.length, 'cellules cr√©√©es');
                    if (board.children.length > 0) {
                        showNotification('‚úÖ Plateau cr√©√© avec succ√®s!');
                    } else {
                        showNotification('‚ùå √âchec de cr√©ation du plateau');
                        
                        // Derni√®re tentative avec m√©thode alternative
                        console.log('üîß Tentative alternative...');
                        alternativeCreateBoard();
                    }
                }, 100);
            }
        }

        // M√©thode alternative de cr√©ation du plateau
        function alternativeCreateBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            
            // Cr√©er directement le HTML
            let html = '';
            gameState.board = [];
            
            for (let row = 0; row < BOARD_SIZE; row++) {
                gameState.board[row] = [];
                for (let col = 0; col < BOARD_SIZE; col++) {
                    const type = Math.floor(Math.random() * CELL_TYPES);
                    gameState.board[row][col] = type;
                    
                    html += `<div class="cell type-${type}" data-row="${row}" data-col="${col}" 
                             onclick="handleCellClick(event)" 
                             style="display: flex; visibility: visible; pointer-events: auto;">
                             ${symbols[type]}
                             </div>`;
                }
            }
            
            board.innerHTML = html;
            console.log('üîß M√©thode alternative utilis√©e');
            
            setTimeout(() => {
                if (board.children.length > 0) {
                    showNotification('‚úÖ M√©thode alternative r√©ussie!');
                } else {
                    showNotification('‚ùå Toutes les m√©thodes ont √©chou√©');
                }
            }, 50);
        }

        // Ajouter un clic de secours sur la zone de jeu
        document.addEventListener('click', (e) => {
            if (gameState.gameStarted && e.target.classList.contains('game-board')) {
                forceShowBoard();
            }
        });

        // Initialiser le jeu au chargement
        window.addEventListener('load', () => {
            // Toujours afficher l'√©cran de d√©marrage au d√©but
            gameState.gameStarted = false;
            gameState.isGameActive = false;
            document.getElementById('startScreen').style.display = 'flex';
            
            loadGame();
            changeLanguage(gameState.currentLanguage);
        });

        // Auto-save p√©riodique
        setInterval(saveGame, 30000);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'987b38d7c3ce07ea',t:'MTc1OTMxMzk3MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
