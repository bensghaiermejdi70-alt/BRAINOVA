<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Brainova - Plateforme unique (global)</title>
  <!-- If you deploy to GitHub Pages under /BRAINOVA/, this base helps relative imports/links resolve -->
  <base href="/BRAINOVA/">
  <style>
    /* Inline minimal maquette CSS (self-contained) */
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;400;700&display=swap');
    *{box-sizing:border-box}
    body{margin:0;font-family:Rajdhani,Segoe UI,Arial;background:linear-gradient(135deg,#0a0a0a 0%,#1a1a2e 50%,#16213e 100%);color:#fff}
    .header{background:linear-gradient(135deg,rgba(0,0,0,0.95),rgba(26,26,46,0.9));backdrop-filter:blur(10px);border-bottom:2px solid #00d4ff;padding:14px 18px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:1000}
    .logo h1{font-family:Orbitron,monospace;font-size:1.6rem;margin:0;background:linear-gradient(45deg,#00d4ff,#ff0096,#00ff88);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
    .nav-btn{background:linear-gradient(45deg,#00d4ff,#ff0096);border:none;border-radius:20px;padding:8px 14px;color:#fff;font-weight:700;cursor:pointer}
    .main{max-width:1200px;margin:18px auto;padding:0 18px}
    .hero{padding:28px;background:linear-gradient(135deg,rgba(0,212,255,0.05),rgba(255,0,150,0.03));border-radius:12px;margin-bottom:18px}
    .hero h2{font-family:Orbitron,monospace;font-size:2rem;margin:0;color:#00d4ff}
    .games-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px;margin-top:18px}
    .game-card{background:linear-gradient(135deg,rgba(0,0,0,0.9),rgba(26,26,46,0.8));border:2px solid #00d4ff;padding:14px;border-radius:14px;cursor:pointer;transition:transform .18s,box-shadow .18s}
    .game-card:hover{transform:translateY(-6px);box-shadow:0 12px 30px rgba(0,212,255,0.12)}
    .game-number{font-weight:700;color:#00d4ff}
  .game-badge{position:absolute;top:8px;right:8px;width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,#ffd700,#ffbf00);display:flex;align-items:center;justify-content:center;color:#001;font-weight:900;box-shadow:0 6px 18px rgba(255,191,0,0.18);border:2px solid rgba(255,255,255,0.12);z-index:5}
    .game-icon{font-size:40px;text-align:center;margin:8px 0}
    .game-card h3{font-family:Orbitron,monospace;margin:6px 0;color:#fff;text-align:center}
    /* per-card customizations removed to restore default platform styling */
  .overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.92);z-index:2000}
  .overlay.active{display:flex}
  /* Make the iframe frame full-viewport so games render large */
  .overlay .frame{position:fixed;inset:0;background:#000;border-radius:0;overflow:hidden;display:flex;align-items:stretch;justify-content:stretch}
  .overlay .frame iframe{position:absolute;inset:0;width:100vw;height:100vh;border:0;z-index:1}
    .close-btn{position:absolute;top:8px;right:8px;background:linear-gradient(45deg,#ff0096,#00d4ff);border:none;color:#fff;padding:8px 10px;border-radius:8px;font-weight:700;cursor:pointer;z-index:1002}
    .overlay-title{position:absolute;left:12px;top:10px;color:#fff;font-weight:700;z-index:10}
    .loader{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#0b1220,#11223a);z-index:9999}
    .spinner{width:48px;height:48px;border:4px solid rgba(255,255,255,0.12);border-top-color:#00d4ff;border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
  @media (max-width:480px){.overlay .frame{position:fixed;inset:0;border-radius:0}}
  /* Futuristic language picker styles */
  #langPicker { font-family: Rajdhani, Arial, sans-serif; }
  #langBtn { display:flex;align-items:center;gap:8px;background:linear-gradient(135deg,#061229 0%,#08223a 100%);border:1px solid rgba(0,212,255,0.12);padding:8px 12px;border-radius:14px;color:#cfefff;backdrop-filter:blur(6px);box-shadow:0 6px 24px rgba(0,212,255,0.06); }
  #langBtn:focus{outline:2px solid rgba(0,212,255,0.18)}
  #langMenu .lang-item{transition:transform .12s,background .12s;color:#e6f7ff}
  #langMenu .lang-item:hover{transform:translateX(6px);background:linear-gradient(90deg,rgba(0,212,255,0.04),rgba(255,0,150,0.02));}
  #langMenu .lang-item.selected{background:linear-gradient(90deg,rgba(0,212,255,0.12),rgba(255,0,150,0.04));box-shadow:0 6px 18px rgba(0,212,255,0.06);}
  /* Ensure the native select dropdown options are readable across platforms */
  #langSelect{ position:relative; z-index:2001; min-width:130px; color:#cfefff; background:linear-gradient(135deg,#061229,#08223a); }
  #langSelect option{ color:#001 !important; background:#fff !important; direction:ltr; }
  /* On some platforms options can't be fully styled; provide an accessible fallback visual hint */
  #langSelect:focus{ outline:2px solid rgba(0,212,255,0.14); }
  /* Category button color schemes */
  #catalog-hero .cat[data-filter="memoire"]{ background: linear-gradient(135deg,#7ee8fa 0%,#eec0c6 100%); color:#001 }
  #catalog-hero .cat[data-filter="memoire"]:hover{ box-shadow:0 8px 28px rgba(126,232,250,0.18); transform:translateY(-3px) }
  #catalog-hero .cat[data-filter="societe"]{ background: linear-gradient(135deg,#cfd9df 0%,#e2ebf0 100%); color:#001 }
  #catalog-hero .cat[data-filter="societe"]:hover{ box-shadow:0 8px 28px rgba(200,217,223,0.12); transform:translateY(-3px) }
  #catalog-hero .cat[data-filter="puzzle"]{ background: linear-gradient(135deg,#ffd6a5 0%,#fdffb6 100%); color:#111 }
  #catalog-hero .cat[data-filter="puzzle"]:hover{ box-shadow:0 8px 28px rgba(255,214,165,0.14); transform:translateY(-3px) }
  #catalog-hero .cat[data-filter="arcade"]{ background: linear-gradient(135deg,#a18cd1 0%,#fbc2eb 100%); color:#0b002b }
  #catalog-hero .cat[data-filter="arcade"]:hover{ box-shadow:0 8px 28px rgba(161,140,209,0.14); transform:translateY(-3px) }
  #catalog-hero .cat[data-filter="strategie"]{ background: linear-gradient(135deg,#89f7fe 0%,#66a6ff 100%); color:#001 }
  #catalog-hero .cat[data-filter="strategie"]:hover{ box-shadow:0 8px 28px rgba(102,166,255,0.14); transform:translateY(-3px) }
  #catalog-hero .cat[data-filter="quiz"]{ background: linear-gradient(135deg,#fbc2eb 0%,#a6c1ee 100%); color:#001 }
  #catalog-hero .cat[data-filter="quiz"]:hover{ box-shadow:0 8px 28px rgba(191,194,238,0.14); transform:translateY(-3px) }
  #catalog-hero .cat[data-filter="reflexe"]{ background: linear-gradient(135deg,#ff9a9e 0%,#fecfef 100%); color:#001 }
  #catalog-hero .cat[data-filter="reflexe"]:hover{ box-shadow:0 8px 28px rgba(255,154,158,0.14); transform:translateY(-3px) }
  </style>
</head>
<body>
  <div class="loader" id="loader"><div class="spinner" aria-hidden></div></div>
  <header class="header" id="header" style="display:none">
    <div class="logo"><h1>üß† BRAINOVA</h1></div>
    <nav class="nav" style="display:flex;gap:8px;align-items:center">
  <button class="nav-btn" onclick="location.href=new URL('./global_platform_correct.html', location.href).href">Accueil</button>
  <button id="btnLogin" class="nav-btn">Connexion</button>
      <a class="nav-btn" href="https://buy.stripe.com/cNi8wR7IC77o54icy49EI01" target="_blank" rel="noopener noreferrer" style="background:linear-gradient(45deg,#ffd700,#ff7a00);">Pass Premium</a>
      <div id="userSigle" style="width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,#00d4ff,#ff0096);display:flex;align-items:center;justify-content:center;color:#001;font-weight:800;margin-left:8px;display:none">JD</div>
      <div style="position:relative;margin-left:8px">
        <button id="settingsBtn" class="nav-btn" style="padding:6px 8px">‚öôÔ∏è</button>
        <div id="settingsMenu" style="position:absolute;right:0;top:40px;background:#0b1220;border:1px solid rgba(255,255,255,0.04);padding:6px;border-radius:8px;display:none;min-width:160px">
          <div style="padding:8px;color:#cfefff;cursor:pointer" id="settingsEditProfile">Changer profil</div>
          <div style="padding:8px;color:#cfefff;cursor:pointer" id="settingsHistory">Historique</div>
        </div>
      </div>
      <!-- Futuristic language selector (single select) -->
      <div id="langPicker" style="position:relative;margin-left:8px">
        <select id="langSelect" aria-label="Langue" title="Langue" style="appearance:none;-webkit-appearance:none;-moz-appearance:none;display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:14px;border:1px solid rgba(0,212,255,0.12);background:linear-gradient(135deg,#061229 0%,#08223a 100%);color:#cfefff;cursor:pointer;font-weight:700">
          <option value="fr">üá´üá∑ Fran√ßais</option>
          <option value="en">üá¨üáß English</option>
          <option value="ar">üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
          <option value="es">üá™üá∏ Espa√±ol</option>
          <option value="de">üá©üá™ Deutsch</option>
          <option value="zh">üá®üá≥ ‰∏≠Êñá</option>
        </select>
      </div>
    </nav>
  </header>

  <!-- Local state status bar (helpful in file:// mode) -->
  <div id="localStateBar" style="background:rgba(0,0,0,0.6);color:#cfefff;padding:8px 12px;border-bottom:1px solid rgba(255,255,255,0.03);font-size:13px;display:flex;gap:12px;align-items:center;justify-content:space-between">
    <div id="localStateText">√âtat local: v√©rification en cours...</div>
    <div style="display:flex;gap:8px;align-items:center">
      <button id="localStateRefresh" class="nav-btn" style="padding:6px 10px;">Rafra√Æchir</button>
      <button id="localStateClear" class="nav-btn" style="padding:6px 10px;background:#ff6b6b">Reset flags</button>
    </div>
  </div>

  <main class="main">
    <section class="hero" id="catalog-hero" style="padding:18px;background:linear-gradient(135deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:12px;margin-bottom:18px">
      <div style="max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:18px;flex-wrap:wrap">
        <div style="display:flex;align-items:center;gap:14px">
          <div style="width:120px;height:120px;border-radius:14px;background:linear-gradient(135deg,#00d4ff,#ff0096);display:flex;align-items:center;justify-content:center;font-size:34px;font-weight:900;color:#001;padding:12px;box-shadow:0 8px 40px rgba(0,212,255,0.08)">36<br><small style="font-size:12px;color:#001;font-weight:700">JEUX</small></div>
          <div>
            <h2 style="margin:0;font-family:Orbitron,monospace;color:#00d4ff">Catalogue Brainova ‚Äî 36 jeux</h2>
            <p style="margin:6px 0;color:#cfefff">Explorez par th√®me : s√©lectionnez une cat√©gorie pour filtrer les cartes de jeux.</p>
          </div>
        </div>
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <button class="cat" data-filter="memoire" style="padding:10px 14px;background:linear-gradient(135deg,rgba(0,0,0,0.6),rgba(26,26,46,0.6));border:1px solid rgba(255,255,255,0.03);border-radius:10px;color:#cfefff;cursor:pointer">M√©moire</button>
          <button class="cat" data-filter="societe" style="padding:10px 14px;background:linear-gradient(135deg,rgba(0,0,0,0.6),rgba(26,26,46,0.6));border:1px solid rgba(255,255,255,0.03);border-radius:10px;color:#cfefff;cursor:pointer">Soci√©t√©</button>
          <button class="cat" data-filter="puzzle" style="padding:10px 14px;background:linear-gradient(135deg,rgba(0,0,0,0.6),rgba(26,26,46,0.6));border:1px solid rgba(255,255,255,0.03);border-radius:10px;color:#cfefff;cursor:pointer">Puzzle</button>
          <button class="cat" data-filter="arcade" style="padding:10px 14px;background:linear-gradient(135deg,rgba(0,0,0,0.6),rgba(26,26,46,0.6));border:1px solid rgba(255,255,255,0.03);border-radius:10px;color:#cfefff;cursor:pointer">Arcade</button>
          <button class="cat" data-filter="strategie" style="padding:10px 14px;background:linear-gradient(135deg,rgba(0,0,0,0.6),rgba(26,26,46,0.6));border:1px solid rgba(255,255,255,0.03);border-radius:10px;color:#cfefff;cursor:pointer">Strat√©gie</button>
          <button class="cat" data-filter="quiz" style="padding:10px 14px;background:linear-gradient(135deg,rgba(0,0,0,0.6),rgba(26,26,46,0.6));border:1px solid rgba(255,255,255,0.03);border-radius:10px;color:#cfefff;cursor:pointer">Quiz</button>
          <button class="cat" data-filter="reflexe" style="padding:10px 14px;background:linear-gradient(135deg,rgba(0,0,0,0.6),rgba(26,26,46,0.6));border:1px solid rgba(255,255,255,0.03);border-radius:10px;color:#cfefff;cursor:pointer">R√©flexe</button>
        </div>
      </div>
    </section>
  <div style="margin-top:10px;padding:10px;border-radius:8px;background:rgba(255,255,255,0.02);color:#cfefff">Remarque : si vous ne pouvez pas lancer un serveur local, double-cliquez sur ce fichier <strong>global_platform.html</strong> pour l'ouvrir dans votre navigateur, puis activez (ou laissez activ√©) le <em>Mode sans serveur</em>. Les jeux s'ouvriront dans de nouveaux onglets.</div>

    <section id="gamesGrid" class="games-grid" aria-live="polite"></section>
  </main>
  <div style="max-width:1200px;margin:12px auto;padding:0 18px;display:flex;gap:10px;align-items:center">
    <button id="checkAllBtn" class="nav-btn">Tester tous les jeux</button>
    <button id="noServerBtn" class="nav-btn">Mode sans serveur</button>
    <div id="checkStatus" style="color:#cfefff"></div>
  </div>

  <!-- DEBUG PANEL: temporary, remove after diagnostics -->
  <div id="bvDebug" style="position:fixed;left:12px;bottom:12px;background:rgba(0,0,0,0.7);padding:10px;border-radius:8px;color:#cfefff;z-index:99999;min-width:260px;font-size:13px">
    <div style="font-weight:700;margin-bottom:6px">DEBUG</div>
    <div>GamesIndex: <span id="dbgGamesIndex">?</span></div>
    <div>OverlayManager: <span id="dbgOverlay">?</span></div>
    <div>Last resolved: <span id="dbgLastUrl">(none)</span></div>
    <div style="margin-top:8px;display:flex;gap:6px">
      <button id="dbgOpen2" class="nav-btn" style="padding:6px 8px">Ouvrir jeu 2 (overlay)</button>
      <button id="dbgSet2" class="nav-btn" style="padding:6px 8px">Charger jeu 2 dans iframe</button>
      <button id="dbgOpenNew" class="nav-btn" style="padding:6px 8px">Ouvrir jeu 2 (nouvel onglet)</button>
      <button id="dbgReloadIndex" class="nav-btn" style="padding:6px 8px;background:#444">Recharger Index</button>
    </div>
    <div id="dbgError" style="margin-top:6px;font-size:12px;color:#ffb6b6;max-width:360px;word-break:break-word"></div>
    <div style="margin-top:6px;font-size:12px;color:#9fdfff">Regardez la console DevTools pour les logs 'GamesIndex.launch'.</div>
  </div>

  <!-- Overlay iframe -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true">
      <div class="frame">
      <button id="closeBtn" class="close-btn">Fermer</button>
      <div id="overlayTitle" class="overlay-title">Titre</div>
      <iframe id="overlayIframe" src="about:blank" title="Jeu" sandbox="allow-scripts allow-forms allow-same-origin"></iframe>
    </div>
  </div>

  <script>
    // Minimal global script to render cards and open jeuxNN.html in a fullscreen iframe
    (async function(){
      const total = 36;
      // Robust dynamic import for platform/games/games-index.js that works on GitHub Pages / subpaths
    // Compute siteBase that works when hosted under a subpath (e.g., GitHub Pages project site)
    function detectSiteBase(){
      // Examples:
      // - https://user.github.io/BRAINOVA/ -> siteBase = '/BRAINOVA/'
      // - http://localhost:8000/ -> siteBase = '/'
      try{
        // If we're running on the known GitHub Pages host for this repo,
        // force the repo subpath so paths resolve correctly when deployed.
        if(location.hostname === 'bensghaiermejdi70-alt.github.io'){
          return '/BRAINOVA/';
        }
        const parts = location.pathname.split('/').filter(Boolean);
        if(parts.length === 0) return '/';
        // If served from a repo subpath (first path segment looks like an uppercase repo), prefer that
        return '/' + parts[0] + '/';
      }catch(e){ return '/'; }
    }

    const SITE_BASE = detectSiteBase();
  // expose SITE_BASE globally so games modules can resolve files correctly
  window.SITE_BASE = SITE_BASE;

    async function tryLoadGamesIndex(){
      // Try simple relative import specifiers first ‚Äî these are easiest for browsers to resolve
      const specCandidates = [
        './platform/games/games-index.js',
        SITE_BASE + 'platform/games/games-index.js',
        'platform/games/games-index.js'
      ];
      // expose candidates for debugging
      try{ window.__gamesIndexCandidates = specCandidates.slice(); }catch(e){}
      let errors = [];

      for(const spec of specCandidates){
        try{
          const mod = await import(spec);
          if(mod){ window.GamesIndex = mod.default || mod; console.info('GamesIndex loaded from', spec); return true; }
        }catch(e){ errors.push(`import:${spec}:${e && e.message?e.message:e}`); }
      }

      // If direct import failed, try fetching the module text and importing via a blob URL
      for(const spec of specCandidates){
        try{
          // Build an absolute URL to fetch the resource
          let fetchUrl;
          try{ fetchUrl = new URL(spec, location.href).href; }catch(e){ fetchUrl = spec; }
          const resp = await fetch(fetchUrl, { cache: 'no-store' });
          if(!resp.ok){ errors.push(`fetch:${fetchUrl}:status${resp.status}`); continue; }
          const txt = await resp.text();
          const blob = new Blob([txt], { type: 'application/javascript' });
          const blobUrl = URL.createObjectURL(blob);
          try{
            const mod2 = await import(blobUrl);
            if(mod2){ window.GamesIndex = mod2.default || mod2; console.info('GamesIndex loaded from blob of', fetchUrl); URL.revokeObjectURL(blobUrl); return true; }
          }catch(e){ URL.revokeObjectURL(blobUrl); /* try next candidate */ }
        }catch(e){ /* try next candidate */ }
      }
      // record errors for debug panel
      try{ window.__gamesIndexError = errors.join(' | ') || 'unknown'; }catch(e){}
      console.warn('Could not import GamesIndex from any strategy', errors);
      return false;
    }

    try{
      const ok = await tryLoadGamesIndex();
      if(!ok){
        // expose function globally so debug panel can retry
        try{ window.tryLoadGamesIndex = tryLoadGamesIndex; }catch(e){}
        // also attempt a plain script tag fallback (some builds may attach globals)
        const fallbackCandidates = [ SITE_BASE + 'platform/games/games-index.js', './platform/games/games-index.js' ];
        for(const sUrl of fallbackCandidates){
          try{
            await new Promise((resolve,reject)=>{
              const scr = document.createElement('script'); scr.src = sUrl; scr.async = true; scr.onload = ()=>resolve(); scr.onerror = (e)=>reject(e);
              document.head.appendChild(scr);
            });
            if(window.GamesIndex){ console.info('GamesIndex loaded via script tag:', sUrl); break; }
          }catch(e){ /* try next */ }
        }
      } else {
        try{ window.tryLoadGamesIndex = tryLoadGamesIndex; }catch(e){}
      }
    }catch(e){ console.warn('tryLoadGamesIndex failed', e); try{ window.__gamesIndexError = e && e.message ? e.message : String(e); }catch(_){} }
      // Helper to normalize/resolve URLs robustly for GitHub Pages and filenames with spaces
      function normalizeUrl(raw){
        if(!raw) return raw;
        try{
          // If raw looks like an absolute URL, keep it
          const maybe = new URL(raw, window.location.href);
          // Use encodeURI to avoid double-encoding query/hash parts
          return encodeURI(maybe.href);
        }catch(e){
          try{ return encodeURI(raw); }catch(_){ return raw; }
        }
      }
    // Carte des jeux : fichier r√©el (si existant) et titre extrait des fichiers existants
    // Added id 0 -> Test QI (carte qi.html)
    const gameMap = {
  0: { file: './carte%20qi.html', title: 'üß™ Test QI', desc: 'Test QI ‚Äî Carte de v√©rification', icon: 'üß™', players: '1', duration: '1-5 min' },
  1: { file: './jeux1super.html', title: 'üß© Quantum Tetris', desc: 'Tetris quantique ‚Äî alignez les blocs et exploitez la superposition pour marquer plus de points.', icon: 'üß©', players: '1', duration: '3-10 min' },
          2: { file: './jeux2 nouveau.html', title: 'üß† Quantum Memory', desc: "Memory quantique ‚Äî retournez les cartes et retrouvez les paires d'√©tats quantiques.", icon: 'üß†', players: '1-2', duration: '2-8 min' },
        3: { file: './jeux3.html', title: 'üß© Neural Puzzle Master - IA Futuriste' },
        4: { file: './jeux4.html', title: '‚ôõ Brainova Quantum Chess - IA Quantique' },
        5: { file: './jeux5.html', title: 'üî• Brainova Quantum Dames - IA Futuriste' },
        6: { file: './jeux6.html', title: 'üåü Quantum Pac-Man - IA Futuriste' },
        7: { file: './jeux7.html', title: 'üéÆ Simon Says - IA Futuriste' },
        8: { file: './jeux8.html', title: 'üöÄ Speed Challenge - IA Futuriste' },
        9: { file: './jeux9.html', title: 'üîÆ Cyber Checker - Connexion Quantique' },
        10: { file: './jeux10.html', title: "üöÄ DEMO PLAYGROUND - Terrain d'Entra√Ænement Futuriste" },
        11: { file: './jeux11.html', title: 'Quantum Monopoly - Jeu de Plateau Futuriste' },
        12: { file: './jeux12.html', title: 'Quantum Poker - Jeu de Poker Futuriste' },
  13: { file: './jeux13 nouveau.html', title: 'Blackjack Quantum' },
        14: { file: './jeux14.html', title: 'Solitaire Fusion - Jeu de Cartes Futuriste' },
        15: { file: './jeux15.html', title: 'NeuroSynth Explorer - Brainova Premium' },
        16: { file: './jeux16.html', title: 'Enigma Hunter' },
        17: { file: './jeux17.html', title: 'CyberRace Nexus - Prototypes 3D' },
        18: { file: './jeux18.html', title: 'QUANTUM WARFARE 2.0 - Bataille Spatiale Futuriste' },
        19: { file: './jeux19.html', title: 'Quantum Dots - Jeu Futuriste' },
  20: { file: './jeux20 nouveau.html', title: 'Sudoku Futuriste AI' },
        21: { file: './jeux21.html', title: 'Pharaon Cyber - Empire Galactique' },
        22: { file: './jeux22.html', title: 'Quantum Pipes' },
        23: { file: './jeux23.html', title: 'Neural Slot - Brainova AI Casino' },
        24: { file: './jeux24.html', title: 'Neural Dice - Jeu Futuriste avec IA' },
        25: { file: './jeux25.html', title: 'Quantum Bubbles' },
        26: { file: './jeux26.html', title: 'Cyber Defense AI - Jeu Futuriste' },
        27: { file: './jeux27.html', title: 'Cyber Pool - Billard Futuriste avec IA' },
        28: { file: './jeux28.html', title: 'Quantum Tiles - Puzzle Futuriste avec IA' },
        29: { file: './jeux29.html', title: 'Genius Quest - Quiz Multilingue' },
        30: { file: './jeux30.html', title: 'Space Explorer - Aventure Galactique' },
        31: { file: './jeux31.html', title: 'NeuroSphere - Jeu de Soci√©t√© Futuriste IA' },
        32: { file: './jeux32.html', title: 'Skyjo Futuriste 3D' },
        33: { file: './jeux33.html', title: 'STELLAR NEXUS - Jeu Spatial Interactif' },
        34: { file: './jeux34.html', title: 'Dixit Futuriste 3D - Voyage Imaginaire' },
        35: { file: './jeux35.html', title: 'Cyber Warrior - RPG Futuriste' },
    36: { file: './jeux36.html', title: 'Crystal Quest - Puzzle Spatial' }
    };
    // expose for filter scripting
    window.gameMap = gameMap;
      const grid = document.getElementById('gamesGrid');
      // Simple translations map
      const Translations = {
        fr: { login: 'Connexion', signup: 'Inscription', homeNote: 'Cliquez sur une carte pour ouvrir', testBtn: 'Tester tous les jeux', noServer: 'Mode sans serveur', close: 'Fermer', heroTitle: 'Catalogue Brainova ‚Äî 36 jeux', gamesCount: '36 JEUX', categories: { memoire: 'M√©moire', societe: 'Soci√©t√©', puzzle: 'Puzzle', arcade: 'Arcade', strategie: 'Strat√©gie', quiz: 'Quiz', reflexe: 'R√©flexe' } },
        en: { login: 'Login', signup: 'Sign up', homeNote: 'Click a card to open', testBtn: 'Test all games', noServer: 'No-server mode', close: 'Close', heroTitle: 'Brainova Catalog ‚Äî 36 games', gamesCount: '36 GAMES', categories: { memoire: 'Memory', societe: 'Society', puzzle: 'Puzzle', arcade: 'Arcade', strategie: 'Strategy', quiz: 'Quiz', reflexe: 'Reflex' } },
        ar: { login: 'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ', signup: 'ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ®', homeNote: 'ÿßŸÜŸÇÿ± ÿπŸÑŸâ ÿ®ÿ∑ÿßŸÇÿ© ŸÑŸÅÿ™ÿ≠Ÿáÿß', testBtn: 'ÿßÿÆÿ™ÿ®ÿßÿ± ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ŸÑÿπÿßÿ®', noServer: 'Ÿàÿ∂ÿπ ÿ®ÿØŸàŸÜ ÿÆÿßÿØŸÖ', close: 'ÿ•ÿ∫ŸÑÿßŸÇ', heroTitle: 'ŸÉÿ™ÿßŸÑŸàÿ¨ ÿ®ÿ±ÿßŸäŸÜŸàŸÅÿß ‚Äî 36 ŸÑÿπÿ®ÿ©', gamesCount: '36 ŸÑÿπÿ®ÿ©', categories: { memoire: 'ÿßŸÑÿ∞ÿßŸÉÿ±ÿ©', societe: 'ÿßŸÑŸÖÿ¨ÿ™ŸÖÿπ', puzzle: 'ÿ£ÿ≠ÿ¨Ÿäÿ©', arcade: 'ÿ£ÿ±ŸÉŸäÿØ', strategie: 'ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ©', quiz: 'ÿßÿÆÿ™ÿ®ÿßÿ±', reflexe: 'ÿ±ÿØ ŸÅÿπŸÑ' } },
        es: { login: 'Conexi√≥n', signup: 'Registro', homeNote: 'Haga clic en una tarjeta para abrir', testBtn: 'Probar todos los juegos', noServer: 'Modo sin servidor', close: 'Cerrar', heroTitle: 'Cat√°logo Brainova ‚Äî 36 juegos', gamesCount: '36 JUEGOS', categories: { memoire: 'Memoria', societe: 'Sociedad', puzzle: 'Rompecabezas', arcade: 'Arcade', strategie: 'Estrategia', quiz: 'Quiz', reflexe: 'Reflejo' } },
        de: { login: 'Anmelden', signup: 'Registrieren', homeNote: 'Klicken Sie auf eine Karte, um zu √∂ffnen', testBtn: 'Alle Spiele testen', noServer: 'Kein-Server-Modus', close: 'Schlie√üen', heroTitle: 'Brainova-Katalog ‚Äî 36 Spiele', gamesCount: '36 SPIELE', categories: { memoire: 'Ged√§chtnis', societe: 'Gesellschaft', puzzle: 'Puzzle', arcade: 'Arcade', strategie: 'Strategie', quiz: 'Quiz', reflexe: 'Reflex' } },
        zh: { login: 'ÁôªÂΩï', signup: 'Ê≥®ÂÜå', homeNote: 'ÁÇπÂáªÂç°Áâá‰ª•ÊâìÂºÄ', testBtn: 'ÊµãËØïÊâÄÊúâÊ∏∏Êàè', noServer: 'Êó†ÊúçÂä°Âô®Ê®°Âºè', close: 'ÂÖ≥Èó≠', heroTitle: 'Brainova ÁõÆÂΩï ‚Äî 36 Ê¨æÊ∏∏Êàè', gamesCount: '36 Ê∏∏Êàè', categories: { memoire: 'ËÆ∞ÂøÜ', societe: 'Á§æ‰ºö', puzzle: 'ÊãºÂõæ', arcade: 'Ë°óÊú∫', strategie: 'Á≠ñÁï•', quiz: 'ÊµãÈ™å', reflexe: 'ÂèçÂ∫î' } }
      };
      let currentLang = localStorage.getItem('brainovaLang') || 'fr';
      function applyLanguage(lang){
        currentLang = lang;
        localStorage.setItem('brainovaLang', lang);
        const t = Translations[lang] || Translations.fr;
        const b1 = document.getElementById('btnLogin'); if(b1) b1.textContent = t.login;
        const b2 = document.getElementById('btnSignup'); if(b2) b2.textContent = t.signup;
        const note = document.querySelector('.hero p'); if(note) note.textContent = t.homeNote;
        const checkBtn = document.getElementById('checkAllBtn'); if(checkBtn) checkBtn.textContent = t.testBtn;
        const noBtn = document.getElementById('noServerBtn'); if(noBtn) noBtn.textContent = t.noServer;
        const closeBtn = document.getElementById('closeBtn'); if(closeBtn) closeBtn.textContent = t.close;
        // hero title and games count
        try{ const heroH2 = document.querySelector('.hero h2'); if(heroH2) heroH2.textContent = t.heroTitle || heroH2.textContent; }catch(e){}
        try{ const gamesBadge = document.querySelector('.hero > div div:first-child div'); if(gamesBadge) gamesBadge.innerHTML = (t.gamesCount || '36 JEUX') + '<br><small style="font-size:12px;color:#001;font-weight:700">JEUX</small>'; }catch(e){}
        // translate category buttons
        try{
          const cats = document.querySelectorAll('.cat');
          cats.forEach(btn=>{
            const key = btn.getAttribute('data-filter');
            if(t.categories && key && t.categories[key]) btn.textContent = t.categories[key];
          });
        }catch(e){}
        // Re-render cards so per-game titles/descriptions update to the selected language
        try{ renderGrid(); }catch(e){ /* ignore if renderGrid not available yet */ }
      }
      // Wire the language selector so changes update the UI immediately
      (function wireLangSelector(){
        const sel = document.getElementById('langSelect');
        if(!sel) return;
        // Ensure the select reflects stored language and is clearly visible
        sel.value = currentLang;
        sel.style.minWidth = '130px';
        sel.style.zIndex = '2001';
        sel.style.background = 'linear-gradient(135deg,#061229,#08223a)';
        sel.style.color = '#cfefff';
        sel.addEventListener('change', (e)=>{ applyLanguage(e.target.value); });
      })();
      const overlay = document.getElementById('overlay');
      const iframe = document.getElementById('overlayIframe');
      const titleEl = document.getElementById('overlayTitle');
      const closeBtn = document.getElementById('closeBtn');

      // Per-game translations (localized title/description override)
      const gameTranslations = {
        fr: {
          0: { title: 'üß™ Test QI', desc: 'Test QI ‚Äî Carte de v√©rification' },
          1: { title: 'üß© Quantum Tetris', desc: 'Tetris quantique ‚Äî alignez les blocs et exploitez la superposition pour marquer plus de points.' },
          2: { title: 'üß† Quantum Memory', desc: 'Memory quantique ‚Äî retournez les cartes et retrouvez les paires d\'√©tats quantiques.' },
          3: { title: 'üß© Neural Puzzle Master', desc: 'Casse-t√™te neuronal ‚Äî d√©fiez votre logique.' },
          4: { title: '‚ôõ Quantum Chess', desc: '√âchecs quantiques ‚Äî strat√©gie et superposition.' },
          5: { title: 'üî• Quantum Checkers', desc: 'Dames futuristes ‚Äî r√®gles classiques, IA futuriste.' },
          6: { title: 'üåü Quantum Pac-Man', desc: 'Pac-Man r√©invent√© avec des fant√¥mes quantiques.' },
          7: { title: 'üéÆ Simon Says', desc: 'R√©pliquez la s√©quence ‚Äî testez votre m√©moire.' },
          8: { title: 'üöÄ Speed Challenge', desc: 'D√©fi de rapidit√© ‚Äî r√©actions et r√©flexes.' },
          9: { title: 'üîÆ Cyber Checker', desc: 'V√©rification intelligente ‚Äî mini-jeu de logique.' },
          10: { title: 'üöÄ Demo Playground', desc: 'Zone de d√©monstration ‚Äî prototypes ludiques.' },
          11: { title: 'Monopoly Quantique', desc: 'Jeu de plateau revisit√© ‚Äî transactions quantiques.' },
          12: { title: 'Quantum Poker', desc: 'Poker futuriste ‚Äî mise et probabilit√©s quantiques.' },
          13: { title: 'Blackjack Quantum', desc: 'Blackjack Quantum ‚Äî mise et strat√©gie quantique.' },
          14: { title: 'Solitaire Fusion', desc: 'Solitaire Fusion ‚Äî fusionnez les piles pour gagner.' },
          15: { title: 'NeuroSynth Explorer', desc: 'Explorez les synth√®ses neuronales ‚Äî contenu premium.' },
          16: { title: 'Enigma Hunter', desc: 'Chasse aux √©nigmes ‚Äî puzzles et indices.' },
          17: { title: 'CyberRace Nexus', desc: 'Courses futuristes ‚Äî prototypes 3D.' },
          18: { title: 'QUANTUM WARFARE 2.0', desc: 'Bataille spatiale ‚Äî strat√©gie en temps r√©el.' },
          19: { title: 'Quantum Dots', desc: 'Puzzle de points ‚Äî reliez les points quantiques.' },
          20: { title: 'Sudoku Futuriste AI', desc: 'Sudoku assist√© par IA ‚Äî niveaux vari√©s.' },
          21: { title: 'Pharaon Cyber', desc: 'Aventure √âgypte ‚Äî casse-t√™tes historiques.' },
          22: { title: 'Quantum Pipes', desc: 'Raccordez les tuyaux quantiques.' },
          23: { title: 'Neural Slot', desc: 'Machine √† sous IA ‚Äî tours gratuits et bonus.' },
          24: { title: 'Neural Dice', desc: 'Jeu de d√©s futuriste ‚Äî lancers rapides.' },
          25: { title: 'Quantum Bubbles', desc: 'Bulles quantiques ‚Äî √©clatez pour gagner.' },
          26: { title: 'Cyber Defense AI', desc: 'D√©fense cybern√©tique ‚Äî prot√©gez le r√©seau.' },
          27: { title: 'Cyber Pool', desc: 'Billard futuriste ‚Äî modes solo & multi.' },
          28: { title: 'Quantum Tiles', desc: 'Puzzle de tuiles ‚Äî combinez pour nettoyer.' },
          29: { title: 'Genius Quest', desc: 'Quiz multilingue ‚Äî testez votre culture g√©n√©rale.' },
          30: { title: 'Space Explorer', desc: 'Aventure spatiale ‚Äî explorez des plan√®tes.' },
          31: { title: 'NeuroSphere', desc: 'Jeu de soci√©t√© IA ‚Äî coop√©rez ou affrontez.' },
          32: { title: 'Skyjo Futuriste', desc: 'Variante futuriste de Skyjo.' },
          33: { title: 'STELLAR NEXUS', desc: 'Jeu spatial interactif ‚Äî batailles & exploration.' },
          34: { title: 'Dixit Futuriste', desc: 'Voyage imaginaire ‚Äî cartes narratifs.' },
          35: { title: 'Cyber Warrior', desc: 'RPG futuriste ‚Äî missions et mont√©e en niveau.' },
          36: { title: 'Crystal Quest', desc: 'Puzzle spatial ‚Äî collectez cristaux.' }
        },
        ar: {
          0: { title: 'üß™ ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿ∞ŸÉÿßÿ°', desc: 'ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿ∞ŸÉÿßÿ° ‚Äî ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿ™ÿ≠ŸÇŸÇ' },
          1: { title: 'üß© ÿ™ÿ™ÿ±Ÿäÿ≥ ÿßŸÑŸÉŸÖ', desc: 'ÿ™ÿ™ÿ±Ÿäÿ≥ ŸÉŸÖŸàŸÖŸä ‚Äî ÿ±ÿ™ÿ® ÿßŸÑŸÇÿ∑ÿπ Ÿàÿßÿ≥ÿ™ŸÅÿØ ŸÖŸÜ ÿßŸÑÿ™ÿ±ÿßŸÉÿ® ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ŸÜŸÇÿßÿ∑.' },
          2: { title: 'üß† ÿ∞ÿßŸÉÿ±ÿ© ÿßŸÑŸÉŸÖ', desc: 'ÿ∞ÿßŸÉÿ±ÿ© ŸÉŸÖŸàŸÖŸäÿ© ‚Äî ÿßŸÇŸÑÿ® ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ Ÿàÿßÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑÿ£ÿ≤Ÿàÿßÿ¨ ÿßŸÑŸÖÿ™ÿ∑ÿßÿ®ŸÇÿ©.' },
          3: { title: 'üß© ÿ≥ŸäÿØ ÿßŸÑÿ£ŸÑÿ∫ÿßÿ≤ ÿßŸÑÿπÿµÿ®Ÿäÿ©', desc: 'ÿ£ŸÑÿ∫ÿßÿ≤ ÿπÿµÿ®Ÿäÿ© ‚Äî ÿ™ÿ≠ÿØŸâ ŸÖŸÜÿ∑ŸÇŸÉ.' },
          4: { title: '‚ôõ ÿßŸÑÿ¥ÿ∑ÿ±ŸÜÿ¨ ÿßŸÑŸÉŸÖŸàŸÖŸä', desc: 'ÿ¥ÿ∑ÿ±ŸÜÿ¨ ŸÉŸÖŸàŸÖŸä ‚Äî ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© Ÿàÿ¢ŸÑŸäÿßÿ™ ÿßŸÑÿ™ÿ±ÿßŸÉÿ®.' },
          5: { title: 'üî• ÿßŸÑÿØÿßŸÖÿß ÿßŸÑŸÉŸÖŸàŸÖŸäÿ©', desc: 'ÿØÿßŸÖÿß ŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸäÿ© ‚Äî ŸÇŸàÿßÿπÿØ ŸÉŸÑÿßÿ≥ŸäŸÉŸäÿ© ŸÖÿπ ÿ∞ŸÉÿßÿ° ÿßÿµÿ∑ŸÜÿßÿπŸä ŸÖÿ™ŸÇÿØŸÖ.' },
          6: { title: 'üåü ÿ®ÿßŸÉ-ŸÖÿßŸÜ ÿßŸÑŸÉŸÖŸàŸÖŸä', desc: 'ÿ®ÿßŸÉ-ŸÖÿßŸÜ ŸÖŸèÿπÿßÿØ ÿ™ÿÆŸäŸÑŸá ŸÖÿπ ÿ£ÿ¥ÿ®ÿßÿ≠ ŸÉŸÖŸàŸÖŸäÿ©.' },
          7: { title: 'üéÆ ÿ≥ŸäŸÖŸàŸÜ ŸäŸÇŸàŸÑ', desc: 'ŸÉÿ±ÿ± ÿßŸÑÿ™ÿ≥ŸÑÿ≥ŸÑ ‚Äî ÿßÿÆÿ™ÿ®ÿ± ÿ∞ÿßŸÉÿ±ÿ™ŸÉ.' },
          8: { title: 'üöÄ ÿ™ÿ≠ÿØŸä ÿßŸÑÿ≥ÿ±ÿπÿ©', desc: 'ÿ™ÿ≠ÿØŸä ÿßŸÑÿ≥ÿ±ÿπÿ© ‚Äî ÿ±ÿØŸàÿØ ÿßŸÑŸÅÿπŸÑ ŸàÿßŸÑÿ≥ÿ±ÿπÿ©.' },
          9: { title: 'üîÆ ŸÅÿßÿ≠ÿµ ÿßŸÑÿ≥ÿßŸäÿ®ÿ±', desc: 'ŸÅÿßÿ≠ÿµ ÿ∞ŸÉŸä ‚Äî ŸÑÿπÿ®ÿ© ŸÖŸÜÿ∑ŸÇ ÿµÿ∫Ÿäÿ±ÿ©.' },
          10: { title: 'üöÄ ÿ≥ÿßÿ≠ÿ© ÿßŸÑÿπÿ±Ÿàÿ∂', desc: 'ŸÖŸÜÿ∑ŸÇÿ© ÿπÿ±Ÿàÿ∂ ‚Äî ŸÜŸÖÿßÿ∞ÿ¨ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ŸÖŸÖÿ™ÿπÿ©.' },
          11: { title: 'ŸÖŸàŸÜŸàÿ®ŸàŸÑŸä ÿßŸÑŸÉŸÖ', desc: 'ŸÑÿπÿ®ÿ© ÿ∑ÿßŸàŸÑÿ© ŸÖŸèÿπÿßÿØ ÿ™ÿµŸàÿ±Ÿáÿß ÿ®ŸÖÿπÿßŸÖŸÑÿßÿ™ ŸÉŸÖŸàŸÖŸäÿ©.' },
          12: { title: 'ÿ®ŸàŸÉÿ± ŸÉŸÖŸàŸÖŸä', desc: 'ÿ®ŸàŸÉÿ± ŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸä ‚Äî ÿ±ŸáÿßŸÜÿßÿ™ Ÿàÿßÿ≠ÿ™ŸÖÿßŸÑÿßÿ™ ŸÉŸÖŸàŸÖŸäÿ©.' },
          13: { title: 'ÿ®ŸÑÿßŸÉ ÿ¨ÿßŸÉ ŸÉŸÖŸàŸÖŸä', desc: 'ÿ®ŸÑÿßŸÉ ÿ¨ÿßŸÉ ŸÉŸÖŸàŸÖŸä ‚Äî ÿ±ŸáÿßŸÜÿßÿ™ Ÿàÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ©.' },
          14: { title: 'ÿ≥ŸàŸÑŸäÿ™Ÿäÿ± ŸÅŸäŸàÿ¨ŸÜ', desc: 'ÿ≥ŸàŸÑŸäÿ™Ÿäÿ± ŸÅŸäŸàÿ¨ŸÜ ‚Äî ÿßÿØŸÖÿ¨ ÿßŸÑÿ£ŸÉŸàÿßŸÖ ŸÑŸÑŸÅŸàÿ≤.' },
          15: { title: 'ŸÖÿ≥ÿ™ŸÉÿ¥ŸÅ ŸÜŸäŸàÿ±ŸàSynth', desc: 'ÿßÿ≥ÿ™ŸÉÿ¥ŸÅ ÿßŸÑÿ™ÿ±ŸÉŸäÿ®ÿßÿ™ ÿßŸÑÿπÿµÿ®Ÿäÿ© ‚Äî ŸÖÿ≠ÿ™ŸàŸâ ŸÖŸÖŸäÿ≤.' },
          16: { title: 'ÿµÿßÿ¶ÿØ ÿßŸÑÿ£ŸÑÿ∫ÿßÿ≤', desc: 'ÿµŸäÿØ ÿßŸÑÿ£ŸÑÿ∫ÿßÿ≤ ‚Äî ÿ£ÿ≠ÿ¨Ÿäÿßÿ™ ŸàŸÇÿ±ÿßÿ¶ŸÜ.' },
          17: { title: 'ÿ≥ÿ®ÿßŸÇ ÿßŸÑÿ≥ÿßŸäÿ®ÿ±', desc: 'ÿ≥ÿ®ÿßŸÇÿßÿ™ ŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸäÿ© ‚Äî ŸÜŸÖÿßÿ∞ÿ¨ ÿ´ŸÑÿßÿ´Ÿäÿ© ÿßŸÑÿ£ÿ®ÿπÿßÿØ.' },
          18: { title: 'ÿ≠ÿ±ÿ® ÿßŸÑŸÉŸÖ 2.0', desc: 'ŸÖÿπÿ±ŸÉÿ© ŸÅÿ∂ÿßÿ¶Ÿäÿ© ‚Äî ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ŸÅŸä ÿßŸÑŸàŸÇÿ™ ÿßŸÑÿ≠ŸÇŸäŸÇŸä.' },
          19: { title: 'ŸÜŸÇÿßÿ∑ ŸÉŸÖŸàŸÖŸäÿ©', desc: 'ÿ£ÿ≠ÿ¨Ÿäÿ© ÿßŸÑŸÜŸÇÿßÿ∑ ‚Äî ÿßÿ±ÿ®ÿ∑ ÿßŸÑŸÜŸÇÿßÿ∑ ÿßŸÑŸÉŸÖŸàŸÖŸäÿ©.' },
          20: { title: 'ÿ≥ŸàÿØŸàŸÉŸà ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä', desc: 'ÿ≥ŸàÿØŸàŸÉŸà ÿ®ŸÖÿ≥ÿßÿπÿØÿ© ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä ‚Äî ŸÖÿ≥ÿ™ŸàŸäÿßÿ™ ŸÖÿ™ÿπÿØÿØÿ©.' },
          21: { title: 'ŸÅÿ±ÿπŸàŸÜ ÿßŸÑÿ≥ÿßŸäÿ®ÿ±', desc: 'ŸÖÿ∫ÿßŸÖÿ±ÿ© ŸÖÿµÿ±Ÿäÿ© ‚Äî ÿ£ÿ≠ÿ¨Ÿäÿßÿ™ ÿ™ÿßÿ±ŸäÿÆŸäÿ©.' },
          22: { title: 'ÿ£ŸÜÿßÿ®Ÿäÿ® ÿßŸÑŸÉŸÖ', desc: 'ŸÇŸÖ ÿ®ÿ™ŸàÿµŸäŸÑ ÿ£ŸÜÿßÿ®Ÿäÿ® ÿßŸÑŸÉŸÖ.' },
          23: { title: 'ŸÅÿ™ÿ≠ÿ© ŸÜŸäŸàÿ±ÿßŸÑ', desc: 'ŸÖÿßŸÉŸäŸÜÿ© ÿ≥ŸÑŸàÿ™ ÿ∞ŸÉŸäÿ© ‚Äî ŸÑŸèÿπÿ® ŸÖÿ¨ÿßŸÜŸäÿ© ŸàŸÖŸÉÿßŸÅÿ¢ÿ™.' },
          24: { title: 'ŸÜÿ±ÿØ ŸÜŸäŸàÿ±ÿßŸÑ', desc: 'ŸÑÿπÿ®ÿ© ŸÜÿ±ÿØ ŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸäÿ© ‚Äî ÿ±ŸÖŸäÿßÿ™ ÿ≥ÿ±Ÿäÿπÿ©.' },
          25: { title: 'ŸÅŸÇÿßÿπÿßÿ™ ŸÉŸÖŸàŸÖŸäÿ©', desc: 'ŸÅÿ±ŸÇÿπ ÿßŸÑŸÅŸÇÿßÿπÿßÿ™ ÿßŸÑŸÉŸÖŸàŸÖŸäÿ© ŸÑÿ™ÿ≠ÿµŸÑ ÿπŸÑŸâ ŸÜŸÇÿßÿ∑.' },
          26: { title: 'ÿØŸÅÿßÿπ ÿßŸÑÿ≥ÿßŸäÿ®ÿ± AI', desc: 'ÿØÿßŸÅÿπ ÿπŸÜ ÿßŸÑÿ¥ÿ®ŸÉÿ© ‚Äî ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ÿØŸÅÿßÿπŸäÿ©.' },
          27: { title: 'ÿ®ŸÑŸäÿßÿ±ÿØŸà ÿßŸÑÿ≥ÿßŸäÿ®ÿ±', desc: 'ÿ®ŸÑŸäÿßÿ±ÿØŸà ŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸäÿ© ‚Äî ÿ£Ÿàÿ∂ÿßÿπ ŸÑÿßÿπÿ® ŸÅÿ±ÿØŸä ŸàŸÖÿ™ÿπÿØÿØ.' },
          28: { title: 'ÿ®ŸÑÿßÿ∑ÿßÿ™ ŸÉŸÖŸàŸÖŸäÿ©', desc: 'ÿ£ÿ≠ÿ¨Ÿäÿ© ÿßŸÑÿ®ŸÑÿßÿ∑ÿßÿ™ ‚Äî ÿßÿ¨ŸÖÿπ ŸÑÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑŸÑŸàÿ≠ÿ©.' },
          29: { title: 'ŸÖŸáŸÖÿ© ÿßŸÑÿπÿ®ÿßŸÇÿ±ÿ©', desc: 'ŸÖÿ≥ÿßÿ®ŸÇÿ© ŸÖÿ™ÿπÿØÿØÿ© ÿßŸÑŸÑÿ∫ÿßÿ™ ‚Äî ÿßÿÆÿ™ÿ®ÿ± ŸÖÿπŸÑŸàŸÖÿßÿ™ŸÉ.' },
          30: { title: 'ŸÖÿ≥ÿ™ŸÉÿ¥ŸÅ ÿßŸÑŸÅÿ∂ÿßÿ°', desc: 'ŸÖÿ∫ÿßŸÖÿ±ÿ© ŸÅÿ∂ÿßÿ¶Ÿäÿ© ‚Äî ÿßÿ≥ÿ™ŸÉÿ¥ŸÅ ÿßŸÑŸÉŸàÿßŸÉÿ®.' },
          31: { title: 'ŸÜŸäÿ±Ÿà ÿ≥ŸÅŸäÿ±', desc: 'ŸÑÿπÿ®ÿ© ÿ∑ÿßŸàŸÑÿ© ÿ∞ŸÉŸäÿ© ‚Äî ÿ™ÿπÿßŸàŸÜ ÿ£Ÿà ÿ™ŸÜÿßŸÅÿ≥.' },
          32: { title: 'ÿ≥ŸÉÿßŸäŸà ÿ¨Ÿà ÿßŸÑŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸä', desc: 'ŸÜÿ≥ÿÆÿ© ŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸäÿ© ŸÖŸÜ Skyjo.' },
          33: { title: 'STELLAR NEXUS', desc: 'ŸÑÿπÿ®ÿ© ŸÅÿ∂ÿßÿ° ÿ™ŸÅÿßÿπŸÑŸäÿ© ‚Äî ŸÖÿπÿßÿ±ŸÉ Ÿàÿßÿ≥ÿ™ŸÉÿ¥ÿßŸÅ.' },
          34: { title: 'ÿØŸäŸÉÿ≥Ÿäÿ™ ÿßŸÑŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸäÿ©', desc: 'ÿ±ÿ≠ŸÑÿ© ÿÆŸäÿßŸÑŸäÿ© ‚Äî ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿ≥ÿ±ÿØŸäÿ©.' },
          35: { title: 'ŸÖÿ≠ÿßÿ±ÿ® ÿßŸÑÿ≥ÿßŸäÿ®ÿ±', desc: 'RPG ŸÖÿ≥ÿ™ŸÇÿ®ŸÑŸä ‚Äî ŸÖŸáŸÖÿßÿ™ Ÿàÿ™ÿ±ŸÇŸäÿ©.' },
          36: { title: 'ŸÖŸáŸÖÿ© ÿßŸÑÿ®ŸÑŸëŸàÿ±', desc: 'ÿ£ÿ≠ÿ¨Ÿäÿ© ŸÅÿ∂ÿßÿ¶Ÿäÿ© ‚Äî ÿßÿ¨ŸÖÿπ ÿßŸÑÿ®ŸÑŸëŸàÿ±ÿßÿ™.' }
        },
        en: {
          0: { title: 'üß™ IQ Test', desc: 'IQ test ‚Äî verification card' },
          1: { title: 'üß© Quantum Tetris', desc: 'Quantum Tetris ‚Äî align blocks and exploit superposition to score.' },
          2: { title: 'üß† Quantum Memory', desc: 'Quantum Memory ‚Äî flip cards and find matching quantum states.' },
          3: { title: 'üß© Neural Puzzle Master', desc: 'Neural puzzles ‚Äî challenge your logic.' },
          4: { title: '‚ôõ Quantum Chess', desc: 'Quantum Chess ‚Äî strategy and superposition mechanics.' },
          5: { title: 'üî• Quantum Checkers', desc: 'Futuristic checkers ‚Äî classic rules with advanced AI.' },
          6: { title: 'üåü Quantum Pac-Man', desc: 'Pac-Man reinvented with quantum ghosts.' },
          7: { title: 'üéÆ Simon Says', desc: 'Repeat the sequence ‚Äî test your memory.' },
          8: { title: 'üöÄ Speed Challenge', desc: 'Speed challenge ‚Äî reactions and reflexes.' },
          9: { title: 'üîÆ Cyber Checker', desc: 'Smart checker ‚Äî small logic mini-game.' },
          10: { title: 'üöÄ Demo Playground', desc: 'Demo area ‚Äî playful prototypes.' },
          11: { title: 'Quantum Monopoly', desc: 'Board game reimagined with quantum transactions.' },
          12: { title: 'Quantum Poker', desc: 'Futuristic poker ‚Äî bets and quantum probabilities.' },
          13: { title: 'Blackjack Quantum', desc: 'Quantum Blackjack ‚Äî betting and strategy.' },
          14: { title: 'Solitaire Fusion', desc: 'Solitaire Fusion ‚Äî merge piles to win.' },
          15: { title: 'NeuroSynth Explorer', desc: 'Explore neural synths ‚Äî premium content.' },
          16: { title: 'Enigma Hunter', desc: 'Puzzle hunt ‚Äî riddles and clues.' },
          17: { title: 'CyberRace Nexus', desc: 'Futuristic racing ‚Äî 3D prototypes.' },
          18: { title: 'QUANTUM WARFARE 2.0', desc: 'Space battle ‚Äî real-time strategy.' },
          19: { title: 'Quantum Dots', desc: 'Dots puzzle ‚Äî connect quantum points.' },
          20: { title: 'AI Sudoku', desc: 'Sudoku assisted by AI ‚Äî multiple difficulty levels.' },
          21: { title: 'Pharaoh Cyber', desc: 'Egyptian adventure ‚Äî historical puzzles.' },
          22: { title: 'Quantum Pipes', desc: 'Connect the quantum pipes.' },
          23: { title: 'Neural Slot', desc: 'AI slot machine ‚Äî free spins & bonuses.' },
          24: { title: 'Neural Dice', desc: 'Futuristic dice game ‚Äî quick rolls.' },
          25: { title: 'Quantum Bubbles', desc: 'Pop quantum bubbles to score.' },
          26: { title: 'Cyber Defense AI', desc: 'Protect the network ‚Äî cyber defense strategy.' },
          27: { title: 'Cyber Pool', desc: 'Futuristic billiards ‚Äî solo & multiplayer modes.' },
          28: { title: 'Quantum Tiles', desc: 'Tile puzzle ‚Äî combine to clear.' },
          29: { title: 'Genius Quest', desc: 'Multilingual quiz ‚Äî test your knowledge.' },
          30: { title: 'Space Explorer', desc: 'Space adventure ‚Äî explore planets.' },
          31: { title: 'NeuroSphere', desc: 'AI board game ‚Äî cooperate or compete.' },
          32: { title: 'Skyjo Futuristic', desc: 'Futuristic Skyjo variant.' },
          33: { title: 'STELLAR NEXUS', desc: 'Interactive space game ‚Äî battles & exploration.' },
          34: { title: 'Dixit Futuristic', desc: 'Imaginary journey ‚Äî narrative cards.' },
          35: { title: 'Cyber Warrior', desc: 'Futuristic RPG ‚Äî missions & leveling.' },
          36: { title: 'Crystal Quest', desc: 'Spatial puzzle ‚Äî collect crystals.' }
        },
        es: {
          0: { title: 'üß™ Test IQ', desc: 'Test de IQ ‚Äî tarjeta de verificaci√≥n' },
          1: { title: 'üß© Quantum Tetris', desc: 'Tetris cu√°ntico ‚Äî alinea bloques y aprovecha la superposici√≥n.' },
          2: { title: 'üß† Quantum Memory', desc: 'Memory cu√°ntico ‚Äî da la vuelta a las cartas y encuentra pares.' },
          3: { title: 'üß© Neural Puzzle Master', desc: 'Rompecabezas neuronal ‚Äî desaf√≠a tu l√≥gica.' },
          4: { title: '‚ôõ Quantum Chess', desc: 'Ajedrez cu√°ntico ‚Äî estrategia y superposici√≥n.' },
          5: { title: 'üî• Quantum Checkers', desc: 'Damas futuristas ‚Äî reglas cl√°sicas con IA.' },
          6: { title: 'üåü Quantum Pac-Man', desc: 'Pac-Man reinventado con fantasmas cu√°nticos.' },
          7: { title: 'üéÆ Simon Says', desc: 'Repite la secuencia ‚Äî prueba tu memoria.' },
          8: { title: 'üöÄ Speed Challenge', desc: 'Desaf√≠o de velocidad ‚Äî reflejos r√°pidos.' },
          9: { title: 'üîÆ Cyber Checker', desc: 'Mini juego l√≥gico inteligente.' },
          10: { title: 'üöÄ Demo Playground', desc: 'Zona demo ‚Äî prototipos l√∫dicos.' },
          11: { title: 'Monopoly Cu√°ntico', desc: 'Juego de mesa reinventado con transacciones cu√°nticas.' },
          12: { title: 'Quantum Poker', desc: 'Poker futurista ‚Äî apuestas y probabilidades.' },
          13: { title: 'Blackjack Quantum', desc: 'Blackjack cu√°ntico ‚Äî apuestas y estrategia.' },
          14: { title: 'Solitaire Fusion', desc: 'Solitario Fusion ‚Äî combina pilas para ganar.' },
          15: { title: 'NeuroSynth Explorer', desc: 'Explora sintetizadores neuronales ‚Äî contenido premium.' },
          16: { title: 'Enigma Hunter', desc: 'Caza de enigmas ‚Äî rompecabezas y pistas.' },
          17: { title: 'CyberRace Nexus', desc: 'Carreras futuristas ‚Äî prototipos 3D.' },
          18: { title: 'QUANTUM WARFARE 2.0', desc: 'Guerra espacial ‚Äî estrategia en tiempo real.' },
          19: { title: 'Quantum Dots', desc: 'Conecta puntos cu√°nticos ‚Äî puzzle.' },
          20: { title: 'Sudoku AI', desc: 'Sudoku asistido por IA ‚Äî niveles variados.' },
          21: { title: 'Pharaoh Cyber', desc: 'Aventura egipcia ‚Äî acertijos hist√≥ricos.' },
          22: { title: 'Quantum Pipes', desc: 'Conecta las tuber√≠as cu√°nticas.' },
          23: { title: 'Neural Slot', desc: 'Tragaperras IA ‚Äî giros gratis y bonos.' },
          24: { title: 'Neural Dice', desc: 'Juego de dados futurista ‚Äî tiradas r√°pidas.' },
          25: { title: 'Quantum Bubbles', desc: 'Explota burbujas cu√°nticas para ganar.' },
          26: { title: 'Cyber Defense AI', desc: 'Defiende la red ‚Äî estrategia cibern√©tica.' },
          27: { title: 'Cyber Pool', desc: 'Billar futurista ‚Äî modos solo y multijugador.' },
          28: { title: 'Quantum Tiles', desc: 'Puzzle de fichas ‚Äî combina para limpiar.' },
          29: { title: 'Genius Quest', desc: 'Quiz multiling√ºe ‚Äî prueba tus conocimientos.' },
          30: { title: 'Space Explorer', desc: 'Aventura espacial ‚Äî explora planetas.' },
          31: { title: 'NeuroSphere', desc: 'Juego de mesa IA ‚Äî coopera o compite.' },
          32: { title: 'Skyjo Futuristic', desc: 'Variante futurista de Skyjo.' },
          33: { title: 'STELLAR NEXUS', desc: 'Juego espacial interactivo ‚Äî batallas y exploraci√≥n.' },
          34: { title: 'Dixit Futuristic', desc: 'Viaje imaginario ‚Äî cartas narrativas.' },
          35: { title: 'Cyber Warrior', desc: 'RPG futurista ‚Äî misiones y progresi√≥n.' },
          36: { title: 'Crystal Quest', desc: 'Puzzle espacial ‚Äî colecciona cristales.' }
        },
        de: {
          0: { title: 'üß™ IQ-Test', desc: 'IQ-Test ‚Äî Pr√ºfkarte' },
          1: { title: 'üß© Quantum Tetris', desc: 'Quantum Tetris ‚Äî Bl√∂cke ausrichten und Superposition nutzen.' },
          2: { title: 'üß† Quantum Memory', desc: 'Quantum Memory ‚Äî Karten umdrehen und Paare finden.' },
          3: { title: 'üß© Neural Puzzle Master', desc: 'Neuronale R√§tsel ‚Äî fordere deine Logik heraus.' },
          4: { title: '‚ôõ Quantum Chess', desc: 'Quantum Chess ‚Äî Strategie und Superposition.' },
          5: { title: 'üî• Quantum Checkers', desc: 'Futuristische Dame ‚Äî klassische Regeln mit KI.' },
          6: { title: 'üåü Quantum Pac-Man', desc: 'Pac-Man neu erfunden mit Quantengeistern.' },
          7: { title: 'üéÆ Simon Says', desc: 'Wiederhole die Sequenz ‚Äî teste dein Ged√§chtnis.' },
          8: { title: 'üöÄ Speed Challenge', desc: 'Geschwindigkeits-Challenge ‚Äî Reaktion und Reflexe.' },
          9: { title: 'üîÆ Cyber Checker', desc: 'Kleines Logik-Minispiel.' },
          10: { title: 'üöÄ Demo Playground', desc: 'Demo-Bereich ‚Äî spielerische Prototypen.' },
          11: { title: 'Quantum Monopoly', desc: 'Brettspiel neu gedacht mit Quanten-Transaktionen.' },
          12: { title: 'Quantum Poker', desc: 'Futuristisches Poker ‚Äî Eins√§tze und Wahrscheinlichkeiten.' },
          13: { title: 'Blackjack Quantum', desc: 'Quantum Blackjack ‚Äî Eins√§tze und Strategie.' },
          14: { title: 'Solitaire Fusion', desc: 'Solitaire Fusion ‚Äî Stapel kombinieren, um zu gewinnen.' },
          15: { title: 'NeuroSynth Explorer', desc: 'Erkunde neuronale Synths ‚Äî Premium-Inhalte.' },
          16: { title: 'Enigma Hunter', desc: 'R√§tseljagd ‚Äî R√§tsel und Hinweise.' },
          17: { title: 'CyberRace Nexus', desc: 'Futuristische Rennen ‚Äî 3D-Prototypen.' },
          18: { title: 'QUANTUM WARFARE 2.0', desc: 'Weltraumkampf ‚Äî Echtzeit-Strategie.' },
          19: { title: 'Quantum Dots', desc: 'Punkte-Puzzle ‚Äî verbinde die Quantenpunkte.' },
          20: { title: 'AI Sudoku', desc: 'Sudoku mit KI-Unterst√ºtzung ‚Äî verschiedene Schwierigkeitsgrade.' },
          21: { title: 'Pharaoh Cyber', desc: '√Ñgypten-Abenteuer ‚Äî historische R√§tsel.' },
          22: { title: 'Quantum Pipes', desc: 'Verbinde die Quantenrohre.' },
          23: { title: 'Neural Slot', desc: 'KI-Spielautomat ‚Äî Freispiele & Boni.' },
          24: { title: 'Neural Dice', desc: 'Futuristisches W√ºrfelspiel ‚Äî schnelle W√ºrfe.' },
          25: { title: 'Quantum Bubbles', desc: 'Quantenblasen platzen lassen, um Punkte zu erzielen.' },
          26: { title: 'Cyber Defense AI', desc: 'Verteidige das Netzwerk ‚Äî Cyberabwehrstrategie.' },
          27: { title: 'Cyber Pool', desc: 'Futuristisches Billard ‚Äî Solo- & Mehrspielermodi.' },
          28: { title: 'Quantum Tiles', desc: 'Kachel-Puzzle ‚Äî kombinieren, um zu l√∂schen.' },
          29: { title: 'Genius Quest', desc: 'Mehrsprachiges Quiz ‚Äî teste dein Wissen.' },
          30: { title: 'Space Explorer', desc: 'Weltraumabenteuer ‚Äî erkunde Planeten.' },
          31: { title: 'NeuroSphere', desc: 'KI-Brettspiel ‚Äî kooperiere oder konkurriere.' },
          32: { title: 'Skyjo Futuristic', desc: 'Futuristische Skyjo-Variante.' },
          33: { title: 'STELLAR NEXUS', desc: 'Interaktives Weltraumspiel ‚Äî K√§mpfe & Erkundung.' },
          34: { title: 'Dixit Futuristic', desc: 'Phantasiereise ‚Äî narrative Karten.' },
          35: { title: 'Cyber Warrior', desc: 'Futuristisches RPG ‚Äî Missionen & Levelaufstieg.' },
          36: { title: 'Crystal Quest', desc: 'R√§tsel im Raum ‚Äî sammle Kristalle.' }
        },
        zh: {
          0: { title: 'üß™ Êô∫ÂïÜÊµãËØï', desc: 'Êô∫ÂïÜÊµãËØï ‚Äî È™åËØÅÂç°' },
          1: { title: 'üß© ÈáèÂ≠ê‰øÑÁΩóÊñØÊñπÂùó', desc: 'ÈáèÂ≠ê‰øÑÁΩóÊñØÊñπÂùó ‚Äî ÊéíÂàóÊñπÂùóÂπ∂Âà©Áî®Âè†Âä†ÂæóÂàÜ„ÄÇ' },
          2: { title: 'üß† ÈáèÂ≠êËÆ∞ÂøÜ', desc: 'ÈáèÂ≠êËÆ∞ÂøÜ ‚Äî ÁøªÁâåÂπ∂ÊâæÂá∫ÂåπÈÖçÁöÑÈáèÂ≠êÁä∂ÊÄÅ„ÄÇ' },
          3: { title: 'üß© Á•ûÁªèË∞úÈ¢òÂ§ßÂ∏à', desc: 'Á•ûÁªèË∞úÈ¢ò ‚Äî ÊåëÊàò‰Ω†ÁöÑÈÄªËæë„ÄÇ' },
          4: { title: '‚ôõ ÈáèÂ≠êÂõΩÈôÖË±°Ê£ã', desc: 'ÈáèÂ≠êÂõΩÈôÖË±°Ê£ã ‚Äî Á≠ñÁï•‰∏éÂè†Âä†Êú∫Âà∂„ÄÇ' },
          5: { title: 'üî• ÈáèÂ≠êË∑≥Ê£ã', desc: 'Êú™Êù•Ë∑≥Ê£ã ‚Äî ÁªèÂÖ∏ËßÑÂàô‰∏éÈ´òÁ∫ßAI„ÄÇ' },
          6: { title: 'üåü ÈáèÂ≠êÂêÉË±Ü‰∫∫', desc: 'ÂêÉË±Ü‰∫∫ÈáçÂà∂ÁâàÔºåÂ∏¶ÊúâÈáèÂ≠êÂπΩÁÅµ„ÄÇ' },
          7: { title: 'üéÆ Ë•øËíôËØ¥', desc: 'ÈáçÂ§çÂ∫èÂàó ‚Äî ÊµãËØï‰Ω†ÁöÑËÆ∞ÂøÜ„ÄÇ' },
          8: { title: 'üöÄ ÈÄüÂ∫¶ÊåëÊàò', desc: 'ÈÄüÂ∫¶ÊåëÊàò ‚Äî ÂèçÂ∫î‰∏éÂèçÂ∞Ñ„ÄÇ' },
          9: { title: 'üîÆ ÁΩëÁªúÊ£ÄÊü•Âô®', desc: 'Êô∫ËÉΩÊ£ÄÊü• ‚Äî Â∞èÂûãÈÄªËæëÂ∞èÊ∏∏Êàè„ÄÇ' },
          10: { title: 'üöÄ ÊºîÁ§∫Ê∏∏‰πêÂú∫', desc: 'ÊºîÁ§∫Âå∫ ‚Äî ÊúâË∂£ÁöÑÂéüÂûã„ÄÇ' },
          11: { title: 'ÈáèÂ≠êÂ§ßÂØåÁøÅ', desc: 'ÈááÁî®ÈáèÂ≠ê‰∫§ÊòìÁöÑÊ°åÊ∏∏ÈáçÂà∂Áâà„ÄÇ' },
          12: { title: 'ÈáèÂ≠êÊâëÂÖã', desc: 'Êú™Êù•ÊâëÂÖã ‚Äî ËµåÊ≥®‰∏éÈáèÂ≠êÊ¶ÇÁéá„ÄÇ' },
          13: { title: 'ÈáèÂ≠ê‰∫åÂçÅ‰∏ÄÁÇπ', desc: 'ÈáèÂ≠ê‰∫åÂçÅ‰∏ÄÁÇπ ‚Äî ËµåÊ≥®‰∏éÁ≠ñÁï•„ÄÇ' },
          14: { title: 'ËûçÂêàÁ∫∏Áâå', desc: 'ËûçÂêàÁ∫∏Áâå ‚Äî ÂêàÂπ∂ÁâåÂ†Ü‰ª•Ëé∑ËÉú„ÄÇ' },
          15: { title: 'Á•ûÁªèÂêàÊàêÊé¢Á¥¢ËÄÖ', desc: 'Êé¢Á¥¢Á•ûÁªèÂêàÊàê ‚Äî È´òÁ∫ßÂÜÖÂÆπ„ÄÇ' },
          16: { title: 'Ë∞úÈ¢òÁåé‰∫∫', desc: 'Ë∞úÈ¢òÁã©Áåé ‚Äî Á∫øÁ¥¢‰∏éË∞úÈ¢ò„ÄÇ' },
          17: { title: 'ÁΩëÁªúËµõÈÅìÊû¢Á∫Ω', desc: 'Êú™Êù•ËµõÈÅì ‚Äî 3D ÂéüÂûã„ÄÇ' },
          18: { title: 'ÈáèÂ≠êÊàò‰∫â 2.0', desc: 'Â§™Á©∫Êàò ‚Äî ÂÆûÊó∂Á≠ñÁï•„ÄÇ' },
          19: { title: 'ÈáèÂ≠êÁÇπ', desc: 'ÁÇπÁÇπÊãºÂõæ ‚Äî ËøûÊé•ÈáèÂ≠êÁÇπ„ÄÇ' },
          20: { title: 'AI Êï∞Áã¨', desc: 'Áî± AI ÂçèÂä©ÁöÑÊï∞Áã¨ ‚Äî Â§ö‰∏™ÈöæÂ∫¶Á∫ßÂà´„ÄÇ' },
          21: { title: 'Ê≥ïËÄÅÁΩëÁªú', desc: 'ÂüÉÂèäÂÜíÈô© ‚Äî ÂéÜÂè≤Ë∞úÈ¢ò„ÄÇ' },
          22: { title: 'ÈáèÂ≠êÁÆ°ÈÅì', desc: 'ËøûÊé•ÈáèÂ≠êÁÆ°ÈÅì„ÄÇ' },
          23: { title: 'Á•ûÁªèËÄÅËôéÊú∫', desc: 'AI ËÄÅËôéÊú∫ ‚Äî ÂÖçË¥πÊóãËΩ¨‰∏éÂ•ñÂä±„ÄÇ' },
          24: { title: 'Á•ûÁªèÈ™∞Â≠ê', desc: 'Êú™Êù•È™∞Â≠êÊ∏∏Êàè ‚Äî Âø´ÈÄüÊé∑È™∞„ÄÇ' },
          25: { title: 'ÈáèÂ≠êÊ≥°Ê≥°', desc: 'ÁÇ∏ÊéâÈáèÂ≠êÊ≥°Ê≥°‰ª•ÂæóÂàÜ„ÄÇ' },
          26: { title: 'ÁΩëÁªúÈò≤Âæ° AI', desc: '‰øùÊä§ÁΩëÁªú ‚Äî ÁΩëÁªúÈò≤Âæ°Á≠ñÁï•„ÄÇ' },
          27: { title: 'ÁΩëÁªúÂè∞ÁêÉ', desc: 'Êú™Êù•Âè∞ÁêÉ ‚Äî Âçï‰∫∫‰∏éÂ§ö‰∫∫Ê®°Âºè„ÄÇ' },
          28: { title: 'ÈáèÂ≠êÁì¶Áâá', desc: 'Áì¶ÁâáÊãºÂõæ ‚Äî ÁªÑÂêà‰ª•Ê∏ÖÈô§„ÄÇ' },
          29: { title: 'Â§©Êâç‰ªªÂä°', desc: 'Â§öËØ≠Ë®ÄÊµãÈ™å ‚Äî ÊµãËØï‰Ω†ÁöÑÁü•ËØÜ„ÄÇ' },
          30: { title: 'Â§™Á©∫Êé¢Èô©ËÄÖ', desc: 'Â§™Á©∫ÂÜíÈô© ‚Äî Êé¢Á¥¢Ë°åÊòü„ÄÇ' },
          31: { title: 'Á•ûÁªèÁêÉ‰Ωì', desc: 'AI Ê°åÊ∏∏ ‚Äî Âêà‰ΩúÊàñÁ´û‰∫â„ÄÇ' },
          32: { title: 'Êú™Êù• Skyjo', desc: 'Êú™Êù•Áâà Skyjo Âèò‰Ωì„ÄÇ' },
          33: { title: 'STELLAR NEXUS', desc: '‰∫íÂä®Â§™Á©∫Ê∏∏Êàè ‚Äî ÊàòÊñó‰∏éÊé¢Á¥¢„ÄÇ' },
          34: { title: 'Êú™Êù• Dixit', desc: 'ÊÉ≥Ë±°‰πãÊóÖ ‚Äî Âèô‰∫ãÂç°Áâå„ÄÇ' },
          35: { title: 'ÁΩëÁªúÊàòÂ£´', desc: 'Êú™Êù• RPG ‚Äî ‰ªªÂä°‰∏éÂçáÁ∫ß„ÄÇ' },
          36: { title: 'Ê∞¥Êô∂Êé¢Èô©', desc: 'Á©∫Èó¥Ë∞úÈ¢ò ‚Äî Êî∂ÈõÜÊ∞¥Êô∂„ÄÇ' }
        }
      };

      function getGameMeta(i, lang){
        const base = gameMap[i] || { file: null, title: `Jeu ${i}`, desc: 'Cliquez pour ouvrir', icon: 'üéÆ' };
        const overrides = (gameTranslations[lang] && gameTranslations[lang][i]) ? gameTranslations[lang][i] : {};
        return Object.assign({}, base, overrides);
      }

      // Build a card using GamesIndex when available, otherwise fall back to inline gameMap
      function makeCard(i){
        const div = document.createElement('div'); div.className='game-card'; div.dataset.gameId=i; div.style.position='relative';
        // If GamesIndex is available prefer its markup and helpers
        try{
          if(window.GamesIndex && typeof window.GamesIndex.getCardHTML === 'function'){
            const html = window.GamesIndex.getCardHTML(String(i)) || '';
            div.innerHTML = html || '';
            // allow GamesIndex to provide outer style
            if(typeof window.GamesIndex.getCardStyle === 'function'){
              const styleText = window.GamesIndex.getCardStyle(String(i)) || '';
              if(styleText) div.style.cssText += styleText;
            }
            // Attach launch handler
            div.addEventListener('click', ()=>{ try{ window.GamesIndex.launch(Number(i)); }catch(e){ openGame(i); } });
            return div;
          }
        }catch(e){ /* ignore and fallback to inline rendering */ }

        // Fallback: use local gameMap rendering
        const meta = getGameMeta(i, currentLang);
        div.dataset.file = (gameMap[i] && gameMap[i].file) ? gameMap[i].file : '';
        // Ensure card 0 has the special cyan/teal accent even if GamesIndex failed to load.
        try{ if(Number(i) === 0){ const accent = 'background:linear-gradient(180deg,#cceff7,#33c9ff);border-color:#33c9ff;color:#001;box-shadow:0 10px 30px rgba(51,201,255,0.22);border-radius:10px;'; div.style.cssText += accent; } }catch(e){}
        div.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
            <div class="game-number">${String(i).padStart(2,'0')}</div>
            <div class="game-status">--</div>
          </div>
          <div class="game-icon">${meta.icon || 'üéÆ'}</div>
          <h3>${meta.title}</h3>
          <p style="text-align:center;color:#cfefff">${meta.desc || 'Cliquez pour ouvrir'}</p>
        `;
  // premium badge for card 11..36 (remove badge for card 0)
  try{ const idn = Number(i); if(idn >= 11 && idn <= 36){ const badge = document.createElement('div'); badge.className = 'game-badge'; badge.title = 'Premium'; badge.innerHTML = 'üëë'; div.appendChild(badge); } }catch(e){}
        try{ if(Number(i) === 0){ div.style.color = '#000'; const p = div.querySelector('p'); if(p) p.style.color = '#000'; } }catch(e){}
        div.addEventListener('click', ()=>openGame(i));
        
        return div;
      }

      // Re-render the entire grid (used when language changes)
      function renderGrid(){
        grid.innerHTML = '';
        // include 0..total so Test QI (id 0) appears before the other games
        for(let i=0;i<=total;i++) grid.appendChild(makeCard(i));
      }

  // initial render (0..total)
  for(let i=0;i<=total;i++) grid.appendChild(makeCard(i));

  // Apply the saved/initial language and make header visible
  try{ applyLanguage(currentLang); }catch(e){}
  try{ const hdr = document.getElementById('header'); if(hdr) hdr.style.display = 'flex'; }catch(e){}

  // Default: enable no-server only when opened via file://; when served over HTTP use iframe overlay by default
  let noServerMode = (location.protocol === 'file:');
      const noServerBtn = document.getElementById('noServerBtn');
      function updateNoServerUI(){
        noServerBtn.style.background = noServerMode ? 'linear-gradient(45deg,#ffd700,#00ff88)' : '';
        noServerBtn.textContent = noServerMode ? 'Mode sans serveur (ON)' : 'Mode sans serveur';
      }
  updateNoServerUI();
  // If we are running via file://, keep no-server; if we are running via http and user wants iframe, they can toggle off
      noServerBtn.addEventListener('click', ()=>{ noServerMode = !noServerMode; updateNoServerUI(); });

      function openGame(id){
        const meta = gameMap[id] || {};
        // resolve filename: prefer explicit file, else fallbacks
        const candidates = [];
        if(meta.file) candidates.push(meta.file);
        candidates.push(`./jeux${id}.html`);
        candidates.push(`./jeux${id}.html.html`);
        const chosen = (cardFileExists => cardFileExists)();
        // If no-server or file protocol, open in new tab using first candidate
        const finalFile = meta.file || `./jeux${id}.html`;
        if(noServerMode){
          window.open(finalFile,'_blank');
          return;
        }
        // When running via server, try to load the first candidate that responds
        titleEl.textContent = meta.title || `Jeu ${id}`;
        // Try to set iframe src to meta.file first
          // Resolve relative URL to absolute for clearer logs and normalize it
            let resolvedUrl = meta.file || `./jeux${id}.html`;
            try{
              resolvedUrl = new URL(resolvedUrl, window.location.href).href;
            }catch(err){ /* keep raw */ }
            const safeUrl = normalizeUrl(resolvedUrl);
            console.debug(`global_platform.openGame id=${id} resolved='${resolvedUrl}' safe='${safeUrl}'`);

            // Try setting src first
            try{ iframe.src = safeUrl; }catch(e){ console.warn('iframe.src assignment failed', e); }

            // Also attempt a quick HEAD to detect 404 and fallback if necessary
            fetch(safeUrl, { method: 'HEAD' }).then(r=>{
              if(!r.ok){
                // fallback: fetch html and set srcdoc with <base>
                return fetch(safeUrl).then(r2=>{ if(!r2.ok) throw new Error('HTTP '+r2.status); return r2.text(); }).then(html=>{
                  const dir = safeUrl.split('/').slice(0,-1).join('/') || '.';
                  const base = `<base href="${dir}/">`;
                  iframe.srcdoc = base + html;
                  console.debug(`global_platform.openGame id=${id} srcdoc fallback set`);
                });
              }
            }).catch(err=>{
              console.warn('Setting iframe.src or HEAD check failed, trying fetch+srcdoc fallback', err);
              fetch(safeUrl).then(r=>{ if(!r.ok) throw new Error('HTTP '+r.status); return r.text(); }).then(html=>{
                const dir = safeUrl.split('/').slice(0,-1).join('/') || '.';
                const base = `<base href="${dir}/">`;
                iframe.srcdoc = base + html;
                console.debug(`global_platform.openGame id=${id} srcdoc fallback set`);
              }).catch(err2=>{
                console.error('Failed to fetch game HTML for overlay', safeUrl, err2);
                showOverlayError('Impossible de charger le jeu dans l‚Äôoverlay. Ouvrir dans un nouvel onglet.');
              });
            });
        // If opening game 1 (custom page with its own exit UI), hide the platform close button
        try{ if(Number(id) === 1){ closeBtn.style.display = 'none'; } else { closeBtn.style.display = ''; } }catch(e){}
        overlay.classList.add('active');
        document.addEventListener('keydown', escClose);
      }

      // Open authentication page (mode = 'login' or 'signup') in overlay
      async function openAuth(mode){
        const target = './connexion et profil.html' + (mode ? `?mode=${encodeURIComponent(mode)}` : '');
        if(noServerMode){ window.open(target, '_blank'); return; }
        titleEl.textContent = (mode === 'signup') ? 'Inscription' : 'Connexion';
        // quick HEAD check to ensure reachable
        try{
          const r = await fetch(target, { method: 'HEAD' });
          if(!r.ok) throw new Error('HTTP '+r.status);
          // reachable -> set iframe.src (percent-encode to handle spaces)
          try{
            const tgt = new URL(target, window.location.href).href;
            iframe.src = normalizeUrl(tgt);
          }catch(e){ try{ iframe.src = normalizeUrl(target); }catch(_){} }
          overlay.classList.add('active');
          document.addEventListener('keydown', escClose);
          return;
        }catch(err){
          console.warn('Auth target unreachable in overlay, opening new tab', err);
          // fallback to new tab
          window.open(target, '_blank');
          return;
        }
      }

      function closeGame(){
        try{ document.removeEventListener('keydown', escClose); }catch(e){}
        try{ overlay.classList.remove('active'); }catch(e){}
        try{ iframe.src = 'about:blank'; }catch(e){}
        try{ iframe.srcdoc = ''; iframe.removeAttribute('srcdoc'); }catch(e){}
        try{ document.getElementById('loader').style.display = 'none'; }catch(e){}
        try{ document.getElementById('header').style.display = 'flex'; }catch(e){}
        try{ closeBtn.style.display = ''; }catch(e){}
        try{ window.scrollTo(0,0); }catch(e){}
      }

      function showOverlayError(msg){
        try{
          // show a simple HTML error message in the iframe so user sees why it failed
          const errHtml = `<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:#fff;background:#111;padding:20px;font-family:Rajdhani,Segoe UI,Arial">
            <h2>Erreur de chargement</h2>
            <p style="max-width:800px;text-align:center">${String(msg)}</p>
            <p style="margin-top:12px"><button onclick="window.parent.postMessage({action:'close'},'*')" style="padding:8px 12px;border-radius:6px;border:0;cursor:pointer;background:#00d4ff;color:#000;font-weight:700">Fermer</button></p>
          </div>`;
          iframe.srcdoc = errHtml;
        }catch(e){/* ignore */}
      }

      function escClose(e){ if(e.key==="Escape") closeGame(); }

      closeBtn.addEventListener('click', closeGame);
      overlay.addEventListener('click', (e)=>{ if(e.target===overlay) closeGame(); });

      // Provide a lightweight OverlayManager API so games loaded in iframe
      // can request the parent to open/close the overlay via postMessage.
      // This ensures third-party game pages can call window.parent.postMessage({action:'close'})
      // and the platform will close the iframe properly.
      window.OverlayManager = window.OverlayManager || {
        open: function(url, title){
          try{
            // If caller passed a numeric id (or a numeric string), delegate to openGame
            if(typeof url === 'number' || (/^\d+$/.test(String(url)))){
              try{ openGame(Number(url)); return; }catch(e){}
            }
            // If caller passed a path/URL (contains '.html' or starts with ./ or / or http), set iframe.src directly
            if(typeof url === 'string' && (url.indexOf('.html') !== -1 || url.startsWith('./') || url.startsWith('/') || url.startsWith('http'))){
              try{
                if(title) try{ titleEl.textContent = title; }catch(e){}
                overlay.classList.add('active');
                console.debug('OverlayManager.open: setting iframe.src =', url);
                iframe.src = url;
                return;
              }catch(e){}
            }
            // Fallback: try openGame (may accept id)
            try{ openGame(url, title); }catch(e){ /* ignore */ }
          }catch(e){
            try{ overlay.classList.add('active'); iframe.src = url; }catch(e2){}
          }
        },
        close: function(){ try{ closeGame(); }catch(e){} }
      };

      // Listen for postMessage from iframe children. Expected payload examples:
      // { action: 'close', reason: 'user-initiated', source: 'jeux2' }
      // { action: 'go-home', source: 'jeux2' }
      window.addEventListener('message', function(ev){
        try{
          const data = ev && ev.data;
          if(!data || typeof data !== 'object') return;
          // close action => close overlay; optionally navigate if child asks to go home
          if(data.action === 'close' || data.action === 'close-overlay'){
            try{ closeGame(); }catch(e){}
            return;
          }
          if(data.action === 'go-home' || data.action === 'navigate-home'){
            try{ closeGame(); }catch(e){}
            try{ window.location.href = new URL('./brainova.html', window.location.href).href; }catch(e){}
            return;
          }
          // other actions can be handled here in the future
        }catch(e){ /* ignore malformed messages */ }
      });

      // Robust iframe load handler ‚Äî diagnose and detect platform pages loaded inside iframe
      iframe.addEventListener('load', ()=>{
        try{
          const src = String(iframe.src || '');
          console.debug('overlay iframe loaded', { src });

          // Quick URL-based heuristic
          const looksLikePlatformURL = (u)=> !!(u && (u.indexOf('global_platform.html') !== -1 || u.indexOf('global_platform_correct.html') !== -1 || u.indexOf('/global/') !== -1));
          if(looksLikePlatformURL(src)){
            console.debug('iframe.src looks like platform -> closing overlay');
            try{ closeGame(); }catch(e){}
            try{ window.location.href = new URL('./brainova.html', window.location.href).href; }catch(e){}
            showAutoCloseToast();
            return;
          }

          // If same-origin, inspect the iframe's document for platform markers
          try{
            const cw = iframe.contentWindow;
            if(cw && cw.document){
              const title = String(cw.document.title || '');
              const bodyText = (cw.document.body && cw.document.body.innerText) ? cw.document.body.innerText : '';
              console.debug('iframe document title:', title);
              // marker: hero title or gamesGrid element
              const hasGamesGrid = !!cw.document.getElementById('gamesGrid');
              const looksLikePlatformDoc = hasGamesGrid || /Catalogue Brainova|36 JEUX|Catalogue Brainova/i.test(title + '\n' + bodyText);
              if(looksLikePlatformDoc){
                console.debug('iframe document looks like platform (title/body/selector match) -> closing overlay');
                try{ closeGame(); }catch(e){}
                try{ window.location.href = new URL('./brainova.html', window.location.href).href; }catch(e){}
                showAutoCloseToast();
                return;
              }
            }
          }catch(e){ console.debug('iframe doc inspection failed (cross-origin?)', e); }

        }catch(e){ console.warn('Error in iframe load handler', e); }
      });

      // Small non-blocking toast to inform user the overlay was auto-closed
      function showAutoCloseToast(){
        try{
          const id = 'autoCloseToast';
          if(document.getElementById(id)) return;
          const div = document.createElement('div');
          div.id = id;
          div.textContent = 'Retour √† la plateforme';
          div.style.cssText = 'position:fixed;bottom:18px;left:50%;transform:translateX(-50%);background:linear-gradient(90deg,#00d4ff,#00ff88);color:#001;padding:8px 12px;border-radius:8px;z-index:10005;font-weight:700;box-shadow:0 8px 24px rgba(0,0,0,0.4);';
          document.body.appendChild(div);
          setTimeout(()=>{ try{ div.style.transition='opacity .4s'; div.style.opacity='0'; setTimeout(()=>div.remove(),450); }catch(e){} }, 900);
        }catch(e){}
      }
      iframe.addEventListener('error', (ev)=>{
        try{ console.error('overlay iframe error loading', iframe.src, ev); }catch(e){}
      });

      // Allow games inside the iframe to communicate with the parent page using postMessage.
      // For example the game can call: window.parent.postMessage({ action: 'close' }, '*')
      // or { action: 'home' } to request closing the overlay / returning to the platform.
      window.addEventListener('message', (ev)=>{
        try{
          // Normalize payload: many games send either objects or JSON strings
          let data = ev && ev.data ? ev.data : null;
          if(!data) return;
          if(typeof data === 'string'){
            try{ data = JSON.parse(data); }catch(_){ /* not JSON - ignore */ }
          }
          if(!data || typeof data !== 'object') return;
          const action = data.action && String(data.action).toLowerCase();
          if(!action) return;
          if(action === 'close' || action === 'exit' || action === 'home' || action === 'go-home'){
            try{ closeGame(); }catch(e){}
            try{ /* also return to platform home (reload) for a clear UX) */ window.location.href = new URL('./brainova.html', window.location.href).href; }catch(e){}
            return;
          }
          if(action === 'open' && data.url){
            try{ window.open(String(data.url), '_blank'); }catch(e){}
            return;
          }
          if(action === 'navigate' && data.url){
            try{ window.location.href = String(data.url); }catch(e){}
            return;
          }
        }catch(err){ /* ignore malformed messages */ }
      });

      // show header after load
      window.addEventListener('load', ()=>{
        document.getElementById('loader').style.display='none';
        document.getElementById('header').style.display='flex';
        // wire auth buttons
        const b1 = document.getElementById('btnLogin'); if(b1) b1.addEventListener('click', ()=>openAuth('login'));
        const b2 = document.getElementById('btnSignup'); if(b2) b2.addEventListener('click', ()=>openAuth('signup'));
  // show saved sigle if user already logged in
        try{
          const saved = localStorage.getItem('brainovaUser');
          if(saved){
            const u = JSON.parse(saved);
            const sig = (u.avatar && u.avatar.length>0) ? u.avatar : (u.name?u.name.split(' ').map(n=>n.charAt(0)).join('').toUpperCase():'');
            const sigEl = document.getElementById('userSigle');
            if(sigEl && sig){ sigEl.textContent = sig; sigEl.style.display='flex'; }
          }
        }catch(e){/* ignore */}
        // populate the local state bar (helps in file:// mode)
        try{
          function updateLocalStateBar(){
            const txt = document.getElementById('localStateText'); if(!txt) return;
            try{
              const bundle = localStorage.getItem('bundlePurchased') === '1';
              const parts = [];
              if(bundle) parts.push('bundlePurchased=1');
              for(let i=0;i<=36;i++){ if(localStorage.getItem('purchased_game_'+i) === '1') parts.push('purchased_game_'+i+'=1'); }
              txt.textContent = parts.length ? ('√âtat local: ' + parts.join(' | ')) : '√âtat local: aucun achat d√©tect√©';
            }catch(e){ txt.textContent = '√âtat local: erreur de lecture'; }
          }
          const rbtn = document.getElementById('localStateRefresh'); if(rbtn) rbtn.addEventListener('click', updateLocalStateBar);
          const cbtn = document.getElementById('localStateClear'); if(cbtn) cbtn.addEventListener('click', ()=>{ if(!confirm('Supprimer bundlePurchased et tous les flags purchased_game_* ?')) return; localStorage.removeItem('bundlePurchased'); for(let i=0;i<=36;i++) localStorage.removeItem('purchased_game_'+i); updateLocalStateBar(); alert('Flags supprim√©s'); });
          updateLocalStateBar();
        }catch(e){}
        // initialize single language select
        const langSelect = document.getElementById('langSelect');
        const LangMeta = { fr:{emoji:'üá´üá∑', label:'FR'}, en:{emoji:'üá¨üáß', label:'EN'}, ar:{emoji:'üá∏üá¶', label:'AR'}, es:{emoji:'üá™üá∏', label:'ES'}, de:{emoji:'üá©üá™', label:'DE'}, zh:{emoji:'üá®üá≥', label:'‰∏≠Êñá'} };

        function updateLangPickerUI(lang){
          try{
            if(langSelect) {
              langSelect.value = lang;
              // update visible label is already handled by the select's option text
            }
          }catch(e){/* ignore */}
        }

        // handle selection
        if(langSelect){
          langSelect.addEventListener('change', function(){ selectLang(this.value); });
        }

        function selectLang(L){ if(!L) return; applyLanguage(L); updateLangPickerUI(L); localStorage.setItem('brainovaLang', L); 
          // notify children frames (so embedded games update immediately)
          try{ window.frames && Array.from(document.getElementsByTagName('iframe')).forEach(f=>{ try{ f.contentWindow.postMessage({ action:'set-language', lang: L }, '*'); }catch(e){} }); }catch(e){}
        }
  // set initial label and apply language
  updateLangPickerUI(currentLang);
  applyLanguage(currentLang);
        // settings menu
        const sBtn = document.getElementById('settingsBtn'); const sMenu = document.getElementById('settingsMenu');
        if(sBtn && sMenu){ sBtn.addEventListener('click', ()=>{ sMenu.style.display = (sMenu.style.display === 'block') ? 'none' : 'block'; }); }
        document.getElementById('settingsEditProfile').addEventListener('click', ()=>{ sMenu.style.display='none'; openAuth('profile'); });
        document.getElementById('settingsHistory').addEventListener('click', ()=>{ sMenu.style.display='none'; openAuth('history'); });
      });

      // Fallback: listen to localStorage events so a standalone auth page can notify the platform
      // Some environments (file://, cross-origin) may not allow postMessage or direct API calls.
      // Auth pages write 'brainova_temp_user' as a one-time signal; react to it and then remove the key.
      window.addEventListener('storage', function(e){
        try{
          if(!e) return;
          if(e.key === 'brainova_temp_user' && e.newValue){
            try{ closeGame(); }catch(_){}
            try{ // reload to pick up new user state or navigate to home
              window.location.href = new URL('./brainova.html', window.location.href).href;
            }catch(e2){ try{ window.location.reload(); }catch(_){} }
            // remove the temp key to avoid re-triggering
            try{ localStorage.removeItem('brainova_temp_user'); }catch(_){}
          }
        }catch(err){}
      });

      // Listen to messages from iframes so games can ask the platform to close the overlay
      window.addEventListener('message', (e)=>{
        try{
          // Accept object payloads and JSON strings from older pages
          let data = e.data || null;
          if(!data) return;
          if(typeof data === 'string'){
            try{ data = JSON.parse(data); }catch(_){ /* ignore non-json */ }
          }
          if(!data || typeof data !== 'object') return;
          if(data && data.action === 'close'){
            closeGame();
            try{ window.location.href = new URL('./brainova.html', window.location.href).href; }catch(e){}
          }
          if(data && data.action === 'login-success'){
            console.debug('Received login-success from iframe', data.user);
            // Close overlay then reload or navigate to homepage
            closeGame();
            try{
              try{
                const u = data.user || {};
                const sig = (u.avatar && u.avatar.length>0) ? u.avatar : (u.name?u.name.split(' ').map(n=>n.charAt(0)).join('').toUpperCase():'');
                const sigEl = document.getElementById('userSigle');
                if(sigEl && sig){ sigEl.textContent = sig; sigEl.style.display='flex'; }
              }catch(e){}
              window.location.href = new URL('./brainova.html', window.location.href).href; // go to brainova home
            }catch(err){
              window.location.reload();
            }
          }
          // Message from embedded game asking to return to platform home
          if(data && (data.action === 'go-home' || data.action === 'home')){
            console.debug('Received go-home from iframe');
            try{ closeGame(); window.location.href = new URL('./brainova.html', window.location.href).href; }catch(err){ window.location.reload(); }
          }
        }catch(err){/* ignore */}
      });

      // Tester tous les jeux : v√©rifie chaque jeuxN.html et met √† jour le statut
      const checkBtn = document.getElementById('checkAllBtn');
      const checkStatus = document.getElementById('checkStatus');
      checkBtn.addEventListener('click', async ()=>{
        checkBtn.disabled = true; checkStatus.textContent = 'Test en cours...';
        let ok = 0, fail = 0;
          for(let i=0;i<=total;i++){
          const meta = gameMap[i] || {};
          const candidates = [];
          if(meta.file) candidates.push(meta.file);
          candidates.push(`./jeux${i}.html`);
          candidates.push(`./jeux${i}.html.html`);
          const card = grid.querySelector(`.game-card[data-game-id="${i}"]`);
          const statusEl = card.querySelector('.game-status');
          let found = false;
          for(const url of candidates){
            if(!url) continue;
            try{
              const safe = normalizeUrl(new URL(url, window.location.href).href);
              const r = await fetch(safe, {method:'HEAD'});
              if(r.ok){ statusEl.textContent = 'OK'; statusEl.style.background = 'linear-gradient(45deg,#00ff88,#ffd700)'; statusEl.style.color = '#000'; ok++; found = true; break; }
            }catch(e){ /* try next */ }
          }
          if(!found){ statusEl.textContent = 'N/D'; statusEl.style.background = 'rgba(255,0,0,0.12)'; fail++; }
        }
        checkStatus.textContent = `R√©sultat : ${ok} OK / ${fail} FAIL`;
        checkBtn.disabled = false;
      });

    })();
  </script>
  <script>
    // Wire category buttons to filter the games grid by meta.tags
    (function(){
      const hero = document.getElementById('catalog-hero');
      if(!hero) return;
      const buttons = hero.querySelectorAll('.cat');
      const grid = document.getElementById('gamesGrid');
      if(!buttons.length || !grid) return;
      buttons.forEach(b=>{
        b.addEventListener('click', ()=>{
          const filter = (b.dataset.filter||'').toString().toLowerCase();
          const cards = grid.querySelectorAll('.game-card');
          cards.forEach(c=>{
            const id = Number(c.dataset.gameId);
            const meta = (window.gameMap && window.gameMap[id]) ? window.gameMap[id] : null;
            const tags = (meta && meta.tags) ? meta.tags.map(t=>t.toString().toLowerCase()) : [];
            if(!filter || tags.includes(filter)) c.style.display='block'; else c.style.display='none';
          });
        });
      });
    })();
  </script>
  <script>
    // Debug panel wiring (temporary)
    (function(){
      function safe(id){ try{ return document.getElementById(id); }catch(e){ return null; } }
      function updateDebug(){
        const g = safe('dbgGamesIndex'); if(g) g.textContent = (window.GamesIndex ? 'loaded' : 'missing');
        const o = safe('dbgOverlay'); if(o) o.textContent = (window.OverlayManager ? 'present' : 'missing');
        // If GamesIndex exposes a lastResolvedUrl helper, use it; otherwise keep previous value
        const last = safe('dbgLastUrl'); if(last){
          if(window.GamesIndex && typeof window.GamesIndex._lastResolved === 'string') last.textContent = window.GamesIndex._lastResolved;
        }
      }
      updateDebug();
      // Poll a few times in case GamesIndex/OverlayManager load after initial run
      let pollCount = 0; const pollMax = 6;
      const pollInterval = setInterval(()=>{
        pollCount++; updateDebug();
        if(window.GamesIndex || window.OverlayManager || pollCount>=pollMax){ clearInterval(pollInterval); }
      }, 1000);
      // Buttons
      const btnOpen2 = safe('dbgOpen2');
      const btnSet2 = safe('dbgSet2');
      const btnOpenNew = safe('dbgOpenNew');
      if(btnOpen2) btnOpen2.addEventListener('click', ()=>{
        try{
          if(window.GamesIndex && typeof window.GamesIndex.launch === 'function'){
            GamesIndex.launch(2);
          }else{
            // fallback: try platform openGame function
            try{ openGame(2); }catch(e){ window.open('./jeux2brainova.html','_blank'); }
          }
        }catch(e){ console.error(e); }
        updateDebug();
      });
      if(btnOpenNew) btnOpenNew.addEventListener('click', ()=>{ window.open('./jeux2brainova.html','_blank'); });
      if(btnSet2) btnSet2.addEventListener('click', ()=>{
        try{
          const iframe = document.getElementById('overlayIframe');
          if(iframe){ iframe.src = './jeux2brainova.html'; }
          const ov = document.getElementById('overlay'); if(ov) ov.classList.add('active');
          const title = document.getElementById('overlayTitle'); if(title) title.textContent = 'Jeu 2';
          const last = safe('dbgLastUrl'); if(last) last.textContent = './jeux2brainova.html';
        }catch(e){ console.error(e); }
        updateDebug();
      });
      // Reload GamesIndex on demand
      const btnReload = safe('dbgReloadIndex');
      const errBox = safe('dbgError');
      if(btnReload) btnReload.addEventListener('click', async ()=>{
        try{ if(typeof window.tryLoadGamesIndex === 'function'){ errBox.textContent = 'Rechargement...'; const ok = await window.tryLoadGamesIndex(); if(ok) errBox.textContent = 'Charg√©'; else errBox.textContent = (window.__gamesIndexError||'Erreur inconnue'); } else { errBox.textContent = 'Pas de fonction de rechargement expos√©e'; } }catch(e){ errBox.textContent = e && e.message ? e.message : String(e); }
        updateDebug();
      });
      if(errBox && window.__gamesIndexError) errBox.textContent = window.__gamesIndexError;
      // Refresh status a few times in case GamesIndex/OverlayManager load later
      setTimeout(updateDebug, 500);
      setTimeout(updateDebug, 2000);
    })();
  </script>
</body>
</html>

