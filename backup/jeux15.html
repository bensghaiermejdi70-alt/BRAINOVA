<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuroSynth Explorer - Brainova Premium</title>
    <script>
        (function(){
            if(window.__platform_nonblocking_dialogs) return; window.__platform_nonblocking_dialogs=true;
            try{
                const _alert = window.alert.bind(window);
                const _confirm = window.confirm.bind(window);
                const _prompt = window.prompt.bind(window);
                function send(type,text){ try{ if(window.parent && window.parent!==window) parent.postMessage({action:'dialog', dialogType:type, text:String(text||'')}, '*'); }catch(e){} }
                window.alert = function(msg){ if(window.parent && window.parent!==window){ send('alert', msg); } else { _alert(msg); } };
                window.confirm = function(msg){ if(window.parent && window.parent!==window){ send('confirm', msg); return true; } else { return _confirm(msg); } };
                window.prompt = function(msg, def){ if(window.parent && window.parent!==window){ send('prompt', msg+'\n(default: '+(def||'')+')'); return def||null; } else { return _prompt(msg, def); } };
            }catch(e){ }
        })();
    </script>
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Orbitron', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            overflow: hidden;
            height: 100vh;
        }
        body::before {
            content: "";
            position: fixed;
            inset: 0;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 80%, rgba(0, 255, 255, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 0, 255, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(0, 255, 0, 0.2) 0%, transparent 50%);
            animation: quantumShift 10s ease-in-out infinite;
        }

        @keyframes quantumShift {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(2deg); }
        }

        .neural-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: #00ffff;
            border-radius: 50%;
            animation: float 8s ease-in-out infinite;
            box-shadow: 0 0 10px #00ffff;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) translateX(0px) rotate(0deg); opacity: 0.3; }
            25% { transform: translateY(-30px) translateX(20px) rotate(90deg); opacity: 1; }
            50% { transform: translateY(-60px) translateX(-10px) rotate(180deg); opacity: 0.7; }
            75% { transform: translateY(-30px) translateX(-20px) rotate(270deg); opacity: 1; }
        }

        .main-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: linear-gradient(135deg, rgba(10, 10, 20, 0.95) 0%, rgba(20, 30, 40, 0.95) 100%);
            backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 25px;
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.1) 0%, rgba(255, 0, 255, 0.1) 100%);
            border-bottom: 2px solid rgba(0, 255, 255, 0.3);
            backdrop-filter: blur(15px);
            z-index: 100;
        }

        .game-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .game-title h1 {
            font-size: 24px;
            font-weight: 900;
            background: linear-gradient(135deg, #00ffff, #ff00ff, #00ff00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
            text-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
            letter-spacing: 2px;
            animation: titlePulse 3s ease-in-out infinite;
        }

        @keyframes titlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .game-logo {
            font-size: 28px;
            filter: drop-shadow(0 0 20px #00ffff);
            animation: logoRotate 6s linear infinite;
        }

        @keyframes logoRotate {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .hud-stats {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .language-selector {
            margin-right: 20px;
        }

        .lang-select {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.2) 0%, rgba(255, 0, 255, 0.2) 100%);
            border: 1px solid rgba(0, 255, 255, 0.5);
            border-radius: 10px;
            color: #ffffff;
            padding: 8px 12px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .lang-select:hover {
            border-color: rgba(0, 255, 255, 0.8);
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.3) 0%, rgba(255, 0, 255, 0.3) 100%);
        }

        .lang-select option {
            background: #1a1a2e;
            color: #ffffff;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 12px;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            backdrop-filter: blur(10px);
            min-width: 60px;
        }

        .stat-label {
            font-size: 10px;
            color: #00ffff;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-value {
            font-size: 16px;
            font-weight: bold;
            color: #ffffff;
            margin-top: 2px;
        }

        .game-world {
            flex: 1;
            position: relative;
            overflow: hidden;
            display: flex;
        }

        .world-3d {
            flex: 1;
            position: relative;
            background: 
                linear-gradient(180deg, 
                    rgba(135, 206, 235, 0.9) 0%,
                    rgba(144, 238, 144, 0.8) 20%,
                    rgba(34, 139, 34, 0.7) 40%,
                    rgba(0, 100, 0, 0.8) 70%,
                    rgba(25, 25, 112, 0.9) 100%),
                radial-gradient(ellipse at 30% 20%, rgba(255, 255, 255, 0.3) 0%, transparent 50%),
                radial-gradient(ellipse at 70% 80%, rgba(46, 125, 50, 0.4) 0%, transparent 60%);
            perspective: 1000px;
            overflow: hidden;
        }

        .forest-layer {
            position: absolute;
            width: 120%;
            height: 120%;
            background-image: 
                radial-gradient(ellipse at 15% 25%, rgba(34, 139, 34, 0.6) 0%, transparent 30%),
                radial-gradient(ellipse at 45% 60%, rgba(0, 128, 0, 0.4) 0%, transparent 40%),
                radial-gradient(ellipse at 75% 35%, rgba(46, 125, 50, 0.5) 0%, transparent 35%),
                radial-gradient(ellipse at 85% 75%, rgba(25, 111, 61, 0.3) 0%, transparent 45%),
                linear-gradient(90deg, 
                    rgba(139, 69, 19, 0.2) 0%, 
                    transparent 20%, 
                    transparent 80%, 
                    rgba(160, 82, 45, 0.2) 100%);
            animation: forestSway 15s ease-in-out infinite;
        }

        .ground-layer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 30%;
            background: 
                linear-gradient(180deg, 
                    rgba(34, 139, 34, 0.8) 0%,
                    rgba(107, 142, 35, 0.9) 30%,
                    rgba(85, 107, 47, 0.95) 70%,
                    rgba(139, 69, 19, 1) 100%);
            z-index: 0;
        }

        .sky-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 40%;
            background: 
                linear-gradient(180deg, 
                    rgba(135, 206, 235, 0.9) 0%,
                    rgba(176, 224, 230, 0.7) 50%,
                    rgba(144, 238, 144, 0.5) 100%);
            z-index: -1;
        }

        .mountain-layer {
            position: absolute;
            bottom: 30%;
            left: 0;
            width: 100%;
            height: 40%;
            background: 
                linear-gradient(180deg, 
                    rgba(105, 105, 105, 0.8) 0%,
                    rgba(119, 136, 153, 0.6) 50%,
                    rgba(34, 139, 34, 0.4) 100%);
            clip-path: polygon(0% 100%, 15% 60%, 25% 80%, 40% 40%, 55% 70%, 70% 30%, 85% 60%, 100% 50%, 100% 100%);
            z-index: -1;
        }

        @keyframes forestSway {
            0%, 100% { transform: translateX(-10px) translateY(-5px) rotateX(2deg); }
            50% { transform: translateX(10px) translateY(5px) rotateX(-2deg); }
        }
        .tree {
            
            height: 120px;
            background: linear-gradient(180deg, 
                rgba(34, 139, 34, 0.9) 0%,
                rgba(0, 128, 0, 0.8) 20%,
                rgba(46, 125, 50, 0.7) 40%,
                rgba(139, 69, 19, 0.9) 65%,
                rgba(101, 67, 33, 1) 100%);
            border-radius: 30px 30px 8px 8px;
            transform-style: preserve-3d;
            animation: treeGlow 4s ease-in-out infinite;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 
                0 0 15px rgba(34, 139, 34, 0.4),
                inset 0 0 20px rgba(0, 0, 0, 0.2);
        }

        .tree::before {
            content: '';
            position: absolute;
            top: 5px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            background: radial-gradient(circle, rgba(46, 125, 50, 0.8) 0%, rgba(34, 139, 34, 0.6) 70%, transparent 100%);
            border-radius: 50%;
            z-index: 1;
        }

        .tree::after {
            content: '';
            position: absolute;
            top: 15px;
            left: 20%;
            width: 25px;
            height: 25px;
            background: radial-gradient(circle, rgba(0, 128, 0, 0.7) 0%, rgba(34, 139, 34, 0.5) 70%, transparent 100%);
            border-radius: 50%;
            z-index: 1;
        }

        .tree:hover {
            transform: scale(1.1) rotateY(10deg);
            box-shadow: 
                0 0 30px rgba(34, 139, 34, 0.8),
                0 0 50px rgba(0, 255, 255, 0.3);
        }

        @keyframes treeGlow {
            0%, 100% { 
                box-shadow: 
                    0 0 15px rgba(34, 139, 34, 0.4),
                    inset 0 0 20px rgba(0, 0, 0, 0.2);
            }
            50% { 
                box-shadow: 
                    0 0 25px rgba(34, 139, 34, 0.6),
                    0 0 40px rgba(0, 255, 255, 0.2),
                    inset 0 0 20px rgba(0, 0, 0, 0.2);
            }
        }

        .neural-node {
            position: absolute;
            width: 40px;
            height: 40px;
            background: radial-gradient(circle, rgba(255, 0, 255, 0.8) 0%, rgba(0, 255, 255, 0.4) 100%);
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.6);
            cursor: pointer;
            animation: nodePulse 2s ease-in-out infinite;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .neural-node:hover {
            transform: scale(1.2);
            animation-duration: 0.5s;
        }

        @keyframes nodePulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(255, 0, 255, 0.5); }
            50% { transform: scale(1.1); box-shadow: 0 0 40px rgba(255, 0, 255, 0.8); }
        }

        .memory-crystal {
            position: absolute;
            width: 30px;
            height: 30px;
            background: linear-gradient(45deg, 
                rgba(255, 215, 0, 0.9) 0%,
                rgba(255, 255, 0, 0.7) 50%,
                rgba(255, 215, 0, 0.9) 100%);
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            animation: crystalSpin 3s linear infinite;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .memory-crystal:hover {
            transform: scale(1.3);
            filter: brightness(1.5);
        }

        @keyframes crystalSpin {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        .ai-entity {
            position: absolute;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, 
                rgba(0, 255, 255, 0.8) 0%,
                rgba(0, 200, 255, 0.6) 30%,
                rgba(0, 150, 255, 0.4) 60%,
                rgba(0, 100, 255, 0.2) 100%);
            border-radius: 50%;
            border: 3px solid rgba(255, 255, 255, 0.8);
            animation: aiFloat 5s ease-in-out infinite;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.3s ease;
        }

        .ai-entity:hover {
            transform: scale(1.2);
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.8);
        }

        @keyframes aiFloat {
            0%, 100% { transform: translateY(0px) rotateZ(0deg); }
            25% { transform: translateY(-20px) rotateZ(5deg); }
            50% { transform: translateY(-40px) rotateZ(0deg); }
            75% { transform: translateY(-20px) rotateZ(-5deg); }
        }

        .side-panel {
            width: 300px;
            background: linear-gradient(135deg, rgba(10, 10, 30, 0.95) 0%, rgba(20, 20, 40, 0.95) 100%);
            border-left: 2px solid rgba(0, 255, 255, 0.3);
            backdrop-filter: blur(15px);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .panel-section {
            padding: 20px;
            border-bottom: 1px solid rgba(0, 255, 255, 0.2);
        }

        .panel-title {
            font-size: 16px;
            font-weight: bold;
            color: #00ffff;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .neural-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            margin: 5px 0;
            width: 100%;
        }

        .neural-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }

        .neural-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .neural-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }

        .neural-btn:hover::before {
            left: 100%;
        }

        .action-btn {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #1a1a2e;
        }

        .action-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #ffed4e 0%, #ffd700 100%);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.6);
        }

        .danger-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }

        .danger-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #ee5a24 0%, #ff6b6b 100%);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
        }

        .success-btn {
            background: linear-gradient(135deg, #00d2d3 0%, #54a0ff 100%);
        }

        .success-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #54a0ff 0%, #00d2d3 100%);
            box-shadow: 0 6px 20px rgba(0, 210, 211, 0.6);
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .inventory-slot {
            width: 60px;
            height: 60px;
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .inventory-slot:hover {
            border-color: rgba(0, 255, 255, 0.8);
            background: rgba(0, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .inventory-slot.filled {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.2) 0%, rgba(255, 0, 255, 0.2) 100%);
            border-color: rgba(0, 255, 255, 0.8);
        }

        .quest-item {
            padding: 15px;
            margin: 10px 0;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quest-item:hover {
            background: rgba(0, 255, 255, 0.2);
            border-color: rgba(0, 255, 255, 0.6);
            transform: translateX(5px);
        }

        .quest-item.completed {
            background: rgba(0, 255, 0, 0.1);
            border-color: rgba(0, 255, 0, 0.3);
            opacity: 0.7;
        }

        .quest-title {
            font-weight: bold;
            color: #00ffff;
            margin-bottom: 5px;
        }

        .quest-description {
            font-size: 12px;
            color: #cccccc;
            line-height: 1.4;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ffff, #ff00ff);
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .neural-network {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .neural-connection {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, rgba(0, 255, 255, 0.6), rgba(255, 0, 255, 0.6));
            transform-origin: left center;
            animation: connectionPulse 3s ease-in-out infinite;
        }

        @keyframes connectionPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(10, 10, 30, 0.95) 0%, rgba(20, 20, 40, 0.95) 100%);
            border: 2px solid rgba(0, 255, 255, 0.5);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            backdrop-filter: blur(15px);
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.3);
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: #00ffff;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .modal-text {
            font-size: 16px;
            color: #ffffff;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .puzzle-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }

        .puzzle-cell {
            width: 60px;
            height: 60px;
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .puzzle-cell:hover {
            border-color: rgba(0, 255, 255, 0.8);
            background: rgba(0, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .puzzle-cell.active {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.3) 0%, rgba(255, 0, 255, 0.3) 100%);
            border-color: rgba(0, 255, 255, 0.8);
        }

        .message-display {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.9) 0%, rgba(255, 0, 255, 0.9) 100%);
            color: #000000;
            padding: 15px 25px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 16px;
            z-index: 999;
            opacity: 0;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
        }

        .message-display.show {
            opacity: 1;
            transform: translateX(-50%) translateY(10px);
        }

        @media (max-width: 1200px) {
            .game-world {
                flex-direction: column;
            }
            
            .side-panel {
                width: 100%;
                height: 200px;
                border-left: none;
                border-top: 2px solid rgba(0, 255, 255, 0.3);
            }
            
            .panel-section {
                padding: 10px;
            }
        }

        @media (max-width: 800px) {
            .game-title h1 {
                font-size: 18px;
            }
            
            .hud-stats {
                gap: 10px;
            }
            
            .stat-item {
                padding: 6px 8px;
                min-width: 50px;
            }
        }

        .minimap {
            width: 150px;
            height: 150px;
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.5);
            position: relative;
            margin: 10px 0;
        }

        .minimap-dot {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #00ffff;
            animation: minimapPulse 2s ease-in-out infinite;
        }

        @keyframes minimapPulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .ai-chat {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
        }

        .chat-message {
            margin: 8px 0;
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 12px;
            line-height: 1.4;
        }

        .chat-message.ai {
            background: rgba(0, 255, 255, 0.1);
            border-left: 3px solid #00ffff;
        }

        .chat-message.player {
            background: rgba(255, 0, 255, 0.1);
            border-right: 3px solid #ff00ff;
            text-align: right;
        }

        /* Styles pour l'arabe (RTL) */
        .rtl {
            direction: rtl;
            text-align: right;
        }

        .rtl .game-header {
            flex-direction: row-reverse;
        }

        .rtl .hud-stats {
            flex-direction: row-reverse;
        }

        .rtl .game-title {
            flex-direction: row-reverse;
        }

        .rtl .panel-title {
            flex-direction: row-reverse;
        }

        .rtl .quest-item:hover {
            transform: translateX(-5px);
        }

        .rtl .chat-message.ai {
            border-left: none;
            border-right: 3px solid #00ffff;
            text-align: right;
        }

        .rtl .chat-message.player {
            border-right: none;
            border-left: 3px solid #ff00ff;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="quantum-bg"></div>
    <div class="neural-particles" id="neuralParticles"></div>
    
    <div class="main-container">
        <!-- En-tÃªte du jeu -->
        <div class="game-header">
            <div class="game-title">
                <div class="game-logo">ğŸ§ </div>
                <h1>NEUROSYNTH EXPLORER</h1>
                <div style="font-size: 12px; color: #00ffff; margin-left: 10px;">BRAINOVA PREMIUM</div>
            </div>
            
            <div class="hud-stats">
                <div class="language-selector">
                    <select id="languageSelect" onchange="changeLanguage(this.value)" class="lang-select">
                        <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                        <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                        <option value="ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                        <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                        <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
                        <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                    </select>
                </div>
                <div class="stat-item">
                    <div class="stat-label" data-lang="level">Niveau</div>
                    <div class="stat-value" id="playerLevel">1</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label" data-lang="xp">XP</div>
                    <div class="stat-value" id="playerXP">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label" data-lang="energy">Ã‰nergie</div>
                    <div class="stat-value" id="playerEnergy">100</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label" data-lang="crystals">Cristaux</div>
                    <div class="stat-value" id="crystalCount">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label" data-lang="time">Temps</div>
                    <div class="stat-value" id="gameTime">00:00</div>
                </div>
                <!-- Global platform close button -->
                <button class="global-close-btn" title="Fermer" aria-label="Fermer" onclick="closePlatform()" style="margin-left:12px; background:transparent; border:2px solid rgba(255,255,255,0.12); color:#ff6b6b; font-size:20px; width:36px; height:36px; border-radius:18px; display:flex; align-items:center; justify-content:center;">âœ•</button>
            </div>
        </div>

        <div class="game-world">
            <!-- Monde 3D principal -->
            <div class="world-3d" id="gameWorld">
                <div class="sky-layer"></div>
                <div class="mountain-layer"></div>
                <div class="forest-layer"></div>
                <div class="ground-layer"></div>
                <div class="neural-network" id="neuralNetwork"></div>
                
                <!-- Les Ã©lÃ©ments du jeu seront gÃ©nÃ©rÃ©s dynamiquement -->
            </div>

            <!-- Panneau latÃ©ral -->
            <div class="side-panel">
                <!-- Section ContrÃ´les du Jeu -->
                <div class="panel-section">
                    <div class="panel-title">ğŸ® ContrÃ´les</div>
                    <button class="neural-btn action-btn" id="startGameBtn" onclick="startGame()" data-lang="start_game">ğŸ® Commencer le Jeu</button>
                    <button class="neural-btn" id="pauseResumeBtn" onclick="togglePause()" data-lang="pause_game" style="display: none;">â¸ï¸ Pause</button>
                </div>

                <!-- Section Guide -->
                <div class="panel-section">
                    <div class="panel-title" data-lang="game_guide">ğŸ“– Guide de Jeu</div>
                    <div style="font-size: 11px; color: #cccccc; line-height: 1.4; margin-bottom: 10px;" id="gameGuideContent">
                        <strong style="color: #00ffff;" data-lang="how_to_play">ğŸ® COMMENT JOUER :</strong><br>
                        <span data-lang="guide_crystals">â€¢ Cliquez sur les ğŸ’ cristaux pour les collecter</span><br>
                        <span data-lang="guide_nodes">â€¢ Activez les ğŸ§  nÅ“uds neuraux (2 cristaux requis)</span><br>
                        <span data-lang="guide_ai">â€¢ Parlez aux ğŸ¤– entitÃ©s IA pour progresser</span><br>
                        <span data-lang="guide_puzzles">â€¢ RÃ©solvez les Ã©nigmes pour gagner de l'XP</span><br>
                        <span data-lang="guide_scan">â€¢ Utilisez ESPACE pour scanner la zone</span><br>
                        <span data-lang="guide_meditate">â€¢ Appuyez sur M pour mÃ©diter</span><br><br>
                        <strong style="color: #ffd700;" data-lang="objectives">ğŸ† OBJECTIFS :</strong><br>
                        <span data-lang="obj_crystals">â€¢ Collectez 5 cristaux de mÃ©moire</span><br>
                        <span data-lang="obj_ai">â€¢ Connectez-vous Ã  3 entitÃ©s IA</span><br>
                        <span data-lang="obj_puzzles">â€¢ RÃ©solvez 10 Ã©nigmes neurales</span>
                    </div>
                </div>

                <!-- Section Actions -->
                <div class="panel-section">
                    <div class="panel-title" data-lang="actions">âš¡ Actions</div>
                    <button class="neural-btn action-btn" onclick="scanArea()" data-lang="scan_area">ğŸ” Scanner Zone</button>
                    <button class="neural-btn" onclick="meditate()" data-lang="neural_meditation">ğŸ§˜ MÃ©ditation Neural</button>
                    <button class="neural-btn success-btn" onclick="saveProgress()" data-lang="save">ğŸ’¾ Sauvegarder</button>
                    <button class="neural-btn danger-btn" onclick="resetGame()" data-lang="new_journey">ğŸ”„ Nouveau Voyage</button>
                </div>

                <!-- Section QuÃªtes -->
                <div class="panel-section">
                    <div class="panel-title" data-lang="active_missions">ğŸ¯ Missions Actives</div>
                    <div id="questList">
                        <div class="quest-item" onclick="selectQuest(0)">
                            <div class="quest-title" data-lang="neural_awakening">Ã‰veil Neural</div>
                            <div class="quest-description" data-lang="neural_awakening_desc">Collectez 5 cristaux de mÃ©moire pour activer votre premier nÅ“ud neural.</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%" id="quest0Progress"></div>
                            </div>
                        </div>
                        <div class="quest-item" onclick="selectQuest(1)">
                            <div class="quest-title" data-lang="ai_connection">Connexion IA</div>
                            <div class="quest-description" data-lang="ai_connection_desc">Ã‰tablissez le contact avec 3 entitÃ©s IA dans la forÃªt mystique.</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%" id="quest1Progress"></div>
                            </div>
                        </div>
                        <div class="quest-item" onclick="selectQuest(2)">
                            <div class="quest-title" data-lang="puzzle_master">MaÃ®tre des Ã‰nigmes</div>
                            <div class="quest-description" data-lang="puzzle_master_desc">RÃ©solvez 10 Ã©nigmes neurales pour dÃ©bloquer de nouveaux pouvoirs.</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%" id="quest2Progress"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section Inventaire -->
                <div class="panel-section">
                    <div class="panel-title" data-lang="neural_inventory">ğŸ’ Inventaire Neural</div>
                    <div class="inventory-grid" id="inventoryGrid">
                        <!-- Les slots d'inventaire seront gÃ©nÃ©rÃ©s dynamiquement -->
                    </div>
                </div>

                <!-- Section Minimap -->
                <div class="panel-section">
                    <div class="panel-title" data-lang="neural_map">ğŸ—ºï¸ Carte Neural</div>
                    <div class="minimap" id="minimap">
                        <!-- Les points de la minimap seront gÃ©nÃ©rÃ©s dynamiquement -->
                    </div>
                </div>

                <!-- Section IA Assistant -->
                <div class="panel-section">
                    <div class="panel-title" data-lang="assistant_aria">ğŸ¤– Assistant ARIA</div>
                    <div class="ai-chat" id="aiChat">
                        <div class="chat-message ai" data-lang="welcome_message">
                            Bienvenue, Explorateur Neural ! Je suis ARIA, votre assistant IA. PrÃªt Ã  explorer les mystÃ¨res de la forÃªt quantique ?
                        </div>
                    </div>
                    <button class="neural-btn success-btn" onclick="askAI()" data-lang="talk_to_aria">ğŸ’¬ Parler Ã  ARIA</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal pour les Ã©nigmes -->
    <div class="modal" id="puzzleModal">
        <div class="modal-content">
            <div class="modal-title" id="puzzleTitle" data-lang="neural_puzzle">Ã‰nigme Neural</div>
            <div class="modal-text" id="puzzleDescription" data-lang="puzzle_description">RÃ©solvez cette Ã©nigme pour progresser...</div>
            <div style="text-align: center; margin: 10px 0; color: #00ffff; font-weight: bold;">
                <span data-lang="moves_left">Mouvements restants</span>: <span id="movesCounter">5</span>
            </div>
            <div class="puzzle-grid" id="puzzleGrid">
                <!-- La grille de puzzle sera gÃ©nÃ©rÃ©e dynamiquement -->
            </div>
            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px;">
                <button class="neural-btn success-btn" onclick="solvePuzzle()" data-lang="validate">âœ“ Valider</button>
                <button class="neural-btn danger-btn" onclick="closePuzzle()" data-lang="close">âœ— Fermer</button>
            </div>
        </div>
    </div>

    <!-- Affichage des messages -->
    <div class="message-display" id="messageDisplay"></div>

    <script>
        // SystÃ¨me de traduction multilingue
        const translations = {
            fr: {
                level: "Niveau",
                xp: "XP",
                energy: "Ã‰nergie",
                crystals: "Cristaux",
                time: "Temps",
                active_missions: "ğŸ¯ Missions Actives",
                neural_awakening: "Ã‰veil Neural",
                neural_awakening_desc: "Collectez 5 cristaux de mÃ©moire pour activer votre premier nÅ“ud neural.",
                ai_connection: "Connexion IA",
                ai_connection_desc: "Ã‰tablissez le contact avec 3 entitÃ©s IA dans la forÃªt mystique.",
                puzzle_master: "MaÃ®tre des Ã‰nigmes",
                puzzle_master_desc: "RÃ©solvez 10 Ã©nigmes neurales pour dÃ©bloquer de nouveaux pouvoirs.",
                neural_inventory: "ğŸ’ Inventaire Neural",
                neural_map: "ğŸ—ºï¸ Carte Neural",
                assistant_aria: "ğŸ¤– Assistant ARIA",
                welcome_message: "Bienvenue, Explorateur Neural ! Je suis ARIA, votre assistant IA. PrÃªt Ã  explorer les mystÃ¨res de la forÃªt quantique ?",
                talk_to_aria: "ğŸ’¬ Parler Ã  ARIA",
                game_guide: "ğŸ“– Guide de Jeu",
                how_to_play: "ğŸ® COMMENT JOUER :",
                guide_crystals: "â€¢ Cliquez sur les ğŸ’ cristaux pour les collecter",
                guide_nodes: "â€¢ Activez les ğŸ§  nÅ“uds neuraux (2 cristaux requis)",
                guide_ai: "â€¢ Parlez aux ğŸ¤– entitÃ©s IA pour progresser",
                guide_puzzles: "â€¢ RÃ©solvez les Ã©nigmes pour gagner de l'XP",
                guide_scan: "â€¢ Utilisez ESPACE pour scanner la zone",
                guide_meditate: "â€¢ Appuyez sur M pour mÃ©diter",
                objectives: "ğŸ† OBJECTIFS :",
                obj_crystals: "â€¢ Collectez 5 cristaux de mÃ©moire",
                obj_ai: "â€¢ Connectez-vous Ã  3 entitÃ©s IA",
                obj_puzzles: "â€¢ RÃ©solvez 10 Ã©nigmes neurales",
                actions: "âš¡ Actions",
                scan_area: "ğŸ” Scanner Zone",
                neural_meditation: "ğŸ§˜ MÃ©ditation Neural",
                save: "ğŸ’¾ Sauvegarder",
                new_journey: "ğŸ”„ Nouveau Voyage",
                neural_puzzle: "Ã‰nigme Neural",
                puzzle_description: "RÃ©solvez cette Ã©nigme pour progresser...",
                validate: "âœ“ Valider",
                close: "âœ— Fermer",
                start_game: "ğŸ® Commencer le Jeu",
                pause_game: "â¸ï¸ Pause",
                resume_game: "â–¶ï¸ Reprendre",
                moves_left: "Mouvements restants",
                puzzle_failed: "âŒ Ã‰chec ! Plus de mouvements disponibles.",
                try_again: "Essayez Ã  nouveau",
                puzzle_success: "ğŸ‰ Parfait ! Ã‰nigme rÃ©solue !",
                next_level: "Niveau suivant"
            },
            en: {
                level: "Level",
                xp: "XP",
                energy: "Energy",
                crystals: "Crystals",
                time: "Time",
                active_missions: "ğŸ¯ Active Missions",
                neural_awakening: "Neural Awakening",
                neural_awakening_desc: "Collect 5 memory crystals to activate your first neural node.",
                ai_connection: "AI Connection",
                ai_connection_desc: "Establish contact with 3 AI entities in the mystical forest.",
                puzzle_master: "Puzzle Master",
                puzzle_master_desc: "Solve 10 neural puzzles to unlock new powers.",
                neural_inventory: "ğŸ’ Neural Inventory",
                neural_map: "ğŸ—ºï¸ Neural Map",
                assistant_aria: "ğŸ¤– Assistant ARIA",
                welcome_message: "Welcome, Neural Explorer! I am ARIA, your AI assistant. Ready to explore the mysteries of the quantum forest?",
                talk_to_aria: "ğŸ’¬ Talk to ARIA",
                game_guide: "ğŸ“– Game Guide",
                how_to_play: "ğŸ® HOW TO PLAY:",
                guide_crystals: "â€¢ Click on ğŸ’ crystals to collect them",
                guide_nodes: "â€¢ Activate ğŸ§  neural nodes (2 crystals required)",
                guide_ai: "â€¢ Talk to ğŸ¤– AI entities to progress",
                guide_puzzles: "â€¢ Solve puzzles to gain XP",
                guide_scan: "â€¢ Use SPACE to scan the area",
                guide_meditate: "â€¢ Press M to meditate",
                objectives: "ğŸ† OBJECTIVES:",
                obj_crystals: "â€¢ Collect 5 memory crystals",
                obj_ai: "â€¢ Connect to 3 AI entities",
                obj_puzzles: "â€¢ Solve 10 neural puzzles",
                actions: "âš¡ Actions",
                scan_area: "ğŸ” Scan Area",
                neural_meditation: "ğŸ§˜ Neural Meditation",
                save: "ğŸ’¾ Save",
                new_journey: "ğŸ”„ New Journey",
                neural_puzzle: "Neural Puzzle",
                puzzle_description: "Solve this puzzle to progress...",
                validate: "âœ“ Validate",
                close: "âœ— Close",
                start_game: "ğŸ® Start Game",
                pause_game: "â¸ï¸ Pause",
                resume_game: "â–¶ï¸ Resume",
                moves_left: "Moves left",
                puzzle_failed: "âŒ Failed! No more moves available.",
                try_again: "Try again",
                puzzle_success: "ğŸ‰ Perfect! Puzzle solved!",
                next_level: "Next level"
            },
            ar: {
                level: "Ø§Ù„Ù…Ø³ØªÙˆÙ‰",
                xp: "Ù†Ù‚Ø§Ø· Ø§Ù„Ø®Ø¨Ø±Ø©",
                energy: "Ø§Ù„Ø·Ø§Ù‚Ø©",
                crystals: "Ø§Ù„Ø¨Ù„ÙˆØ±Ø§Øª",
                time: "Ø§Ù„ÙˆÙ‚Øª",
                active_missions: "ğŸ¯ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù†Ø´Ø·Ø©",
                neural_awakening: "Ø§Ù„ØµØ­ÙˆØ© Ø§Ù„Ø¹ØµØ¨ÙŠØ©",
                neural_awakening_desc: "Ø§Ø¬Ù…Ø¹ 5 Ø¨Ù„ÙˆØ±Ø§Øª Ø°Ø§ÙƒØ±Ø© Ù„ØªÙØ¹ÙŠÙ„ Ø£ÙˆÙ„ Ø¹Ù‚Ø¯Ø© Ø¹ØµØ¨ÙŠØ© Ù„Ùƒ.",
                ai_connection: "Ø§ØªØµØ§Ù„ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ",
                ai_connection_desc: "Ø£Ù‚Ù… Ø§ØªØµØ§Ù„Ø§Ù‹ Ù…Ø¹ 3 ÙƒÙŠØ§Ù†Ø§Øª Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙÙŠ Ø§Ù„ØºØ§Ø¨Ø© Ø§Ù„ØµÙˆÙÙŠØ©.",
                puzzle_master: "Ø³ÙŠØ¯ Ø§Ù„Ø£Ù„ØºØ§Ø²",
                puzzle_master_desc: "Ø­Ù„ 10 Ø£Ù„ØºØ§Ø² Ø¹ØµØ¨ÙŠØ© Ù„ÙØªØ­ Ù‚ÙˆÙ‰ Ø¬Ø¯ÙŠØ¯Ø©.",
                neural_inventory: "ğŸ’ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø¹ØµØ¨ÙŠ",
                neural_map: "ğŸ—ºï¸ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¹ØµØ¨ÙŠØ©",
                assistant_aria: "ğŸ¤– Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø¢Ø±ÙŠØ§",
                welcome_message: "Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø§Ù„Ù…Ø³ØªÙƒØ´Ù Ø§Ù„Ø¹ØµØ¨ÙŠ! Ø£Ù†Ø§ Ø¢Ø±ÙŠØ§ØŒ Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ. Ù‡Ù„ Ø£Ù†Øª Ù…Ø³ØªØ¹Ø¯ Ù„Ø§Ø³ØªÙƒØ´Ø§Ù Ø£Ø³Ø±Ø§Ø± Ø§Ù„ØºØ§Ø¨Ø© Ø§Ù„ÙƒÙ…ÙŠØ©ØŸ",
                talk_to_aria: "ğŸ’¬ ØªØ­Ø¯Ø« Ù…Ø¹ Ø¢Ø±ÙŠØ§",
                game_guide: "ğŸ“– Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©",
                how_to_play: "ğŸ® ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨:",
                guide_crystals: "â€¢ Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù„ÙˆØ±Ø§Øª ğŸ’ Ù„Ø¬Ù…Ø¹Ù‡Ø§",
                guide_nodes: "â€¢ ÙØ¹Ù‘Ù„ Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø¹ØµØ¨ÙŠØ© ğŸ§  (Ù…Ø·Ù„ÙˆØ¨ Ø¨Ù„ÙˆØ±ØªØ§Ù†)",
                guide_ai: "â€¢ ØªØ­Ø¯Ø« Ù…Ø¹ ÙƒÙŠØ§Ù†Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ğŸ¤– Ù„Ù„ØªÙ‚Ø¯Ù…",
                guide_puzzles: "â€¢ Ø­Ù„ Ø§Ù„Ø£Ù„ØºØ§Ø² Ù„ÙƒØ³Ø¨ Ù†Ù‚Ø§Ø· Ø§Ù„Ø®Ø¨Ø±Ø©",
                guide_scan: "â€¢ Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø³Ø§ÙØ© Ù„Ù…Ø³Ø­ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©",
                guide_meditate: "â€¢ Ø§Ø¶ØºØ· M Ù„Ù„ØªØ£Ù…Ù„",
                objectives: "ğŸ† Ø§Ù„Ø£Ù‡Ø¯Ø§Ù:",
                obj_crystals: "â€¢ Ø§Ø¬Ù…Ø¹ 5 Ø¨Ù„ÙˆØ±Ø§Øª Ø°Ø§ÙƒØ±Ø©",
                obj_ai: "â€¢ Ø§ØªØµÙ„ Ø¨Ù€ 3 ÙƒÙŠØ§Ù†Ø§Øª Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ",
                obj_puzzles: "â€¢ Ø­Ù„ 10 Ø£Ù„ØºØ§Ø² Ø¹ØµØ¨ÙŠØ©",
                actions: "âš¡ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª",
                scan_area: "ğŸ” Ù…Ø³Ø­ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©",
                neural_meditation: "ğŸ§˜ Ø§Ù„ØªØ£Ù…Ù„ Ø§Ù„Ø¹ØµØ¨ÙŠ",
                save: "ğŸ’¾ Ø­ÙØ¸",
                new_journey: "ğŸ”„ Ø±Ø­Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©",
                neural_puzzle: "Ø§Ù„Ù„ØºØ² Ø§Ù„Ø¹ØµØ¨ÙŠ",
                puzzle_description: "Ø­Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù„ØºØ² Ù„Ù„ØªÙ‚Ø¯Ù…...",
                validate: "âœ“ ØªØ£ÙƒÙŠØ¯",
                close: "âœ— Ø¥ØºÙ„Ø§Ù‚",
                start_game: "ğŸ® Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©",
                pause_game: "â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª",
                resume_game: "â–¶ï¸ Ø§Ø³ØªØ¦Ù†Ø§Ù",
                moves_left: "Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©",
                puzzle_failed: "âŒ ÙØ´Ù„! Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø±ÙƒØ§Øª Ù…ØªØ§Ø­Ø©.",
                try_again: "Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
                puzzle_success: "ğŸ‰ Ù…Ø«Ø§Ù„ÙŠ! ØªÙ… Ø­Ù„ Ø§Ù„Ù„ØºØ²!",
                next_level: "Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ"
            },
            es: {
                level: "Nivel",
                xp: "XP",
                energy: "EnergÃ­a",
                crystals: "Cristales",
                time: "Tiempo",
                active_missions: "ğŸ¯ Misiones Activas",
                neural_awakening: "Despertar Neural",
                neural_awakening_desc: "Recolecta 5 cristales de memoria para activar tu primer nodo neural.",
                ai_connection: "ConexiÃ³n IA",
                ai_connection_desc: "Establece contacto con 3 entidades IA en el bosque mÃ­stico.",
                puzzle_master: "Maestro de Enigmas",
                puzzle_master_desc: "Resuelve 10 enigmas neurales para desbloquear nuevos poderes.",
                neural_inventory: "ğŸ’ Inventario Neural",
                neural_map: "ğŸ—ºï¸ Mapa Neural",
                assistant_aria: "ğŸ¤– Asistente ARIA",
                welcome_message: "Â¡Bienvenido, Explorador Neural! Soy ARIA, tu asistente IA. Â¿Listo para explorar los misterios del bosque cuÃ¡ntico?",
                talk_to_aria: "ğŸ’¬ Hablar con ARIA",
                game_guide: "ğŸ“– GuÃ­a del Juego",
                how_to_play: "ğŸ® CÃ“MO JUGAR:",
                guide_crystals: "â€¢ Haz clic en los cristales ğŸ’ para recolectarlos",
                guide_nodes: "â€¢ Activa los nodos neurales ğŸ§  (2 cristales requeridos)",
                guide_ai: "â€¢ Habla con las entidades IA ğŸ¤– para progresar",
                guide_puzzles: "â€¢ Resuelve enigmas para ganar XP",
                guide_scan: "â€¢ Usa ESPACIO para escanear el Ã¡rea",
                guide_meditate: "â€¢ Presiona M para meditar",
                objectives: "ğŸ† OBJETIVOS:",
                obj_crystals: "â€¢ Recolecta 5 cristales de memoria",
                obj_ai: "â€¢ ConÃ©ctate con 3 entidades IA",
                obj_puzzles: "â€¢ Resuelve 10 enigmas neurales",
                actions: "âš¡ Acciones",
                scan_area: "ğŸ” Escanear Ãrea",
                neural_meditation: "ğŸ§˜ MeditaciÃ³n Neural",
                save: "ğŸ’¾ Guardar",
                new_journey: "ğŸ”„ Nuevo Viaje",
                neural_puzzle: "Enigma Neural",
                puzzle_description: "Resuelve este enigma para progresar...",
                validate: "âœ“ Validar",
                close: "âœ— Cerrar",
                start_game: "ğŸ® Iniciar Juego",
                pause_game: "â¸ï¸ Pausa",
                resume_game: "â–¶ï¸ Reanudar",
                moves_left: "Movimientos restantes",
                puzzle_failed: "âŒ Â¡Fallido! No hay mÃ¡s movimientos disponibles.",
                try_again: "IntÃ©ntalo de nuevo",
                puzzle_success: "ğŸ‰ Â¡Perfecto! Â¡Enigma resuelto!",
                next_level: "Siguiente nivel"
            },
            de: {
                level: "Level",
                xp: "EP",
                energy: "Energie",
                crystals: "Kristalle",
                time: "Zeit",
                active_missions: "ğŸ¯ Aktive Missionen",
                neural_awakening: "Neurales Erwachen",
                neural_awakening_desc: "Sammle 5 GedÃ¤chtniskristalle, um deinen ersten neuralen Knoten zu aktivieren.",
                ai_connection: "KI-Verbindung",
                ai_connection_desc: "Stelle Kontakt zu 3 KI-EntitÃ¤ten im mystischen Wald her.",
                puzzle_master: "RÃ¤tselmeister",
                puzzle_master_desc: "LÃ¶se 10 neurale RÃ¤tsel, um neue KrÃ¤fte freizuschalten.",
                neural_inventory: "ğŸ’ Neurales Inventar",
                neural_map: "ğŸ—ºï¸ Neurale Karte",
                assistant_aria: "ğŸ¤– Assistent ARIA",
                welcome_message: "Willkommen, Neuraler Entdecker! Ich bin ARIA, dein KI-Assistent. Bereit, die Geheimnisse des Quantenwaldes zu erkunden?",
                talk_to_aria: "ğŸ’¬ Mit ARIA sprechen",
                game_guide: "ğŸ“– Spielanleitung",
                how_to_play: "ğŸ® WIE MAN SPIELT:",
                guide_crystals: "â€¢ Klicke auf die Kristalle ğŸ’, um sie zu sammeln",
                guide_nodes: "â€¢ Aktiviere neurale Knoten ğŸ§  (2 Kristalle erforderlich)",
                guide_ai: "â€¢ Sprich mit KI-EntitÃ¤ten ğŸ¤–, um voranzukommen",
                guide_puzzles: "â€¢ LÃ¶se RÃ¤tsel, um EP zu gewinnen",
                guide_scan: "â€¢ Verwende LEERTASTE, um das Gebiet zu scannen",
                guide_meditate: "â€¢ DrÃ¼cke M zum Meditieren",
                objectives: "ğŸ† ZIELE:",
                obj_crystals: "â€¢ Sammle 5 GedÃ¤chtniskristalle",
                obj_ai: "â€¢ Verbinde dich mit 3 KI-EntitÃ¤ten",
                obj_puzzles: "â€¢ LÃ¶se 10 neurale RÃ¤tsel",
                actions: "âš¡ Aktionen",
                scan_area: "ğŸ” Gebiet scannen",
                neural_meditation: "ğŸ§˜ Neurale Meditation",
                save: "ğŸ’¾ Speichern",
                new_journey: "ğŸ”„ Neue Reise",
                neural_puzzle: "Neurales RÃ¤tsel",
                puzzle_description: "LÃ¶se dieses RÃ¤tsel, um voranzukommen...",
                validate: "âœ“ BestÃ¤tigen",
                close: "âœ— SchlieÃŸen",
                start_game: "ğŸ® Spiel Starten",
                pause_game: "â¸ï¸ Pause",
                resume_game: "â–¶ï¸ Fortsetzen",
                moves_left: "ZÃ¼ge Ã¼brig",
                puzzle_failed: "âŒ Gescheitert! Keine ZÃ¼ge mehr verfÃ¼gbar.",
                try_again: "Versuche es erneut",
                puzzle_success: "ğŸ‰ Perfekt! RÃ¤tsel gelÃ¶st!",
                next_level: "NÃ¤chstes Level"
            },
            zh: {
                level: "ç­‰çº§",
                xp: "ç»éªŒå€¼",
                energy: "èƒ½é‡",
                crystals: "æ°´æ™¶",
                time: "æ—¶é—´",
                active_missions: "ğŸ¯ æ´»è·ƒä»»åŠ¡",
                neural_awakening: "ç¥ç»è§‰é†’",
                neural_awakening_desc: "æ”¶é›†5ä¸ªè®°å¿†æ°´æ™¶æ¥æ¿€æ´»ä½ çš„ç¬¬ä¸€ä¸ªç¥ç»èŠ‚ç‚¹ã€‚",
                ai_connection: "AIè¿æ¥",
                ai_connection_desc: "åœ¨ç¥ç§˜æ£®æ—ä¸­ä¸3ä¸ªAIå®ä½“å»ºç«‹è”ç³»ã€‚",
                puzzle_master: "è°œé¢˜å¤§å¸ˆ",
                puzzle_master_desc: "è§£å†³10ä¸ªç¥ç»è°œé¢˜æ¥è§£é”æ–°èƒ½åŠ›ã€‚",
                neural_inventory: "ğŸ’ ç¥ç»èƒŒåŒ…",
                neural_map: "ğŸ—ºï¸ ç¥ç»åœ°å›¾",
                assistant_aria: "ğŸ¤– åŠ©æ‰‹ARIA",
                welcome_message: "æ¬¢è¿ï¼Œç¥ç»æ¢ç´¢è€…ï¼æˆ‘æ˜¯ARIAï¼Œä½ çš„AIåŠ©æ‰‹ã€‚å‡†å¤‡å¥½æ¢ç´¢é‡å­æ£®æ—çš„å¥¥ç§˜äº†å—ï¼Ÿ",
                talk_to_aria: "ğŸ’¬ ä¸ARIAå¯¹è¯",
                game_guide: "ğŸ“– æ¸¸æˆæŒ‡å—",
                how_to_play: "ğŸ® å¦‚ä½•æ¸¸æˆï¼š",
                guide_crystals: "â€¢ ç‚¹å‡»ğŸ’æ°´æ™¶æ¥æ”¶é›†å®ƒä»¬",
                guide_nodes: "â€¢ æ¿€æ´»ğŸ§ ç¥ç»èŠ‚ç‚¹ï¼ˆéœ€è¦2ä¸ªæ°´æ™¶ï¼‰",
                guide_ai: "â€¢ ä¸ğŸ¤–AIå®ä½“å¯¹è¯æ¥è¿›æ­¥",
                guide_puzzles: "â€¢ è§£å†³è°œé¢˜æ¥è·å¾—ç»éªŒå€¼",
                guide_scan: "â€¢ ä½¿ç”¨ç©ºæ ¼é”®æ‰«æåŒºåŸŸ",
                guide_meditate: "â€¢ æŒ‰Mé”®å†¥æƒ³",
                objectives: "ğŸ† ç›®æ ‡ï¼š",
                obj_crystals: "â€¢ æ”¶é›†5ä¸ªè®°å¿†æ°´æ™¶",
                obj_ai: "â€¢ è¿æ¥3ä¸ªAIå®ä½“",
                obj_puzzles: "â€¢ è§£å†³10ä¸ªç¥ç»è°œé¢˜",
                actions: "âš¡ è¡ŒåŠ¨",
                scan_area: "ğŸ” æ‰«æåŒºåŸŸ",
                neural_meditation: "ğŸ§˜ ç¥ç»å†¥æƒ³",
                save: "ğŸ’¾ ä¿å­˜",
                new_journey: "ğŸ”„ æ–°æ—…ç¨‹",
                neural_puzzle: "ç¥ç»è°œé¢˜",
                puzzle_description: "è§£å†³è¿™ä¸ªè°œé¢˜æ¥è¿›æ­¥...",
                validate: "âœ“ éªŒè¯",
                close: "âœ— å…³é—­",
                start_game: "ğŸ® å¼€å§‹æ¸¸æˆ",
                pause_game: "â¸ï¸ æš‚åœ",
                resume_game: "â–¶ï¸ ç»§ç»­",
                moves_left: "å‰©ä½™ç§»åŠ¨",
                puzzle_failed: "âŒ å¤±è´¥ï¼æ²¡æœ‰æ›´å¤šç§»åŠ¨å¯ç”¨ã€‚",
                try_again: "å†è¯•ä¸€æ¬¡",
                puzzle_success: "ğŸ‰ å®Œç¾ï¼è°œé¢˜è§£å†³ï¼",
                next_level: "ä¸‹ä¸€å…³"
            }
        };

        let currentLanguage = 'fr';

        // Fonction pour changer la langue
        function changeLanguage(lang) {
            currentLanguage = lang;
            
            // Appliquer la direction RTL pour l'arabe
            if (lang === 'ar') {
                document.body.classList.add('rtl');
                document.documentElement.setAttribute('dir', 'rtl');
            } else {
                document.body.classList.remove('rtl');
                document.documentElement.setAttribute('dir', 'ltr');
            }
            
            // Mettre Ã  jour tous les Ã©lÃ©ments avec data-lang
            const elements = document.querySelectorAll('[data-lang]');
            elements.forEach(element => {
                const key = element.getAttribute('data-lang');
                if (translations[lang] && translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });
            
            // Mettre Ã  jour les boutons de contrÃ´le du jeu
            updateGameControlButtons();
            
            // Sauvegarder la langue choisie
            localStorage.setItem('neurosynthLanguage', lang);
            
            // Mettre Ã  jour les messages dynamiques
            updateDynamicMessages();
        }

        // Fonction pour obtenir une traduction
        function t(key) {
            return translations[currentLanguage] && translations[currentLanguage][key] 
                ? translations[currentLanguage][key] 
                : translations['fr'][key] || key;
        }

        // Messages dynamiques traduits
        const dynamicMessages = {
            fr: {
                welcome: "ğŸŒŸ Bienvenue dans NeuroSynth Explorer ! Explorez la forÃªt quantique et Ã©veillez votre conscience neural.",
                tree_messages: [
                    "ğŸŒ³ Cet arbre ancien pulse d'Ã©nergie quantique...",
                    "ğŸƒ Les feuilles murmurent des secrets neuraux...",
                    "ğŸŒ¿ Vous ressentez une connexion profonde avec la nature digitale...",
                    "ğŸŒ² L'arbre semble rÃ©agir Ã  votre prÃ©sence neural..."
                ],
                crystal_collected: "ğŸ’ Cristal de mÃ©moire collectÃ© ! Ã‰nergie neural +10 XP",
                node_locked: "ğŸ”’ Vous avez besoin de 2 cristaux de mÃ©moire pour activer ce nÅ“ud neural.",
                ai_messages: [
                    "ğŸ¤– Salutations, Ãªtre neural. Je dÃ©tecte un potentiel quantique Ã©levÃ© en vous.",
                    "ğŸ”® Vos ondes cÃ©rÃ©brales rÃ©sonnent avec la frÃ©quence de la forÃªt mystique.",
                    "âš¡ Connexion Ã©tablie. Transfert de donnÃ©es neurales en cours...",
                    "ğŸŒŸ Votre Ã©volution neural progresse admirablement, explorateur.",
                    "ğŸ§¬ Les patterns de votre conscience s'alignent avec la matrice universelle."
                ]
            },
            en: {
                welcome: "ğŸŒŸ Welcome to NeuroSynth Explorer! Explore the quantum forest and awaken your neural consciousness.",
                tree_messages: [
                    "ğŸŒ³ This ancient tree pulses with quantum energy...",
                    "ğŸƒ The leaves whisper neural secrets...",
                    "ğŸŒ¿ You feel a deep connection with digital nature...",
                    "ğŸŒ² The tree seems to react to your neural presence..."
                ],
                crystal_collected: "ğŸ’ Memory crystal collected! Neural energy +10 XP",
                node_locked: "ğŸ”’ You need 2 memory crystals to activate this neural node.",
                ai_messages: [
                    "ğŸ¤– Greetings, neural being. I detect high quantum potential in you.",
                    "ğŸ”® Your brain waves resonate with the mystical forest frequency.",
                    "âš¡ Connection established. Neural data transfer in progress...",
                    "ğŸŒŸ Your neural evolution progresses admirably, explorer.",
                    "ğŸ§¬ Your consciousness patterns align with the universal matrix."
                ]
            },
            ar: {
                welcome: "ğŸŒŸ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ø³ØªÙƒØ´Ù NeuroSynth! Ø§Ø³ØªÙƒØ´Ù Ø§Ù„ØºØ§Ø¨Ø© Ø§Ù„ÙƒÙ…ÙŠØ© ÙˆØ£ÙŠÙ‚Ø¸ ÙˆØ¹ÙŠÙƒ Ø§Ù„Ø¹ØµØ¨ÙŠ.",
                tree_messages: [
                    "ğŸŒ³ Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ØªÙ†Ø¨Ø¶ Ø¨Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„ÙƒÙ…ÙŠØ©...",
                    "ğŸƒ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ ØªÙ‡Ù…Ø³ Ø¨Ø£Ø³Ø±Ø§Ø± Ø¹ØµØ¨ÙŠØ©...",
                    "ğŸŒ¿ ØªØ´Ø¹Ø± Ø¨Ø§Ø±ØªØ¨Ø§Ø· Ø¹Ù…ÙŠÙ‚ Ù…Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¹Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©...",
                    "ğŸŒ² Ø§Ù„Ø´Ø¬Ø±Ø© ØªØ¨Ø¯Ùˆ ÙˆÙƒØ£Ù†Ù‡Ø§ ØªØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø­Ø¶ÙˆØ±Ùƒ Ø§Ù„Ø¹ØµØ¨ÙŠ..."
                ],
                crystal_collected: "ğŸ’ ØªÙ… Ø¬Ù…Ø¹ Ø¨Ù„ÙˆØ±Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø©! Ø·Ø§Ù‚Ø© Ø¹ØµØ¨ÙŠØ© +10 Ù†Ù‚Ø·Ø© Ø®Ø¨Ø±Ø©",
                node_locked: "ğŸ”’ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¨Ù„ÙˆØ±ØªÙŠ Ø°Ø§ÙƒØ±Ø© Ù„ØªÙØ¹ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø¹ØµØ¨ÙŠØ©.",
                ai_messages: [
                    "ğŸ¤– ØªØ­ÙŠØ§ØªÙŠØŒ Ø§Ù„ÙƒØ§Ø¦Ù† Ø§Ù„Ø¹ØµØ¨ÙŠ. Ø£ÙƒØªØ´Ù Ø¥Ù…ÙƒØ§Ù†Ø§Øª ÙƒÙ…ÙŠØ© Ø¹Ø§Ù„ÙŠØ© ÙÙŠÙƒ.",
                    "ğŸ”® Ù…ÙˆØ¬Ø§Øª Ø¯Ù…Ø§ØºÙƒ ØªØªØ±Ø¯Ø¯ Ù…Ø¹ ØªØ±Ø¯Ø¯ Ø§Ù„ØºØ§Ø¨Ø© Ø§Ù„ØµÙˆÙÙŠØ©.",
                    "âš¡ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„. Ù†Ù‚Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹ØµØ¨ÙŠØ© Ù‚ÙŠØ¯ Ø§Ù„ØªÙ‚Ø¯Ù…...",
                    "ğŸŒŸ ØªØ·ÙˆØ±Ùƒ Ø§Ù„Ø¹ØµØ¨ÙŠ ÙŠØªÙ‚Ø¯Ù… Ø¨Ø´ÙƒÙ„ Ø±Ø§Ø¦Ø¹ØŒ Ø£ÙŠÙ‡Ø§ Ø§Ù„Ù…Ø³ØªÙƒØ´Ù.",
                    "ğŸ§¬ Ø£Ù†Ù…Ø§Ø· ÙˆØ¹ÙŠÙƒ ØªØªÙ…Ø§Ø´Ù‰ Ù…Ø¹ Ø§Ù„Ù…ØµÙÙˆÙØ© Ø§Ù„ÙƒÙˆÙ†ÙŠØ©."
                ]
            },
            es: {
                welcome: "ğŸŒŸ Â¡Bienvenido a NeuroSynth Explorer! Explora el bosque cuÃ¡ntico y despierta tu conciencia neural.",
                tree_messages: [
                    "ğŸŒ³ Este Ã¡rbol ancestral pulsa con energÃ­a cuÃ¡ntica...",
                    "ğŸƒ Las hojas susurran secretos neurales...",
                    "ğŸŒ¿ Sientes una conexiÃ³n profunda con la naturaleza digital...",
                    "ğŸŒ² El Ã¡rbol parece reaccionar a tu presencia neural..."
                ],
                crystal_collected: "ğŸ’ Â¡Cristal de memoria recolectado! EnergÃ­a neural +10 XP",
                node_locked: "ğŸ”’ Necesitas 2 cristales de memoria para activar este nodo neural.",
                ai_messages: [
                    "ğŸ¤– Saludos, ser neural. Detecto alto potencial cuÃ¡ntico en ti.",
                    "ğŸ”® Tus ondas cerebrales resuenan con la frecuencia del bosque mÃ­stico.",
                    "âš¡ ConexiÃ³n establecida. Transferencia de datos neurales en progreso...",
                    "ğŸŒŸ Tu evoluciÃ³n neural progresa admirablemente, explorador.",
                    "ğŸ§¬ Los patrones de tu conciencia se alinean con la matriz universal."
                ]
            },
            de: {
                welcome: "ğŸŒŸ Willkommen bei NeuroSynth Explorer! Erkunde den Quantenwald und erwecke dein neurales Bewusstsein.",
                tree_messages: [
                    "ğŸŒ³ Dieser uralte Baum pulsiert mit Quantenenergie...",
                    "ğŸƒ Die BlÃ¤tter flÃ¼stern neurale Geheimnisse...",
                    "ğŸŒ¿ Du spÃ¼rst eine tiefe Verbindung zur digitalen Natur...",
                    "ğŸŒ² Der Baum scheint auf deine neurale PrÃ¤senz zu reagieren..."
                ],
                crystal_collected: "ğŸ’ GedÃ¤chtniskristall gesammelt! Neurale Energie +10 EP",
                node_locked: "ğŸ”’ Du benÃ¶tigst 2 GedÃ¤chtniskristalle, um diesen neuralen Knoten zu aktivieren.",
                ai_messages: [
                    "ğŸ¤– GrÃ¼ÃŸe, neurales Wesen. Ich erkenne hohes Quantenpotential in dir.",
                    "ğŸ”® Deine Gehirnwellen resonieren mit der Frequenz des mystischen Waldes.",
                    "âš¡ Verbindung hergestellt. Neuraler Datentransfer lÃ¤uft...",
                    "ğŸŒŸ Deine neurale Evolution schreitet bewundernswert voran, Entdecker.",
                    "ğŸ§¬ Die Muster deines Bewusstseins richten sich an der universellen Matrix aus."
                ]
            },
            zh: {
                welcome: "ğŸŒŸ æ¬¢è¿æ¥åˆ°NeuroSynth Explorerï¼æ¢ç´¢é‡å­æ£®æ—ï¼Œå”¤é†’ä½ çš„ç¥ç»æ„è¯†ã€‚",
                tree_messages: [
                    "ğŸŒ³ è¿™æ£µå¤è€çš„æ ‘è„‰åŠ¨ç€é‡å­èƒ½é‡...",
                    "ğŸƒ å¶å­ä½è¯­ç€ç¥ç»ç§˜å¯†...",
                    "ğŸŒ¿ ä½ æ„Ÿå—åˆ°ä¸æ•°å­—è‡ªç„¶çš„æ·±å±‚è¿æ¥...",
                    "ğŸŒ² è¿™æ£µæ ‘ä¼¼ä¹å¯¹ä½ çš„ç¥ç»å­˜åœ¨æœ‰ååº”..."
                ],
                crystal_collected: "ğŸ’ è®°å¿†æ°´æ™¶å·²æ”¶é›†ï¼ç¥ç»èƒ½é‡ +10 ç»éªŒå€¼",
                node_locked: "ğŸ”’ ä½ éœ€è¦2ä¸ªè®°å¿†æ°´æ™¶æ¥æ¿€æ´»è¿™ä¸ªç¥ç»èŠ‚ç‚¹ã€‚",
                ai_messages: [
                    "ğŸ¤– é—®å€™ï¼Œç¥ç»å­˜åœ¨ã€‚æˆ‘åœ¨ä½ èº«ä¸Šæ£€æµ‹åˆ°é«˜é‡å­æ½œåŠ›ã€‚",
                    "ğŸ”® ä½ çš„è„‘æ³¢ä¸ç¥ç§˜æ£®æ—çš„é¢‘ç‡å…±é¸£ã€‚",
                    "âš¡ è¿æ¥å·²å»ºç«‹ã€‚ç¥ç»æ•°æ®ä¼ è¾“è¿›è¡Œä¸­...",
                    "ğŸŒŸ ä½ çš„ç¥ç»è¿›åŒ–è¿›å±•ä»¤äººé’¦ä½©ï¼Œæ¢ç´¢è€…ã€‚",
                    "ğŸ§¬ ä½ çš„æ„è¯†æ¨¡å¼ä¸å®‡å®™çŸ©é˜µå¯¹é½ã€‚"
                ]
            }
        };

        function updateDynamicMessages() {
            // Cette fonction sera appelÃ©e quand on change de langue
            // pour mettre Ã  jour les messages qui ne sont pas dans le DOM
        }

        function updateGameControlButtons() {
            const startBtn = document.getElementById('startGameBtn');
            const pauseBtn = document.getElementById('pauseResumeBtn');
            
            if (startBtn) {
                startBtn.textContent = t('start_game');
            }
            
            if (pauseBtn) {
                if (gameState.gamePaused) {
                    pauseBtn.textContent = t('resume_game');
                    pauseBtn.setAttribute('data-lang', 'resume_game');
                } else {
                    pauseBtn.textContent = t('pause_game');
                    pauseBtn.setAttribute('data-lang', 'pause_game');
                }
            }
        }

        function startGame() {
            if (!gameState.gameStarted) {
                gameState.gameStarted = true;
                gameState.startTime = Date.now();
                
                document.getElementById('startGameBtn').style.display = 'none';
                document.getElementById('pauseResumeBtn').style.display = 'block';
                
                const msg = currentLanguage === 'fr' ? "ğŸ® Jeu commencÃ© ! Bonne exploration !" :
                           currentLanguage === 'en' ? "ğŸ® Game started! Happy exploring!" :
                           currentLanguage === 'ar' ? "ğŸ® Ø¨Ø¯Ø£Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! Ø§Ø³ØªÙƒØ´Ø§Ù Ø³Ø¹ÙŠØ¯!" :
                           currentLanguage === 'es' ? "ğŸ® Â¡Juego iniciado! Â¡Feliz exploraciÃ³n!" :
                           currentLanguage === 'de' ? "ğŸ® Spiel gestartet! Viel SpaÃŸ beim Erkunden!" :
                           "ğŸ® æ¸¸æˆå¼€å§‹ï¼æ„‰å¿«æ¢ç´¢ï¼";
                
                showMessage(msg);
                updateGameControlButtons();
            }
        }

        function togglePause() {
            if (!gameState.gameStarted) return;
            
            gameState.gamePaused = !gameState.gamePaused;
            
            if (gameState.gamePaused) {
                const msg = currentLanguage === 'fr' ? "â¸ï¸ Jeu en pause" :
                           currentLanguage === 'en' ? "â¸ï¸ Game paused" :
                           currentLanguage === 'ar' ? "â¸ï¸ Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…ØªÙˆÙ‚ÙØ© Ù…Ø¤Ù‚ØªØ§Ù‹" :
                           currentLanguage === 'es' ? "â¸ï¸ Juego pausado" :
                           currentLanguage === 'de' ? "â¸ï¸ Spiel pausiert" :
                           "â¸ï¸ æ¸¸æˆæš‚åœ";
                showMessage(msg);
            } else {
                const msg = currentLanguage === 'fr' ? "â–¶ï¸ Jeu repris" :
                           currentLanguage === 'en' ? "â–¶ï¸ Game resumed" :
                           currentLanguage === 'ar' ? "â–¶ï¸ ØªÙ… Ø§Ø³ØªØ¦Ù†Ø§Ù Ø§Ù„Ù„Ø¹Ø¨Ø©" :
                           currentLanguage === 'es' ? "â–¶ï¸ Juego reanudado" :
                           currentLanguage === 'de' ? "â–¶ï¸ Spiel fortgesetzt" :
                           "â–¶ï¸ æ¸¸æˆç»§ç»­";
                showMessage(msg);
            }
            
            updateGameControlButtons();
        }

        function getDynamicMessage(category, index = null) {
            const messages = dynamicMessages[currentLanguage] || dynamicMessages['fr'];
            if (index !== null && Array.isArray(messages[category])) {
                return messages[category][index] || messages[category][0];
            }
            return messages[category] || category;
        }

        // Ã‰tat du jeu
        let gameState = {
            player: {
                level: 1,
                xp: 0,
                energy: 100,
                maxEnergy: 100,
                position: { x: 50, y: 50 },
                crystals: 0,
                inventory: [],
                unlockedNodes: []
            },
            world: {
                trees: [],
                neuralNodes: [],
                memoryCrystals: [],
                aiEntities: [],
                connections: []
            },
            quests: [
                { id: 0, title: "neural_awakening", progress: 0, target: 5, completed: false },
                { id: 1, title: "ai_connection", progress: 0, target: 3, completed: false },
                { id: 2, title: "puzzle_master", progress: 0, target: 10, completed: false }
            ],
            currentPuzzle: null,
            gameTime: 0,
            startTime: Date.now(),
            aiMessages: [],
            discoveredAreas: [],
            gameStarted: false,
            gamePaused: false,
            puzzleMovesLeft: 5
        };

        // Initialisation du jeu
        function initGame() {
            console.log("ğŸ§  Initialisation de NeuroSynth Explorer...");
            
            // Charger la langue sauvegardÃ©e
            const savedLanguage = localStorage.getItem('neurosynthLanguage');
            if (savedLanguage) {
                currentLanguage = savedLanguage;
                document.getElementById('languageSelect').value = savedLanguage;
                changeLanguage(savedLanguage);
            }
            
            generateParticles();
            generateWorld();
            createInventorySlots();
            updateMinimap();
            startGameTimer();
            
            showMessage(getDynamicMessage('welcome'));
            
            // PremiÃ¨re interaction avec l'IA
            setTimeout(() => {
                addAIMessage(getDynamicMessage('ai_messages', 0));
            }, 3000);
        }

        // GÃ©nÃ©ration des particules neurales
        function generateParticles() {
            const container = document.getElementById('neuralParticles');
            container.innerHTML = '';
            
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 8 + 's';
                particle.style.animationDuration = (8 + Math.random() * 4) + 's';
                container.appendChild(particle);
            }
        }

        // GÃ©nÃ©ration du monde 3D
        function generateWorld() {
            const world = document.getElementById('gameWorld');
            
            // Nettoyer le monde existant (garder les couches de base)
            const existingElements = world.querySelectorAll('.tree, .neural-node, .memory-crystal, .ai-entity');
            existingElements.forEach(el => el.remove());
            
            // GÃ©nÃ©rer les arbres
            for (let i = 0; i < 15; i++) {
                createTree();
            }
            
            // GÃ©nÃ©rer les nÅ“uds neuraux
            for (let i = 0; i < 8; i++) {
                createNeuralNode();
            }
            
            // GÃ©nÃ©rer les cristaux de mÃ©moire
            for (let i = 0; i < 12; i++) {
                createMemoryCrystal();
            }
            
            // GÃ©nÃ©rer les entitÃ©s IA
            for (let i = 0; i < 5; i++) {
                createAIEntity();
            }
            
            // CrÃ©er les connexions neurales
            setTimeout(() => {
                createNeuralConnections();
            }, 1000);
        }

        function createTree() {
            const tree = document.createElement('div');
            tree.className = 'tree';
            tree.style.left = Math.random() * 80 + 10 + '%';
            tree.style.top = Math.random() * 70 + 15 + '%';
            tree.style.transform = `rotateY(${Math.random() * 360}deg) rotateX(${Math.random() * 20 - 10}deg)`;
            tree.onclick = () => interactWithTree(tree);
            
            document.getElementById('gameWorld').appendChild(tree);
            gameState.world.trees.push(tree);
        }

        function createNeuralNode() {
            const node = document.createElement('div');
            node.className = 'neural-node';
            node.style.left = Math.random() * 85 + 5 + '%';
            node.style.top = Math.random() * 75 + 10 + '%';
            node.innerHTML = 'ğŸ§ ';
            node.onclick = () => interactWithNeuralNode(node);
            
            document.getElementById('gameWorld').appendChild(node);
            gameState.world.neuralNodes.push(node);
        }

        function createMemoryCrystal() {
            const crystal = document.createElement('div');
            crystal.className = 'memory-crystal';
            crystal.style.left = Math.random() * 90 + 5 + '%';
            crystal.style.top = Math.random() * 80 + 10 + '%';
            crystal.onclick = () => collectCrystal(crystal);
            
            document.getElementById('gameWorld').appendChild(crystal);
            gameState.world.memoryCrystals.push(crystal);
        }

        function createAIEntity() {
            const entity = document.createElement('div');
            entity.className = 'ai-entity';
            entity.style.left = Math.random() * 75 + 10 + '%';
            entity.style.top = Math.random() * 65 + 15 + '%';
            entity.innerHTML = 'ğŸ¤–';
            entity.onclick = () => interactWithAI(entity);
            
            document.getElementById('gameWorld').appendChild(entity);
            gameState.world.aiEntities.push(entity);
        }

        function createNeuralConnections() {
            const network = document.getElementById('neuralNetwork');
            network.innerHTML = '';
            
            const nodes = gameState.world.neuralNodes;
            
            for (let i = 0; i < nodes.length - 1; i++) {
                for (let j = i + 1; j < nodes.length; j++) {
                    if (Math.random() < 0.3) { // 30% de chance de connexion
                        createConnection(nodes[i], nodes[j]);
                    }
                }
            }
        }

        function createConnection(node1, node2) {
            const connection = document.createElement('div');
            connection.className = 'neural-connection';
            
            const rect1 = node1.getBoundingClientRect();
            const rect2 = node2.getBoundingClientRect();
            const worldRect = document.getElementById('gameWorld').getBoundingClientRect();
            
            const x1 = rect1.left - worldRect.left + rect1.width / 2;
            const y1 = rect1.top - worldRect.top + rect1.height / 2;
            const x2 = rect2.left - worldRect.left + rect2.width / 2;
            const y2 = rect2.top - worldRect.top + rect2.height / 2;
            
            const length = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
            const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
            
            connection.style.left = x1 + 'px';
            connection.style.top = y1 + 'px';
            connection.style.width = length + 'px';
            connection.style.transform = `rotate(${angle}deg)`;
            connection.style.animationDelay = Math.random() * 3 + 's';
            
            document.getElementById('neuralNetwork').appendChild(connection);
            gameState.world.connections.push(connection);
        }

        // Interactions avec les Ã©lÃ©ments du monde
        function interactWithTree(tree) {
            const messages = dynamicMessages[currentLanguage].tree_messages;
            const message = messages[Math.floor(Math.random() * messages.length)];
            showMessage(message);
            
            // Chance de trouver quelque chose
            if (Math.random() < 0.3) {
                gainXP(5);
                showMessage("âœ¨ " + (currentLanguage === 'fr' ? "Vous gagnez de l'expÃ©rience en communiant avec l'arbre !" :
                                   currentLanguage === 'en' ? "You gain experience by communing with the tree!" :
                                   currentLanguage === 'ar' ? "ØªÙƒØ³Ø¨ Ø®Ø¨Ø±Ø© Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø´Ø¬Ø±Ø©!" :
                                   currentLanguage === 'es' ? "Â¡Ganas experiencia al comunicarte con el Ã¡rbol!" :
                                   currentLanguage === 'de' ? "Du gewinnst Erfahrung durch die Kommunikation mit dem Baum!" :
                                   "ä½ é€šè¿‡ä¸æ ‘æœ¨äº¤æµè·å¾—ç»éªŒï¼"));
            }
        }

        function interactWithNeuralNode(node) {
            if (gameState.player.crystals >= 2) {
                // Ouvrir une Ã©nigme
                openPuzzle("neural");
                node.style.background = 'radial-gradient(circle, rgba(0, 255, 0, 0.8) 0%, rgba(0, 200, 0, 0.4) 100%)';
            } else {
                showMessage(getDynamicMessage('node_locked'));
            }
        }

        function collectCrystal(crystal) {
            gameState.player.crystals++;
            gameState.quests[0].progress++;
            
            // Animation de collecte
            crystal.style.animation = 'crystalSpin 0.5s ease-in-out';
            crystal.style.transform = 'scale(2)';
            crystal.style.opacity = '0';
            
            setTimeout(() => {
                crystal.remove();
                const index = gameState.world.memoryCrystals.indexOf(crystal);
                if (index > -1) {
                    gameState.world.memoryCrystals.splice(index, 1);
                }
            }, 500);
            
            gainXP(10);
            showMessage(getDynamicMessage('crystal_collected'));
            
            updateStats();
            updateQuestProgress();
            
            // VÃ©rifier si la quÃªte est terminÃ©e
            if (gameState.quests[0].progress >= gameState.quests[0].target && !gameState.quests[0].completed) {
                completeQuest(0);
            }
        }

        function interactWithAI(entity) {
            gameState.quests[1].progress++;
            
            const messages = dynamicMessages[currentLanguage].ai_messages;
            const message = messages[Math.floor(Math.random() * messages.length)];
            addAIMessage(message);
            
            const connectionMsg = currentLanguage === 'fr' ? "ğŸ¤– Connexion IA Ã©tablie ! Nouveau message reÃ§u." :
                                 currentLanguage === 'en' ? "ğŸ¤– AI Connection established! New message received." :
                                 currentLanguage === 'ar' ? "ğŸ¤– ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§ØªØµØ§Ù„ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ! ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©." :
                                 currentLanguage === 'es' ? "ğŸ¤– Â¡ConexiÃ³n IA establecida! Nuevo mensaje recibido." :
                                 currentLanguage === 'de' ? "ğŸ¤– KI-Verbindung hergestellt! Neue Nachricht erhalten." :
                                 "ğŸ¤– AIè¿æ¥å·²å»ºç«‹ï¼æ”¶åˆ°æ–°æ¶ˆæ¯ã€‚";
            
            showMessage(connectionMsg);
            
            // Animation de connexion
            entity.style.boxShadow = '0 0 50px rgba(0, 255, 255, 1)';
            setTimeout(() => {
                entity.style.boxShadow = '0 0 20px rgba(0, 255, 255, 0.5)';
            }, 2000);
            
            gainXP(15);
            updateStats();
            updateQuestProgress();
            
            // VÃ©rifier si la quÃªte est terminÃ©e
            if (gameState.quests[1].progress >= gameState.quests[1].target && !gameState.quests[1].completed) {
                completeQuest(1);
            }
        }

        // SystÃ¨me d'Ã©nigmes
        function openPuzzle(type) {
            if (gameState.gamePaused) {
                showMessage(currentLanguage === 'fr' ? "â¸ï¸ Jeu en pause ! Reprenez pour jouer." :
                           currentLanguage === 'en' ? "â¸ï¸ Game paused! Resume to play." :
                           currentLanguage === 'ar' ? "â¸ï¸ Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…ØªÙˆÙ‚ÙØ©! Ø§Ø³ØªØ£Ù†Ù Ù„Ù„Ø¹Ø¨." :
                           currentLanguage === 'es' ? "â¸ï¸ Â¡Juego pausado! Reanuda para jugar." :
                           currentLanguage === 'de' ? "â¸ï¸ Spiel pausiert! Fortsetzen zum Spielen." :
                           "â¸ï¸ æ¸¸æˆæš‚åœï¼ç»§ç»­æ¸¸æˆã€‚");
                return;
            }
            
            const modal = document.getElementById('puzzleModal');
            const puzzles = {
                neural: {
                    title: t("neural_puzzle"),
                    description: t("puzzle_description"),
                    type: "sequence"
                }
            };
            
            const puzzle = puzzles[type] || puzzles.neural;
            gameState.currentPuzzle = puzzle;
            gameState.puzzleMovesLeft = 5;
            
            document.getElementById('puzzleTitle').textContent = puzzle.title;
            document.getElementById('puzzleDescription').textContent = puzzle.description;
            document.getElementById('movesCounter').textContent = gameState.puzzleMovesLeft;
            
            generatePuzzleGrid(puzzle.type);
            modal.style.display = 'flex';
        }

        function generatePuzzleGrid(type) {
            const grid = document.getElementById('puzzleGrid');
            grid.innerHTML = '';
            
            if (type === "sequence") {
                // CrÃ©er une grille 4x4 pour la sÃ©quence
                for (let i = 0; i < 16; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'puzzle-cell';
                    cell.dataset.index = i;
                    cell.onclick = () => togglePuzzleCell(cell);
                    grid.appendChild(cell);
                }
                
                // GÃ©nÃ©rer une sÃ©quence alÃ©atoire
                gameState.currentPuzzle.sequence = [];
                for (let i = 0; i < 6; i++) {
                    gameState.currentPuzzle.sequence.push(Math.floor(Math.random() * 16));
                }
                
                // Montrer la sÃ©quence
                showSequence();
            }
        }

        function showSequence() {
            const sequence = gameState.currentPuzzle.sequence;
            let index = 0;
            
            const showNext = () => {
                if (index < sequence.length) {
                    const cell = document.querySelector(`[data-index="${sequence[index]}"]`);
                    cell.style.background = 'linear-gradient(135deg, #00ffff 0%, #ff00ff 100%)';
                    
                    setTimeout(() => {
                        cell.style.background = '';
                        index++;
                        setTimeout(showNext, 300);
                    }, 800);
                } else {
                    // SÃ©quence terminÃ©e, permettre Ã  l'utilisateur de jouer
                    gameState.currentPuzzle.playerSequence = [];
                    const msg = currentLanguage === 'fr' ? "ğŸ§  Reproduisez la sÃ©quence que vous venez de voir !" :
                               currentLanguage === 'en' ? "ğŸ§  Reproduce the sequence you just saw!" :
                               currentLanguage === 'ar' ? "ğŸ§  Ø£Ø¹Ø¯ Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø°ÙŠ Ø±Ø£ÙŠØªÙ‡ Ù„Ù„ØªÙˆ!" :
                               currentLanguage === 'es' ? "ğŸ§  Â¡Reproduce la secuencia que acabas de ver!" :
                               currentLanguage === 'de' ? "ğŸ§  Reproduziere die Sequenz, die du gerade gesehen hast!" :
                               "ğŸ§  é‡ç°ä½ åˆšæ‰çœ‹åˆ°çš„åºåˆ—ï¼";
                    showMessage(msg);
                }
            };
            
            setTimeout(showNext, 1000);
        }

        function togglePuzzleCell(cell) {
            if (!gameState.currentPuzzle.playerSequence || gameState.puzzleMovesLeft <= 0) return;
            
            const index = parseInt(cell.dataset.index);
            gameState.currentPuzzle.playerSequence.push(index);
            gameState.puzzleMovesLeft--;
            
            document.getElementById('movesCounter').textContent = gameState.puzzleMovesLeft;
            
            cell.classList.add('active');
            
            // VÃ©rifier si la sÃ©quence est correcte jusqu'Ã  prÃ©sent
            const playerSeq = gameState.currentPuzzle.playerSequence;
            const targetSeq = gameState.currentPuzzle.sequence;
            
            if (playerSeq.length <= targetSeq.length) {
                const isCorrect = playerSeq.every((val, i) => val === targetSeq[i]);
                
                if (!isCorrect) {
                    // SÃ©quence incorrecte
                    gameState.puzzleMovesLeft--;
                    document.getElementById('movesCounter').textContent = gameState.puzzleMovesLeft;
                    
                    if (gameState.puzzleMovesLeft <= 0) {
                        showMessage(t('puzzle_failed'));
                        setTimeout(() => {
                            closePuzzle();
                        }, 2000);
                    } else {
                        const msg = currentLanguage === 'fr' ? "âŒ SÃ©quence incorrecte ! Essayez Ã  nouveau." :
                                   currentLanguage === 'en' ? "âŒ Incorrect sequence! Try again." :
                                   currentLanguage === 'ar' ? "âŒ ØªØ³Ù„Ø³Ù„ Ø®Ø§Ø·Ø¦! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰." :
                                   currentLanguage === 'es' ? "âŒ Â¡Secuencia incorrecta! IntÃ©ntalo de nuevo." :
                                   currentLanguage === 'de' ? "âŒ Falsche Sequenz! Versuche es erneut." :
                                   "âŒ åºåˆ—é”™è¯¯ï¼å†è¯•ä¸€æ¬¡ã€‚";
                        showMessage(msg);
                        resetPuzzle();
                    }
                } else if (playerSeq.length === targetSeq.length) {
                    // SÃ©quence complÃ¨te et correcte
                    showMessage(t('puzzle_success'));
                    setTimeout(() => {
                        solvePuzzle();
                    }, 1500);
                }
            }
        }

        function resetPuzzle() {
            gameState.currentPuzzle.playerSequence = [];
            gameState.puzzleMovesLeft = 5;
            document.getElementById('movesCounter').textContent = gameState.puzzleMovesLeft;
            
            document.querySelectorAll('.puzzle-cell').forEach(cell => {
                cell.classList.remove('active');
            });
            
            setTimeout(() => {
                showSequence();
            }, 1000);
        }

        function solvePuzzle() {
            gameState.quests[2].progress++;
            gameState.player.crystals += 2;
            
            const msg = currentLanguage === 'fr' ? "ğŸ‰ Ã‰nigme rÃ©solue ! +25 XP et 2 cristaux de mÃ©moire !" :
                       currentLanguage === 'en' ? "ğŸ‰ Puzzle solved! +25 XP and 2 memory crystals!" :
                       currentLanguage === 'ar' ? "ğŸ‰ ØªÙ… Ø­Ù„ Ø§Ù„Ù„ØºØ²! +25 Ù†Ù‚Ø·Ø© Ø®Ø¨Ø±Ø© Ùˆ 2 Ø¨Ù„ÙˆØ±Ø© Ø°Ø§ÙƒØ±Ø©!" :
                       currentLanguage === 'es' ? "ğŸ‰ Â¡Enigma resuelto! Â¡+25 XP y 2 cristales de memoria!" :
                       currentLanguage === 'de' ? "ğŸ‰ RÃ¤tsel gelÃ¶st! +25 EP und 2 GedÃ¤chtniskristalle!" :
                       "ğŸ‰ è°œé¢˜è§£å†³ï¼+25ç»éªŒå€¼å’Œ2ä¸ªè®°å¿†æ°´æ™¶ï¼";
            
            showMessage(msg);
            gainXP(25);
            
            closePuzzle();
            updateStats();
            updateQuestProgress();
            
            // VÃ©rifier si la quÃªte est terminÃ©e
            if (gameState.quests[2].progress >= gameState.quests[2].target && !gameState.quests[2].completed) {
                completeQuest(2);
            }
        }

        function closePuzzle() {
            document.getElementById('puzzleModal').style.display = 'none';
            gameState.currentPuzzle = null;
        }

        // SystÃ¨me de progression
        function gainXP(amount) {
            gameState.player.xp += amount;
            
            // VÃ©rifier le niveau
            const newLevel = Math.floor(gameState.player.xp / 100) + 1;
            if (newLevel > gameState.player.level) {
                levelUp(newLevel);
            }
        }

        function levelUp(newLevel) {
            gameState.player.level = newLevel;
            gameState.player.maxEnergy += 20;
            gameState.player.energy = gameState.player.maxEnergy;
            
            const msg = currentLanguage === 'fr' ? `ğŸŒŸ NIVEAU SUPÃ‰RIEUR ! Niveau ${newLevel} atteint ! Ã‰nergie maximale augmentÃ©e !` :
                       currentLanguage === 'en' ? `ğŸŒŸ LEVEL UP! Level ${newLevel} reached! Maximum energy increased!` :
                       currentLanguage === 'ar' ? `ğŸŒŸ Ø§Ø±ØªÙ‚Ø§Ø¡ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰! ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ ${newLevel}! Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù‚ØµÙˆÙ‰!` :
                       currentLanguage === 'es' ? `ğŸŒŸ Â¡SUBIDA DE NIVEL! Â¡Nivel ${newLevel} alcanzado! Â¡EnergÃ­a mÃ¡xima aumentada!` :
                       currentLanguage === 'de' ? `ğŸŒŸ LEVEL AUFSTIEG! Level ${newLevel} erreicht! Maximale Energie erhÃ¶ht!` :
                       `ğŸŒŸ å‡çº§ï¼è¾¾åˆ°ç­‰çº§${newLevel}ï¼æœ€å¤§èƒ½é‡å¢åŠ ï¼`;
            
            showMessage(msg);
            
            // Effets visuels de niveau supÃ©rieur
            document.body.style.animation = 'quantumShift 2s ease-in-out';
            setTimeout(() => {
                document.body.style.animation = '';
            }, 2000);
        }

        function completeQuest(questId) {
            gameState.quests[questId].completed = true;
            const quest = gameState.quests[questId];
            
            const msg = currentLanguage === 'fr' ? `ğŸ† QUÃŠTE TERMINÃ‰E : ${t(quest.title)} ! RÃ©compense spÃ©ciale dÃ©bloquÃ©e !` :
                       currentLanguage === 'en' ? `ğŸ† QUEST COMPLETED: ${t(quest.title)}! Special reward unlocked!` :
                       currentLanguage === 'ar' ? `ğŸ† ØªÙ…Øª Ø§Ù„Ù…Ù‡Ù…Ø©: ${t(quest.title)}! ØªÙ… ÙØªØ­ Ù…ÙƒØ§ÙØ£Ø© Ø®Ø§ØµØ©!` :
                       currentLanguage === 'es' ? `ğŸ† MISIÃ“N COMPLETADA: ${t(quest.title)}! Â¡Recompensa especial desbloqueada!` :
                       currentLanguage === 'de' ? `ğŸ† MISSION ABGESCHLOSSEN: ${t(quest.title)}! Spezielle Belohnung freigeschaltet!` :
                       `ğŸ† ä»»åŠ¡å®Œæˆï¼š${t(quest.title)}ï¼ç‰¹æ®Šå¥–åŠ±è§£é”ï¼`;
            
            showMessage(msg);
            
            // RÃ©compenses spÃ©ciales
            gainXP(50);
            gameState.player.crystals += 5;
            
            // Marquer visuellement la quÃªte comme terminÃ©e
            const questElement = document.querySelector(`#questList .quest-item:nth-child(${questId + 1})`);
            if (questElement) {
                questElement.classList.add('completed');
            }
            
            updateStats();
        }

        // Actions du joueur
        function scanArea() {
            if (!gameState.gameStarted || gameState.gamePaused) {
                showMessage(currentLanguage === 'fr' ? "ğŸ® Commencez ou reprenez le jeu pour utiliser cette action." :
                           currentLanguage === 'en' ? "ğŸ® Start or resume the game to use this action." :
                           currentLanguage === 'ar' ? "ğŸ® Ø§Ø¨Ø¯Ø£ Ø£Ùˆ Ø§Ø³ØªØ£Ù†Ù Ø§Ù„Ù„Ø¹Ø¨Ø© Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡." :
                           currentLanguage === 'es' ? "ğŸ® Inicia o reanuda el juego para usar esta acciÃ³n." :
                           currentLanguage === 'de' ? "ğŸ® Starte oder setze das Spiel fort, um diese Aktion zu verwenden." :
                           "ğŸ® å¼€å§‹æˆ–ç»§ç»­æ¸¸æˆä»¥ä½¿ç”¨æ­¤æ“ä½œã€‚");
                return;
            }
            
            if (gameState.player.energy < 10) {
                const msg = currentLanguage === 'fr' ? "âš¡ Ã‰nergie insuffisante pour scanner la zone." :
                           currentLanguage === 'en' ? "âš¡ Insufficient energy to scan the area." :
                           currentLanguage === 'ar' ? "âš¡ Ø·Ø§Ù‚Ø© ØºÙŠØ± ÙƒØ§ÙÙŠØ© Ù„Ù…Ø³Ø­ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©." :
                           currentLanguage === 'es' ? "âš¡ EnergÃ­a insuficiente para escanear el Ã¡rea." :
                           currentLanguage === 'de' ? "âš¡ Unzureichende Energie zum Scannen des Gebiets." :
                           "âš¡ èƒ½é‡ä¸è¶³ï¼Œæ— æ³•æ‰«æåŒºåŸŸã€‚";
                showMessage(msg);
                return;
            }
            
            gameState.player.energy -= 10;
            
            // RÃ©vÃ©ler des Ã©lÃ©ments cachÃ©s
            const hiddenElements = Math.floor(Math.random() * 3) + 1;
            
            for (let i = 0; i < hiddenElements; i++) {
                if (Math.random() < 0.5) {
                    createMemoryCrystal();
                } else {
                    createNeuralNode();
                }
            }
            
            const msg = currentLanguage === 'fr' ? `ğŸ” Scan terminÃ© ! ${hiddenElements} nouveaux Ã©lÃ©ments dÃ©tectÃ©s dans la zone.` :
                       currentLanguage === 'en' ? `ğŸ” Scan complete! ${hiddenElements} new elements detected in the area.` :
                       currentLanguage === 'ar' ? `ğŸ” Ø§ÙƒØªÙ…Ù„ Ø§Ù„Ù…Ø³Ø­! ØªÙ… Ø§ÙƒØªØ´Ø§Ù ${hiddenElements} Ø¹Ù†Ø§ØµØ± Ø¬Ø¯ÙŠØ¯Ø© ÙÙŠ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©.` :
                       currentLanguage === 'es' ? `ğŸ” Â¡Escaneo completo! ${hiddenElements} nuevos elementos detectados en el Ã¡rea.` :
                       currentLanguage === 'de' ? `ğŸ” Scan abgeschlossen! ${hiddenElements} neue Elemente im Gebiet entdeckt.` :
                       `ğŸ” æ‰«æå®Œæˆï¼åœ¨åŒºåŸŸä¸­æ£€æµ‹åˆ°${hiddenElements}ä¸ªæ–°å…ƒç´ ã€‚`;
            
            showMessage(msg);
            updateStats();
        }

        function meditate() {
            if (!gameState.gameStarted || gameState.gamePaused) {
                showMessage(currentLanguage === 'fr' ? "ğŸ® Commencez ou reprenez le jeu pour mÃ©diter." :
                           currentLanguage === 'en' ? "ğŸ® Start or resume the game to meditate." :
                           currentLanguage === 'ar' ? "ğŸ® Ø§Ø¨Ø¯Ø£ Ø£Ùˆ Ø§Ø³ØªØ£Ù†Ù Ø§Ù„Ù„Ø¹Ø¨Ø© Ù„Ù„ØªØ£Ù…Ù„." :
                           currentLanguage === 'es' ? "ğŸ® Inicia o reanuda el juego para meditar." :
                           currentLanguage === 'de' ? "ğŸ® Starte oder setze das Spiel fort zum Meditieren." :
                           "ğŸ® å¼€å§‹æˆ–ç»§ç»­æ¸¸æˆè¿›è¡Œå†¥æƒ³ã€‚");
                return;
            }
            
            if (gameState.player.energy >= gameState.player.maxEnergy) {
                const msg = currentLanguage === 'fr' ? "ğŸ§˜ Votre Ã©nergie est dÃ©jÃ  au maximum." :
                           currentLanguage === 'en' ? "ğŸ§˜ Your energy is already at maximum." :
                           currentLanguage === 'ar' ? "ğŸ§˜ Ø·Ø§Ù‚ØªÙƒ ÙÙŠ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ø¨Ø§Ù„ÙØ¹Ù„." :
                           currentLanguage === 'es' ? "ğŸ§˜ Tu energÃ­a ya estÃ¡ al mÃ¡ximo." :
                           currentLanguage === 'de' ? "ğŸ§˜ Deine Energie ist bereits am Maximum." :
                           "ğŸ§˜ ä½ çš„èƒ½é‡å·²ç»è¾¾åˆ°æœ€å¤§å€¼ã€‚";
                showMessage(msg);
                return;
            }
            
            gameState.player.energy = Math.min(gameState.player.maxEnergy, gameState.player.energy + 30);
            
            const msg = currentLanguage === 'fr' ? "ğŸ§˜ MÃ©ditation neural terminÃ©e. Ã‰nergie restaurÃ©e !" :
                       currentLanguage === 'en' ? "ğŸ§˜ Neural meditation complete. Energy restored!" :
                       currentLanguage === 'ar' ? "ğŸ§˜ Ø§ÙƒØªÙ…Ù„ Ø§Ù„ØªØ£Ù…Ù„ Ø§Ù„Ø¹ØµØ¨ÙŠ. ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø·Ø§Ù‚Ø©!" :
                       currentLanguage === 'es' ? "ğŸ§˜ MeditaciÃ³n neural completa. Â¡EnergÃ­a restaurada!" :
                       currentLanguage === 'de' ? "ğŸ§˜ Neurale Meditation abgeschlossen. Energie wiederhergestellt!" :
                       "ğŸ§˜ ç¥ç»å†¥æƒ³å®Œæˆã€‚èƒ½é‡æ¢å¤ï¼";
            
            showMessage(msg);
            
            // Effet visuel de mÃ©ditation
            document.getElementById('gameWorld').style.filter = 'hue-rotate(60deg)';
            setTimeout(() => {
                document.getElementById('gameWorld').style.filter = '';
            }, 2000);
            
            updateStats();
        }

        function askAI() {
            const responses = [
                getDynamicMessage('ai_messages', 0),
                getDynamicMessage('ai_messages', 1),
                getDynamicMessage('ai_messages', 2),
                getDynamicMessage('ai_messages', 3),
                getDynamicMessage('ai_messages', 4)
            ];
            
            const response = responses[Math.floor(Math.random() * responses.length)];
            addAIMessage(response);
        }

        function addAIMessage(message) {
            const chat = document.getElementById('aiChat');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'chat-message ai';
            messageDiv.textContent = message;
            chat.appendChild(messageDiv);
            
            // Faire dÃ©filer vers le bas
            chat.scrollTop = chat.scrollHeight;
            
            // Limiter le nombre de messages
            const messages = chat.querySelectorAll('.chat-message');
            if (messages.length > 10) {
                messages[0].remove();
            }
        }

        function saveProgress() {
            localStorage.setItem('neurosynthExplorer', JSON.stringify(gameState));
            
            const msg = currentLanguage === 'fr' ? "ğŸ’¾ Progression sauvegardÃ©e avec succÃ¨s !" :
                       currentLanguage === 'en' ? "ğŸ’¾ Progress saved successfully!" :
                       currentLanguage === 'ar' ? "ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­!" :
                       currentLanguage === 'es' ? "ğŸ’¾ Â¡Progreso guardado con Ã©xito!" :
                       currentLanguage === 'de' ? "ğŸ’¾ Fortschritt erfolgreich gespeichert!" :
                       "ğŸ’¾ è¿›åº¦ä¿å­˜æˆåŠŸï¼";
            
            showMessage(msg);
        }

        function loadProgress() {
            const saved = localStorage.getItem('neurosynthExplorer');
            if (saved) {
                gameState = JSON.parse(saved);
                updateStats();
                updateQuestProgress();
                
                const msg = currentLanguage === 'fr' ? "ğŸ“ Progression chargÃ©e !" :
                           currentLanguage === 'en' ? "ğŸ“ Progress loaded!" :
                           currentLanguage === 'ar' ? "ğŸ“ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø¯Ù…!" :
                           currentLanguage === 'es' ? "ğŸ“ Â¡Progreso cargado!" :
                           currentLanguage === 'de' ? "ğŸ“ Fortschritt geladen!" :
                           "ğŸ“ è¿›åº¦å·²åŠ è½½ï¼";
                
                showMessage(msg);
                return true;
            }
            return false;
        }

        function resetGame() {
            const confirmMsg = currentLanguage === 'fr' ? "ğŸ”„ ÃŠtes-vous sÃ»r de vouloir recommencer votre voyage neural ?" :
                              currentLanguage === 'en' ? "ğŸ”„ Are you sure you want to restart your neural journey?" :
                              currentLanguage === 'ar' ? "ğŸ”„ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø¹ØµØ¨ÙŠØ©ØŸ" :
                              currentLanguage === 'es' ? "ğŸ”„ Â¿EstÃ¡s seguro de que quieres reiniciar tu viaje neural?" :
                              currentLanguage === 'de' ? "ğŸ”„ Bist du sicher, dass du deine neurale Reise neu starten mÃ¶chtest?" :
                              "ğŸ”„ ä½ ç¡®å®šè¦é‡æ–°å¼€å§‹ä½ çš„ç¥ç»ä¹‹æ—…å—ï¼Ÿ";
            
            if (confirm(confirmMsg)) {
                localStorage.removeItem('neurosynthExplorer');
                location.reload();
            }
        }

        // Fonctions utilitaires
        function updateStats() {
            document.getElementById('playerLevel').textContent = gameState.player.level;
            document.getElementById('playerXP').textContent = gameState.player.xp;
            document.getElementById('playerEnergy').textContent = gameState.player.energy;
            document.getElementById('crystalCount').textContent = gameState.player.crystals;
        }

        function updateQuestProgress() {
            gameState.quests.forEach((quest, index) => {
                const progressBar = document.getElementById(`quest${index}Progress`);
                if (progressBar) {
                    const percentage = Math.min(100, (quest.progress / quest.target) * 100);
                    progressBar.style.width = percentage + '%';
                }
            });
        }

        function createInventorySlots() {
            const grid = document.getElementById('inventoryGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 9; i++) {
                const slot = document.createElement('div');
                slot.className = 'inventory-slot';
                slot.dataset.slot = i;
                
                if (gameState.player.inventory[i]) {
                    slot.textContent = gameState.player.inventory[i].icon;
                    slot.classList.add('filled');
                }
                
                grid.appendChild(slot);
            }
        }

        function updateMinimap() {
            const minimap = document.getElementById('minimap');
            minimap.innerHTML = '';
            
            // Ajouter des points pour les Ã©lÃ©ments importants
            const elements = [
                ...gameState.world.neuralNodes,
                ...gameState.world.aiEntities,
                ...gameState.world.memoryCrystals
            ];
            
            elements.forEach((element, index) => {
                if (index < 20) { // Limiter le nombre de points
                    const dot = document.createElement('div');
                    dot.className = 'minimap-dot';
                    dot.style.left = Math.random() * 90 + 5 + '%';
                    dot.style.top = Math.random() * 90 + 5 + '%';
                    
                    if (element.classList.contains('neural-node')) {
                        dot.style.background = '#00ffff';
                    } else if (element.classList.contains('ai-entity')) {
                        dot.style.background = '#ff00ff';
                    } else {
                        dot.style.background = '#ffff00';
                    }
                    
                    minimap.appendChild(dot);
                }
            });
        }

        function startGameTimer() {
            setInterval(() => {
                gameState.gameTime = Math.floor((Date.now() - gameState.startTime) / 1000);
                const minutes = Math.floor(gameState.gameTime / 60);
                const seconds = gameState.gameTime % 60;
                document.getElementById('gameTime').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function showMessage(text) {
            const display = document.getElementById('messageDisplay');
            display.textContent = text;
            display.classList.add('show');
            
            setTimeout(() => {
                display.classList.remove('show');
            }, 4000);
        }

        function selectQuest(questId) {
            const quest = gameState.quests[questId];
            const msg = currentLanguage === 'fr' ? `ğŸ¯ QuÃªte sÃ©lectionnÃ©e : ${t(quest.title)} (${quest.progress}/${quest.target})` :
                       currentLanguage === 'en' ? `ğŸ¯ Quest selected: ${t(quest.title)} (${quest.progress}/${quest.target})` :
                       currentLanguage === 'ar' ? `ğŸ¯ ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù‡Ù…Ø©: ${t(quest.title)} (${quest.progress}/${quest.target})` :
                       currentLanguage === 'es' ? `ğŸ¯ MisiÃ³n seleccionada: ${t(quest.title)} (${quest.progress}/${quest.target})` :
                       currentLanguage === 'de' ? `ğŸ¯ Mission ausgewÃ¤hlt: ${t(quest.title)} (${quest.progress}/${quest.target})` :
                       `ğŸ¯ ä»»åŠ¡å·²é€‰æ‹©ï¼š${t(quest.title)} (${quest.progress}/${quest.target})`;
            
            showMessage(msg);
        }

        // Initialisation au chargement de la page
        window.addEventListener('load', () => {
            console.log("ğŸš€ Lancement de NeuroSynth Explorer...");
            
            // Essayer de charger une progression sauvegardÃ©e
            if (!loadProgress()) {
                initGame();
            } else {
                // RÃ©gÃ©nÃ©rer le monde si progression chargÃ©e
                generateWorld();
                createInventorySlots();
                updateMinimap();
                startGameTimer();
            }
        });

        // Gestion des Ã©vÃ©nements clavier
        document.addEventListener('keydown', (event) => {
            switch(event.key) {
                case 'Escape':
                    closePuzzle();
                    break;
                case ' ':
                    event.preventDefault();
                    scanArea();
                    break;
                case 'm':
                case 'M':
                    meditate();
                    break;
            }
        });

        // RÃ©gÃ©nÃ©ration pÃ©riodique d'Ã©lÃ©ments
        setInterval(() => {
            if (gameState.world.memoryCrystals.length < 5) {
                createMemoryCrystal();
            }
        }, 30000); // Toutes les 30 secondes

        // RÃ©gÃ©nÃ©ration d'Ã©nergie passive
        setInterval(() => {
            if (gameState.player.energy < gameState.player.maxEnergy) {
                gameState.player.energy = Math.min(gameState.player.maxEnergy, gameState.player.energy + 1);
                updateStats();
            }
        }, 5000); // Toutes les 5 secondes
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'986a8f5b5033e280',t:'MTc1OTEzOTI1NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

<!-- canonical closePlatform handler inserted by automation -->
<script>
    (function(){
        function closePlatform(){
            try{ console.debug && console.debug('jeux15: closePlatform called'); }catch(e){}
            try{
                if(window.parent && window.parent !== window){
                    window.parent.postMessage({ action: 'close', reason: 'user-initiated', source: 'jeux15' }, '*');
                    return;
                }
            }catch(e){}
            try{
                if(window.opener && !window.opener.closed){
                    try{ window.opener.postMessage({ action: 'child-closed', source: 'jeux15' }, '*'); }catch(e){}
                    try{ window.close(); }catch(e){}
                    return;
                }
            }catch(e){}
            // final fallback: navigate to platform home
            try{ window.location.href = '/brainova.html'; }catch(e){ /* ignore */ }
        }
        window.closePlatform = closePlatform;
    })();
</script>
