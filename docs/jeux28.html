<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Tiles - Puzzle Futuriste avec IA</title>
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0033 25%, #330066 50%, #660099 75%, #9900cc 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Effet de grille quantique en arri√®re-plan */
        .quantum-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            background-image: 
                linear-gradient(rgba(0, 255, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 0, 255, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
            animation: quantumMove 15s linear infinite;
        }

        @keyframes quantumMove {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(40px, 40px) rotate(360deg); }
        }

        /* Particules quantiques */
        .quantum-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        .quantum-particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: linear-gradient(45deg, #00ffff, #ff00ff);
            border-radius: 50%;
            animation: quantumFloat 10s infinite linear;
            box-shadow: 0 0 15px currentColor;
        }

        @keyframes quantumFloat {
            0% { transform: translateY(100vh) translateX(0) rotate(0deg) scale(0); opacity: 0; }
            10% { opacity: 1; transform: scale(1); }
            50% { transform: translateY(50vh) translateX(200px) rotate(180deg) scale(1.5); opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-10px) translateX(-100px) rotate(360deg) scale(0); opacity: 0; }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 10;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
        }

        .title-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .game-logo {
            font-size: 4rem;
            animation: quantumPulse 2s ease-in-out infinite;
            filter: drop-shadow(0 0 30px #00ffff);
        }

        .title {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(45deg, #00ffff, #ff00ff, #ffff00, #00ff00);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: quantumGlow 3s ease-in-out infinite;
            text-shadow: 0 0 40px rgba(0, 255, 255, 0.8);
            margin-bottom: 10px;
        }

        @keyframes quantumPulse {
            0%, 100% { transform: scale(1) rotate(0deg); filter: drop-shadow(0 0 30px #00ffff); }
            50% { transform: scale(1.1) rotate(180deg); filter: drop-shadow(0 0 50px #ff00ff); }
        }

        @keyframes quantumGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .subtitle {
            font-size: 1.4rem;
            color: #00ffff;
            opacity: 0.9;
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }

        .language-selector {
            position: relative;
        }

        .language-btn {
            background: linear-gradient(45deg, #1a0033, #330066);
            border: 2px solid #00ffff;
            color: #ffffff;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 255, 255, 0.3);
        }

        .language-btn:hover {
            background: linear-gradient(45deg, #330066, #660099);
            box-shadow: 0 6px 20px rgba(0, 255, 255, 0.6);
            transform: translateY(-2px);
        }

        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(26, 0, 51, 0.95);
            border: 2px solid #00ffff;
            border-radius: 15px;
            margin-top: 5px;
            display: none;
            z-index: 100;
            backdrop-filter: blur(15px);
            min-width: 200px;
        }

        .language-dropdown.show {
            display: block;
        }

        .language-option {
            padding: 12px 15px;
            cursor: pointer;
            transition: background 0.3s ease;
            border-radius: 10px;
            margin: 5px;
            font-size: 0.9rem;
        }

        .language-option:hover {
            background: rgba(0, 255, 255, 0.2);
        }

        .game-layout {
            display: grid;
            grid-template-columns: 280px 1fr 280px;
            gap: 25px;
            align-items: start;
        }

        .left-panel, .right-panel {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #00ffff;
            border-radius: 20px;
            padding: 20px;
            backdrop-filter: blur(15px);
            box-shadow: 0 10px 40px rgba(0, 255, 255, 0.2);
        }

        .panel-title {
            color: #00ffff;
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 15px rgba(0, 255, 255, 0.7);
        }

        .level-selector {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }

        .level-btn {
            background: linear-gradient(45deg, #660099, #9900cc);
            border: 2px solid #ffffff;
            color: #ffffff;
            padding: 12px 18px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: bold;
        }

        .level-btn:hover, .level-btn.active {
            background: linear-gradient(45deg, #9900cc, #cc00ff);
            box-shadow: 0 6px 20px rgba(153, 0, 204, 0.6);
            transform: translateY(-3px);
        }

        .control-btn {
            width: 100%;
            padding: 12px 18px;
            border: none;
            border-radius: 18px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            margin-bottom: 12px;
        }

        .rules-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }

        .start-btn {
            background: linear-gradient(45deg, #00ff88, #00cc6a);
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.4);
        }

        .ai-hint-btn {
            background: linear-gradient(45deg, #ffa500, #ff8c00);
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(255, 165, 0, 0.4);
        }

        .quantum-boost-btn {
            background: linear-gradient(45deg, #9c27b0, #673ab7);
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.4);
        }

        .reset-btn {
            background: linear-gradient(45deg, #37474f, #546e7a);
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(55, 71, 79, 0.4);
        }

        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.4);
        }

        .game-area {
            background: rgba(255, 255, 255, 0.05);
            border: 3px solid #00ffff;
            border-radius: 20px;
            padding: 20px;
            backdrop-filter: blur(15px);
            box-shadow: 0 10px 40px rgba(0, 255, 255, 0.2);
            position: relative;
            min-height: 550px;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .info-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px 20px;
            border-radius: 18px;
            border: 1px solid #00ffff;
            font-weight: bold;
            text-shadow: 0 0 8px rgba(0, 255, 255, 0.5);
        }

        .quantum-board {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 4px;
            width: 100%;
            max-width: 350px;
            aspect-ratio: 1;
            margin: 0 auto;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border: 2px solid #00ffff;
            box-shadow: inset 0 0 30px rgba(0, 255, 255, 0.2);
        }

        .quantum-tile {
            aspect-ratio: 1;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            font-weight: bold;
            position: relative;
            overflow: hidden;
            border: 1px solid transparent;
        }

        .quantum-tile:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
        }

        .quantum-tile.active {
            animation: quantumActivate 0.5s ease-out;
            border-color: #ffff00;
            box-shadow: 0 0 25px #ffff00;
        }

        .quantum-tile.locked {
            cursor: not-allowed;
            opacity: 0.5;
            filter: grayscale(50%);
        }

        .quantum-tile.quantum-enhanced {
            animation: quantumEnhance 1s ease-in-out infinite;
            box-shadow: 0 0 30px #ff00ff, inset 0 0 20px rgba(255, 0, 255, 0.3);
        }

        /* Types de tuiles */
        .tile-empty {
            background: linear-gradient(135deg, #2c2c2c, #1a1a1a);
            border-color: #555;
        }

        .tile-energy {
            background: linear-gradient(135deg, #00ffff, #0099cc);
            color: #000;
            text-shadow: 0 0 10px #ffffff;
        }

        .tile-matter {
            background: linear-gradient(135deg, #ff00ff, #cc0099);
            color: #fff;
            text-shadow: 0 0 10px #ffffff;
        }

        .tile-quantum {
            background: linear-gradient(135deg, #ffff00, #ff8800);
            color: #000;
            text-shadow: 0 0 10px #ffffff;
            animation: quantumShimmer 2s ease-in-out infinite;
        }

        .tile-void {
            background: linear-gradient(135deg, #000000, #330033);
            color: #ff0000;
            border-color: #ff0000;
        }

        .tile-nexus {
            background: linear-gradient(135deg, #ffffff, #cccccc);
            color: #000;
            border-color: #00ffff;
            animation: nexusPulse 1.5s ease-in-out infinite;
        }

        @keyframes quantumActivate {
            0% { transform: scale(1); }
            50% { transform: scale(1.2) rotate(180deg); }
            100% { transform: scale(1) rotate(360deg); }
        }

        @keyframes quantumEnhance {
            0%, 100% { box-shadow: 0 0 30px #ff00ff; }
            50% { box-shadow: 0 0 50px #00ffff, 0 0 70px #ff00ff; }
        }

        @keyframes quantumShimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes nexusPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .ai-assistant {
            position: absolute;
            top: 30px;
            right: 30px;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 20px;
            border: 2px solid #ff00ff;
            min-width: 250px;
            display: none;
            z-index: 50;
        }

        .ai-status {
            color: #ff00ff;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .ai-suggestion {
            color: #00ffff;
            font-size: 0.9rem;
            text-align: center;
            margin-bottom: 10px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1a0033, #330066);
            border: 3px solid #00ffff;
            border-radius: 25px;
            padding: 40px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal h2 {
            color: #00ffff;
            margin-bottom: 25px;
            text-align: center;
            font-size: 2rem;
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 25px;
            background: none;
            border: none;
            color: #ff6b6b;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            color: #ff4757;
            transform: scale(1.3);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-item {
            background: rgba(0, 255, 255, 0.1);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #00ffff;
            font-size: 1rem;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
            border: 1px solid #00ffff;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00ffff);
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .combo-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            font-weight: bold;
            color: #ffff00;
            text-shadow: 0 0 20px #ffff00;
            pointer-events: none;
            z-index: 100;
            display: none;
            animation: comboShow 1s ease-out;
        }

        @keyframes comboShow {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }

        @media (max-width: 1200px) {
            .game-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .left-panel, .right-panel {
                display: flex;
                flex-wrap: wrap;
                gap: 15px;
                justify-content: center;
            }
            
            .level-selector {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .level-btn {
                flex: 1;
                min-width: 120px;
            }
            
            .control-btn {
                flex: 1;
                min-width: 180px;
                margin-bottom: 0;
            }
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2.8rem;
            }
            
            .game-logo {
                font-size: 3rem;
            }
            
            .header {
                flex-direction: column;
                gap: 20px;
            }
            
            .quantum-board {
                grid-template-columns: repeat(5, 1fr);
                grid-template-rows: repeat(5, 1fr);
            }
            
            .quantum-tile {
                font-size: 1.2rem;
            }
        }
        </style>
    <style>
    /* override: consistent global close button */
    .global-close-btn { position: fixed !important; top: 14px !important; right: 14px !important; z-index: 99999 !important; background: linear-gradient(45deg,#ff3b3b,#ff0066) !important; color: #fff !important; border: none !important; width:52px !important; height:52px !important; border-radius:50% !important; font-size:22px !important; cursor:pointer !important; display:flex !important;align-items:center !important;justify-content:center !important; box-shadow:0 8px 22px rgba(255,59,59,0.28) !important; }
    .global-close-btn:hover{ transform: scale(1.06); }
    </style>
</head>
<body>
    <!-- Grille quantique -->
    <div class="quantum-grid"></div>
    
    <!-- Particules quantiques -->
    <div class="quantum-particles" id="particles"></div>

    <div class="container">
        <div class="header">
            <div class="title-section">
                <div class="game-logo">üîÆ</div>
                <div>
                    <h1 class="title">QUANTUM TILES</h1>
                    <p class="subtitle" id="subtitle">Puzzle quantique avec IA avanc√©e</p>
                </div>
            </div>
            <button class="global-close-btn" title="Fermer" aria-label="Fermer" onclick="(function(){ try{ if(window.parent && window.parent !== window){ window.parent.postMessage({action:'close', source:'jeux28'}, '*'); } else { window.location.href = './brainova.html'; } }catch(e){ window.location.href = './brainova.html'; } })()">‚úï</button>
            <div class="language-selector">
                <button class="language-btn" id="languageBtn">üåê Fran√ßais</button>
                <div class="language-dropdown" id="languageDropdown">
                    <div class="language-option" data-lang="fr">üá´üá∑ Fran√ßais</div>
                    <div class="language-option" data-lang="en">üá¨üáß English</div>
                    <div class="language-option" data-lang="ar">üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</div>
                    <div class="language-option" data-lang="es">üá™üá∏ Espa√±ol</div>
                    <div class="language-option" data-lang="de">üá©üá™ Deutsch</div>
                    <div class="language-option" data-lang="zh">üá®üá≥ ‰∏≠Êñá</div>
                </div>
            </div>
        </div>

        <div class="game-layout">
            <div class="left-panel">
                <h3 class="panel-title" id="levelsTitle">Niveaux Quantiques</h3>
                <div class="level-selector">
                    <button class="level-btn active" data-level="1" id="level1">Novice</button>
                    <button class="level-btn" data-level="2" id="level2">Adepte</button>
                    <button class="level-btn" data-level="3" id="level3">Expert</button>
                    <button class="level-btn" data-level="4" id="level4">Ma√Ætre Quantique</button>
                    <button class="level-btn" data-level="5" id="level5">Transcendant</button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-item">
                        <div id="scoreLabel">Score Quantique</div>
                        <div id="score">0</div>
                    </div>
                    <div class="stat-item">
                        <div id="levelLabel">Niveau</div>
                        <div id="currentLevel">1</div>
                    </div>
                    <div class="stat-item">
                        <div id="movesLabel">Mouvements</div>
                        <div id="moves">0</div>
                    </div>
                    <div class="stat-item">
                        <div id="comboLabel">Combo Max</div>
                        <div id="maxCombo">0</div>
                    </div>
                </div>
            </div>

            <div class="game-area">
                <div class="game-info">
                    <div class="info-item">
                        <span id="objectiveLabel">Objectif:</span> <span id="currentObjective">Aligner 3 √©nergies</span>
                    </div>
                    <div class="info-item">
                        <span id="energyLabel">√ânergie:</span> <span id="energy">100%</span>
                    </div>
                    <div class="info-item">
                        <span id="timeLabel">Temps:</span> <span id="timeRemaining">‚àû</span>
                    </div>
                    <div class="info-item">
                        <span id="comboCurrentLabel">Combo:</span> <span id="currentCombo">0</span>
                    </div>
                </div>
                
                <div class="quantum-board" id="quantumBoard">
                    <!-- Les tuiles seront g√©n√©r√©es dynamiquement -->
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                </div>
                
                <!-- Assistant IA -->
                <div class="ai-assistant" id="aiAssistant">
                    <div class="ai-status" id="aiStatus">Assistant Quantique</div>
                    <div class="ai-suggestion" id="aiSuggestion">Analyse des patterns quantiques...</div>
                </div>
                
                <!-- Indicateur de combo -->
                <div class="combo-indicator" id="comboIndicator">COMBO x3!</div>
            </div>

            <div class="right-panel">
                <h3 class="panel-title" id="actionsTitle">Actions Quantiques</h3>
                <button class="control-btn rules-btn" id="rulesBtn">üìã R√®gles</button>
                <button class="control-btn start-btn" id="startBtn">üöÄ Commencer</button>
                <button class="control-btn start-btn" id="newGameBtn">üîÑ Nouvelle Partie</button>
                <button class="control-btn ai-hint-btn" id="aiHintBtn">ü§ñ Indice IA</button>
                <button class="control-btn quantum-boost-btn" id="quantumBoostBtn">‚ö° Boost Quantique</button>
                <button class="control-btn ai-hint-btn" id="solutionBtn">üí° Solution</button>
                <button class="control-btn reset-btn" id="resetBtn">üîÑ R√©initialiser</button>
                
                <div class="stats-grid" style="margin-top: 25px;">
                    <div class="stat-item">
                        <div id="efficiencyLabel">Efficacit√©</div>
                        <div id="efficiency">0%</div>
                    </div>
                    <div class="stat-item">
                        <div id="quantumLabel">Particules Q</div>
                        <div id="quantumParticles">0</div>
                    </div>
                    <div class="stat-item">
                        <div id="chainLabel">Cha√Ænes</div>
                        <div id="chains">0</div>
                    </div>
                    <div class="stat-item">
                        <div id="rankLabel">Rang</div>
                        <div id="rank">Novice</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal des r√®gles -->
    <div class="modal" id="rulesModal">
        <div class="modal-content">
            <button class="close-btn" id="closeRules">&times;</button>
            <h2 id="rulesTitle">R√®gles de Quantum Tiles</h2>
            <div id="rulesContent">
                <!-- Le contenu sera mis √† jour selon la langue -->
            </div>
        </div>
    </div>

    <script>
        // Traductions compl√®tes
        const translations = {
            fr: {
                subtitle: "Puzzle quantique avec IA avanc√©e",
                levelsTitle: "Niveaux Quantiques",
                actionsTitle: "Actions Quantiques",
                rules: "üìã R√®gles",
                start: "üöÄ Commencer",
                newGame: "üîÑ Nouvelle Partie",
                aiHint: "ü§ñ Indice IA",
                quantumBoost: "‚ö° Boost Quantique",
                solution: "üí° Solution",
                reset: "üîÑ R√©initialiser",
                scoreLabel: "Score Quantique",
                levelLabel: "Niveau",
                movesLabel: "Mouvements",
                comboLabel: "Combo Max",
                objectiveLabel: "Objectif:",
                energyLabel: "√ânergie:",
                timeLabel: "Temps:",
                comboCurrentLabel: "Combo:",
                efficiencyLabel: "Efficacit√©",
                quantumLabel: "Particules Q",
                chainLabel: "Cha√Ænes",
                rankLabel: "Rang",
                rulesTitle: "R√®gles de Quantum Tiles",
                levels: ["Novice", "Adepte", "Expert", "Ma√Ætre Quantique", "Transcendant"],
                ranks: ["Novice", "Apprenti", "Adepte", "Expert", "Ma√Ætre", "Transcendant"],
                objectives: [
                    "Aligner 3 √©nergies",
                    "Cr√©er une cha√Æne de 5",
                    "Activer 3 nexus",
                    "√âliminer tous les vides",
                    "Transcender la r√©alit√©"
                ],
                aiStatus: "Assistant Quantique",
                rulesContent: `
                    <p><strong>üéØ Objectif:</strong> Manipulez les tuiles quantiques pour atteindre les objectifs sp√©cifiques de chaque niveau.</p>
                    
                    <p><strong>üéÆ Types de Tuiles:</strong></p>
                    <ul>
                        <li>üîÆ <strong>√ânergie (Bleu):</strong> +50 pts, active les tuiles d'√©nergie adjacentes</li>
                        <li>üåü <strong>Mati√®re (Magenta):</strong> +75 pts, stabilise les tuiles adjacentes, +2 particules Q</li>
                        <li>‚ö° <strong>Quantum (Jaune):</strong> +150 pts, effets al√©atoires (cha√Æne/transformation/multiplication/t√©l√©portation)</li>
                        <li>üï≥Ô∏è <strong>Vide (Noir):</strong> Absorbe -10 √©nergie, peut √™tre √©limin√© pour +300 pts</li>
                        <li>üíé <strong>Nexus (Blanc):</strong> +200 pts par connexion, cr√©e des cha√Ænes puissantes</li>
                    </ul>
                    
                    <p><strong>üìã Objectifs par Niveau:</strong></p>
                    <ul>
                        <li><strong>Niveau 1 - Novice:</strong> Atteindre 500 points avec des alignements d'√©nergie</li>
                        <li><strong>Niveau 2 - Adepte:</strong> Cr√©er 2 cha√Ænes de r√©action avec les tuiles quantiques</li>
                        <li><strong>Niveau 3 - Expert:</strong> Activer 3 nexus pour √©tablir des connexions</li>
                        <li><strong>Niveau 4 - Ma√Ætre:</strong> √âliminer tous les vides du plateau</li>
                        <li><strong>Niveau 5 - Transcendant:</strong> Atteindre 5000 points + combo maximum de 5</li>
                    </ul>
                    
                    <p><strong>‚ö° M√©caniques Avanc√©es:</strong></p>
                    <ul>
                        <li><strong>Alignements:</strong> 3+ tuiles identiques adjacentes = bonus de points</li>
                        <li><strong>Combos:</strong> Encha√Æner les actions augmente les multiplicateurs</li>
                        <li><strong>√ânergie:</strong> Chaque action co√ªte 2 points d'√©nergie (r√©g√©n√®re automatiquement)</li>
                        <li><strong>Particules Q:</strong> Collect√©es via mati√®re et vides √©limin√©s</li>
                        <li><strong>Cha√Ænes:</strong> R√©actions en cascade via nexus et quantum</li>
                    </ul>
                    
                    <p><strong>ü§ñ Outils d'Aide:</strong></p>
                    <ul>
                        <li><strong>Indice IA (30 √©nergie):</strong> Conseils strat√©giques personnalis√©s</li>
                        <li><strong>Solution (40 √©nergie):</strong> S√©quence optimale avec explications d√©taill√©es</li>
                        <li><strong>Boost Quantique (50 √©nergie):</strong> Amplifie tous les effets pendant 10 secondes</li>
                    </ul>
                `
            },
            en: {
                subtitle: "Quantum puzzle with advanced AI",
                levelsTitle: "Quantum Levels",
                actionsTitle: "Quantum Actions",
                rules: "üìã Rules",
                start: "üöÄ Start",
                newGame: "üîÑ New Game",
                aiHint: "ü§ñ AI Hint",
                quantumBoost: "‚ö° Quantum Boost",
                solution: "üí° Solution",
                reset: "üîÑ Reset",
                scoreLabel: "Quantum Score",
                levelLabel: "Level",
                movesLabel: "Moves",
                comboLabel: "Max Combo",
                objectiveLabel: "Objective:",
                energyLabel: "Energy:",
                timeLabel: "Time:",
                comboCurrentLabel: "Combo:",
                efficiencyLabel: "Efficiency",
                quantumLabel: "Q Particles",
                chainLabel: "Chains",
                rankLabel: "Rank",
                rulesTitle: "Quantum Tiles Rules",
                levels: ["Novice", "Adept", "Expert", "Quantum Master", "Transcendent"],
                ranks: ["Novice", "Apprentice", "Adept", "Expert", "Master", "Transcendent"],
                objectives: [
                    "Align 3 energies",
                    "Create chain of 5",
                    "Activate 3 nexus",
                    "Eliminate all voids",
                    "Transcend reality"
                ],
                aiStatus: "Quantum Assistant",
                rulesContent: `
                    <p><strong>Objective:</strong> Manipulate quantum tiles to create alignments and chain reactions.</p>
                    <p><strong>How to play:</strong></p>
                    <ul>
                        <li>üîÆ <strong>Energy (Blue):</strong> Basic tiles, create chains</li>
                        <li>üåü <strong>Matter (Magenta):</strong> Stable tiles, resist effects</li>
                        <li>‚ö° <strong>Quantum (Yellow):</strong> Special tiles, trigger effects</li>
                        <li>üï≥Ô∏è <strong>Void (Black):</strong> Obstacles to eliminate</li>
                        <li>üíé <strong>Nexus (White):</strong> Powerful connection points</li>
                    </ul>
                    <p><strong>Mechanics:</strong></p>
                    <ul>
                        <li>Click on a tile to activate it</li>
                        <li>Create alignments of 3+ identical tiles</li>
                        <li>Chain reactions give more points</li>
                        <li>Use AI for strategic advice</li>
                        <li>Quantum boost amplifies your actions</li>
                    </ul>
                    <p><strong>Levels:</strong></p>
                    <ul>
                        <li><strong>Novice:</strong> 5x5 grid, simple objectives</li>
                        <li><strong>Adept:</strong> 6x6 grid, special tiles</li>
                        <li><strong>Expert:</strong> Obstacles, time limit</li>
                        <li><strong>Master:</strong> Advanced mechanics</li>
                        <li><strong>Transcendent:</strong> Total quantum chaos</li>
                    </ul>
                `
            },
            ar: {
                subtitle: "ŸÑÿ∫ÿ≤ ŸÉŸÖŸä ŸÖÿπ ÿ∞ŸÉÿßÿ° ÿßÿµÿ∑ŸÜÿßÿπŸä ŸÖÿ™ŸÇÿØŸÖ",
                levelsTitle: "ÿßŸÑŸÖÿ≥ÿ™ŸàŸäÿßÿ™ ÿßŸÑŸÉŸÖŸäÿ©",
                actionsTitle: "ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿßŸÑŸÉŸÖŸäÿ©",
                rules: "üìã ÿßŸÑŸÇŸàÿßÿπÿØ",
                start: "üöÄ ÿßÿ®ÿØÿ£",
                newGame: "üîÑ ŸÑÿπÿ®ÿ© ÿ¨ÿØŸäÿØÿ©",
                aiHint: "ü§ñ ÿ™ŸÑŸÖŸäÿ≠ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä",
                quantumBoost: "‚ö° ÿ™ÿπÿ≤Ÿäÿ≤ ŸÉŸÖŸä",
                solution: "üí° ÿßŸÑÿ≠ŸÑ",
                reset: "üîÑ ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ",
                scoreLabel: "ÿßŸÑŸÜŸÇÿßÿ∑ ÿßŸÑŸÉŸÖŸäÿ©",
                levelLabel: "ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ",
                movesLabel: "ÿßŸÑÿ≠ÿ±ŸÉÿßÿ™",
                comboLabel: "ÿ£ŸÇÿµŸâ ÿ™ÿ±ŸÉŸäÿ®ÿ©",
                objectiveLabel: "ÿßŸÑŸáÿØŸÅ:",
                energyLabel: "ÿßŸÑÿ∑ÿßŸÇÿ©:",
                timeLabel: "ÿßŸÑŸàŸÇÿ™:",
                comboCurrentLabel: "ÿßŸÑÿ™ÿ±ŸÉŸäÿ®ÿ©:",
                efficiencyLabel: "ÿßŸÑŸÉŸÅÿßÿ°ÿ©",
                quantumLabel: "ÿ¨ÿ≥ŸäŸÖÿßÿ™ ŸÉ",
                chainLabel: "ÿßŸÑÿ≥ŸÑÿßÿ≥ŸÑ",
                rankLabel: "ÿßŸÑÿ±ÿ™ÿ®ÿ©",
                rulesTitle: "ŸÇŸàÿßÿπÿØ ÿßŸÑÿ®ŸÑÿßÿ∑ ÿßŸÑŸÉŸÖŸä",
                levels: ["ŸÖÿ®ÿ™ÿØÿ¶", "ŸÖÿßŸáÿ±", "ÿÆÿ®Ÿäÿ±", "ÿ≥ŸäÿØ ŸÉŸÖŸä", "ŸÖÿ™ÿ≥ÿßŸÖŸä"],
                ranks: ["ŸÖÿ®ÿ™ÿØÿ¶", "ŸÖÿ™ÿØÿ±ÿ®", "ŸÖÿßŸáÿ±", "ÿÆÿ®Ÿäÿ±", "ÿ£ÿ≥ÿ™ÿßÿ∞", "ŸÖÿ™ÿ≥ÿßŸÖŸä"],
                objectives: [
                    "ŸÖÿ≠ÿßÿ∞ÿßÿ© 3 ÿ∑ÿßŸÇÿßÿ™",
                    "ÿ•ŸÜÿ¥ÿßÿ° ÿ≥ŸÑÿ≥ŸÑÿ© ŸÖŸÜ 5",
                    "ÿ™ŸÅÿπŸäŸÑ 3 ŸÜŸÇÿßÿ∑ ÿßÿ™ÿµÿßŸÑ",
                    "ÿßŸÑŸÇÿ∂ÿßÿ° ÿπŸÑŸâ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÅÿ±ÿßÿ∫ÿßÿ™",
                    "ÿ™ÿ¨ÿßŸàÿ≤ ÿßŸÑŸàÿßŸÇÿπ"
                ],
                aiStatus: "ÿßŸÑŸÖÿ≥ÿßÿπÿØ ÿßŸÑŸÉŸÖŸä",
                rulesContent: `
                    <p><strong>ÿßŸÑŸáÿØŸÅ:</strong> ÿ™ŸÑÿßÿπÿ® ÿ®ÿßŸÑÿ®ŸÑÿßÿ∑ ÿßŸÑŸÉŸÖŸä ŸÑÿ•ŸÜÿ¥ÿßÿ° ŸÖÿ≠ÿßÿ∞ÿßÿ© Ÿàÿ™ŸÅÿßÿπŸÑÿßÿ™ ŸÖÿ™ÿ≥ŸÑÿ≥ŸÑÿ©.</p>
                    <p><strong>ŸÉŸäŸÅŸäÿ© ÿßŸÑŸÑÿπÿ®:</strong></p>
                    <ul>
                        <li>üîÆ <strong>ÿßŸÑÿ∑ÿßŸÇÿ© (ÿ£ÿ≤ÿ±ŸÇ):</strong> ÿ®ŸÑÿßÿ∑ ÿ£ÿ≥ÿßÿ≥Ÿäÿå ŸäŸÜÿ¥ÿ¶ ÿ≥ŸÑÿßÿ≥ŸÑ</li>
                        <li>üåü <strong>ÿßŸÑŸÖÿßÿØÿ© (ÿ£ÿ±ÿ¨ŸàÿßŸÜŸä):</strong> ÿ®ŸÑÿßÿ∑ ŸÖÿ≥ÿ™ŸÇÿ±ÿå ŸäŸÇÿßŸàŸÖ ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™</li>
                        <li>‚ö° <strong>ŸÉŸÖŸä (ÿ£ÿµŸÅÿ±):</strong> ÿ®ŸÑÿßÿ∑ ÿÆÿßÿµÿå Ÿäÿ§ÿØŸä ÿ•ŸÑŸâ ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™</li>
                        <li>üï≥Ô∏è <strong>ŸÅÿ±ÿßÿ∫ (ÿ£ÿ≥ŸàÿØ):</strong> ÿπŸàÿßÿ¶ŸÇ ŸÑŸÑŸÇÿ∂ÿßÿ° ÿπŸÑŸäŸáÿß</li>
                        <li>üíé <strong>ŸÜŸÇÿ∑ÿ© ÿßÿ™ÿµÿßŸÑ (ÿ£ÿ®Ÿäÿ∂):</strong> ŸÜŸÇÿßÿ∑ ÿßÿ™ÿµÿßŸÑ ŸÇŸàŸäÿ©</li>
                    </ul>
                `
            },
            es: {
                subtitle: "Puzzle cu√°ntico con IA avanzada",
                levelsTitle: "Niveles Cu√°nticos",
                actionsTitle: "Acciones Cu√°nticas",
                rules: "üìã Reglas",
                start: "üöÄ Comenzar",
                newGame: "üîÑ Nuevo Juego",
                aiHint: "ü§ñ Pista IA",
                quantumBoost: "‚ö° Impulso Cu√°ntico",
                solution: "üí° Soluci√≥n",
                reset: "üîÑ Reiniciar",
                scoreLabel: "Puntuaci√≥n Cu√°ntica",
                levelLabel: "Nivel",
                movesLabel: "Movimientos",
                comboLabel: "Combo M√°ximo",
                objectiveLabel: "Objetivo:",
                energyLabel: "Energ√≠a:",
                timeLabel: "Tiempo:",
                comboCurrentLabel: "Combo:",
                efficiencyLabel: "Eficiencia",
                quantumLabel: "Part√≠culas Q",
                chainLabel: "Cadenas",
                rankLabel: "Rango",
                rulesTitle: "Reglas de Quantum Tiles",
                levels: ["Novato", "Adepto", "Experto", "Maestro Cu√°ntico", "Trascendente"],
                ranks: ["Novato", "Aprendiz", "Adepto", "Experto", "Maestro", "Trascendente"],
                objectives: [
                    "Alinear 3 energ√≠as",
                    "Crear cadena de 5",
                    "Activar 3 nexos",
                    "Eliminar todos los vac√≠os",
                    "Trascender la realidad"
                ],
                aiStatus: "Asistente Cu√°ntico",
                rulesContent: `
                    <p><strong>Objetivo:</strong> Manipula las fichas cu√°nticas para crear alineaciones y reacciones en cadena.</p>
                `
            },
            de: {
                subtitle: "Quantenpuzzle mit fortgeschrittener KI",
                levelsTitle: "Quantenstufen",
                actionsTitle: "Quantenaktionen",
                rules: "üìã Regeln",
                start: "üöÄ Starten",
                newGame: "üîÑ Neues Spiel",
                aiHint: "ü§ñ KI-Hinweis",
                quantumBoost: "‚ö° Quantenschub",
                solution: "üí° L√∂sung",
                reset: "üîÑ Zur√ºcksetzen",
                scoreLabel: "Quantenpunkte",
                levelLabel: "Stufe",
                movesLabel: "Z√ºge",
                comboLabel: "Max Combo",
                objectiveLabel: "Ziel:",
                energyLabel: "Energie:",
                timeLabel: "Zeit:",
                comboCurrentLabel: "Combo:",
                efficiencyLabel: "Effizienz",
                quantumLabel: "Q-Teilchen",
                chainLabel: "Ketten",
                rankLabel: "Rang",
                rulesTitle: "Quantum Tiles Regeln",
                levels: ["Anf√§nger", "Adept", "Experte", "Quantenmeister", "Transzendent"],
                ranks: ["Anf√§nger", "Lehrling", "Adept", "Experte", "Meister", "Transzendent"],
                objectives: [
                    "3 Energien ausrichten",
                    "Kette von 5 erstellen",
                    "3 Nexus aktivieren",
                    "Alle L√ºcken beseitigen",
                    "Realit√§t transzendieren"
                ],
                aiStatus: "Quantenassistent",
                rulesContent: `
                    <p><strong>Ziel:</strong> Manipuliere Quantenkacheln, um Ausrichtungen und Kettenreaktionen zu erstellen.</p>
                `
            },
            zh: {
                subtitle: "ÈáèÂ≠êÊãºÂõæ‰∏éÂÖàËøõAI",
                levelsTitle: "ÈáèÂ≠êÁ≠âÁ∫ß",
                actionsTitle: "ÈáèÂ≠êÊìç‰Ωú",
                rules: "üìã ËßÑÂàô",
                start: "üöÄ ÂºÄÂßã",
                newGame: "üîÑ Êñ∞Ê∏∏Êàè",
                aiHint: "ü§ñ AIÊèêÁ§∫",
                quantumBoost: "‚ö° ÈáèÂ≠êÂ¢ûÂº∫",
                solution: "üí° Ëß£ÂÜ≥ÊñπÊ°à",
                reset: "üîÑ ÈáçÁΩÆ",
                scoreLabel: "ÈáèÂ≠êÂàÜÊï∞",
                levelLabel: "Á≠âÁ∫ß",
                movesLabel: "ÁßªÂä®",
                comboLabel: "ÊúÄÂ§ßËøûÂáª",
                objectiveLabel: "ÁõÆÊ†á:",
                energyLabel: "ËÉΩÈáè:",
                timeLabel: "Êó∂Èó¥:",
                comboCurrentLabel: "ËøûÂáª:",
                efficiencyLabel: "ÊïàÁéá",
                quantumLabel: "QÁ≤íÂ≠ê",
                chainLabel: "ÈìæÊù°",
                rankLabel: "Á≠âÁ∫ß",
                rulesTitle: "ÈáèÂ≠êÊñπÂùóËßÑÂàô",
                levels: ["Êñ∞Êâã", "Â≠¶Âæí", "‰∏ìÂÆ∂", "ÈáèÂ≠êÂ§ßÂ∏à", "Ë∂ÖË∂äËÄÖ"],
                ranks: ["Êñ∞Êâã", "Â≠¶Âæí", "ÁÜüÁªÉ", "‰∏ìÂÆ∂", "Â§ßÂ∏à", "Ë∂ÖË∂äËÄÖ"],
                objectives: [
                    "ÂØπÈΩê3‰∏™ËÉΩÈáè",
                    "ÂàõÂª∫5‰∏™ÈìæÊù°",
                    "ÊøÄÊ¥ª3‰∏™ËøûÊé•ÁÇπ",
                    "Ê∂àÈô§ÊâÄÊúâÁ©∫Èöô",
                    "Ë∂ÖË∂äÁé∞ÂÆû"
                ],
                aiStatus: "ÈáèÂ≠êÂä©Êâã",
                rulesContent: `
                    <p><strong>ÁõÆÊ†á:</strong> ÊìçÁ∫µÈáèÂ≠êÊñπÂùóÂàõÂª∫ÂØπÈΩêÂíåËøûÈîÅÂèçÂ∫î„ÄÇ</p>
                `
            }
        };

        // Variables du jeu
        let currentLanguage = 'fr';
        let currentLevel = 1;
        let score = 0;
        let moves = 0;
        let currentCombo = 0;
        let maxCombo = 0;
        let energy = 100;
        let quantumParticles = 0;
        let chains = 0;
        let gameStarted = false;
        let gameBoard = [];
        let boardSize = 6;
        let aiHintActive = false;
        let quantumBoostActive = false;
        let gameTimer = null;
        let timeRemaining = null;

        // Types de tuiles
        const TILE_TYPES = {
            EMPTY: 'empty',
            ENERGY: 'energy',
            MATTER: 'matter',
            QUANTUM: 'quantum',
            VOID: 'void',
            NEXUS: 'nexus'
        };

        // Configuration des niveaux
        const levelConfig = {
            1: { 
                size: 5, 
                types: ['energy', 'matter'], 
                objective: 'align3',
                timeLimit: null,
                difficulty: 'easy'
            },
            2: { 
                size: 6, 
                types: ['energy', 'matter', 'quantum'], 
                objective: 'chain5',
                timeLimit: null,
                difficulty: 'medium'
            },
            3: { 
                size: 6, 
                types: ['energy', 'matter', 'quantum', 'void'], 
                objective: 'nexus3',
                timeLimit: 180,
                difficulty: 'hard'
            },
            4: { 
                size: 7, 
                types: ['energy', 'matter', 'quantum', 'void', 'nexus'], 
                objective: 'clearVoids',
                timeLimit: 120,
                difficulty: 'expert'
            },
            5: { 
                size: 8, 
                types: ['energy', 'matter', 'quantum', 'void', 'nexus'], 
                objective: 'transcend',
                timeLimit: 90,
                difficulty: 'transcendent'
            }
        };

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            initializeGame();
            setupEventListeners();
            createQuantumParticles();
        });

        function createQuantumParticles() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 60; i++) {
                const particle = document.createElement('div');
                particle.className = 'quantum-particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 10 + 's';
                particle.style.animationDuration = (10 + Math.random() * 5) + 's';
                
                // Couleurs al√©atoires pour les particules
                const colors = ['#00ffff', '#ff00ff', '#ffff00', '#00ff88'];
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                
                particlesContainer.appendChild(particle);
            }
        }

        function setupEventListeners() {
            // S√©lecteur de langue
            document.getElementById('languageBtn').addEventListener('click', function() {
                const dropdown = document.getElementById('languageDropdown');
                dropdown.classList.toggle('show');
            });

            // Options de langue
            document.querySelectorAll('.language-option').forEach(option => {
                option.addEventListener('click', function() {
                    const lang = this.dataset.lang;
                    changeLanguage(lang);
                    document.getElementById('languageDropdown').classList.remove('show');
                });
            });

            // Boutons de niveau
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentLevel = parseInt(this.dataset.level);
                    document.getElementById('currentLevel').textContent = currentLevel;
                    if (!gameStarted) {
                        initializeGame();
                    }
                });
            });

            // Boutons de contr√¥le
            document.getElementById('rulesBtn').addEventListener('click', showRules);
            document.getElementById('startBtn').addEventListener('click', startNewGame);
            document.getElementById('newGameBtn').addEventListener('click', startNewGame);
            document.getElementById('resetBtn').addEventListener('click', resetGame);
            document.getElementById('closeRules').addEventListener('click', hideRules);
            document.getElementById('aiHintBtn').addEventListener('click', activateAIHint);
            document.getElementById('quantumBoostBtn').addEventListener('click', activateQuantumBoost);
            document.getElementById('solutionBtn').addEventListener('click', showSolution);

            // Fermer dropdown en cliquant ailleurs
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.language-selector')) {
                    document.getElementById('languageDropdown').classList.remove('show');
                }
            });
        }

        function changeLanguage(lang) {
            currentLanguage = lang;
            const t = translations[lang];
            
            // Mettre √† jour tous les textes
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('levelsTitle').textContent = t.levelsTitle;
            document.getElementById('actionsTitle').textContent = t.actionsTitle;
            document.getElementById('rulesBtn').innerHTML = t.rules;
            document.getElementById('startBtn').innerHTML = t.start;
            document.getElementById('newGameBtn').innerHTML = t.newGame;
            document.getElementById('aiHintBtn').innerHTML = t.aiHint;
            document.getElementById('quantumBoostBtn').innerHTML = t.quantumBoost;
            document.getElementById('solutionBtn').innerHTML = t.solution;
            document.getElementById('resetBtn').innerHTML = t.reset;
            
            // Labels
            document.getElementById('scoreLabel').textContent = t.scoreLabel;
            document.getElementById('levelLabel').textContent = t.levelLabel;
            document.getElementById('movesLabel').textContent = t.movesLabel;
            document.getElementById('comboLabel').textContent = t.comboLabel;
            document.getElementById('objectiveLabel').textContent = t.objectiveLabel;
            document.getElementById('energyLabel').textContent = t.energyLabel;
            document.getElementById('timeLabel').textContent = t.timeLabel;
            document.getElementById('comboCurrentLabel').textContent = t.comboCurrentLabel;
            document.getElementById('efficiencyLabel').textContent = t.efficiencyLabel;
            document.getElementById('quantumLabel').textContent = t.quantumLabel;
            document.getElementById('chainLabel').textContent = t.chainLabel;
            document.getElementById('rankLabel').textContent = t.rankLabel;
            document.getElementById('aiStatus').textContent = t.aiStatus;
            
            // Boutons de niveau
            for (let i = 0; i < 5; i++) {
                document.getElementById(`level${i + 1}`).textContent = t.levels[i];
            }
            
            // Bouton de langue
            const names = { fr: 'Fran√ßais', en: 'English', ar: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©', es: 'Espa√±ol', de: 'Deutsch', zh: '‰∏≠Êñá' };
            document.getElementById('languageBtn').innerHTML = `üåê ${names[lang]}`;
            
            // Mettre √† jour l'objectif actuel
            updateObjectiveDisplay();
        }

        function initializeGame() {
            const config = levelConfig[currentLevel];
            boardSize = config.size;
            timeRemaining = config.timeLimit;
            
            if (!gameStarted) {
                score = 0;
                moves = 0;
                currentCombo = 0;
                maxCombo = 0;
                energy = 100;
                quantumParticles = 0;
                chains = 0;
            }
            
            createGameBoard();
            updateDisplay();
            updateObjectiveDisplay();
            
            if (!gameStarted) {
                showNotification("üîÆ Interface quantique initialis√©e! Pr√™t pour la manipulation de la r√©alit√©!", 'info');
            }
        }

        function createGameBoard() {
            const board = document.getElementById('quantumBoard');
            board.innerHTML = '';
            board.style.gridTemplateColumns = `repeat(${boardSize}, 1fr)`;
            board.style.gridTemplateRows = `repeat(${boardSize}, 1fr)`;
            
            gameBoard = [];
            
            for (let i = 0; i < boardSize * boardSize; i++) {
                const tile = document.createElement('div');
                tile.className = 'quantum-tile';
                tile.dataset.index = i;
                
                // G√©n√©rer un type de tuile al√©atoire selon le niveau
                const config = levelConfig[currentLevel];
                const tileType = generateRandomTileType(config.types);
                
                tile.dataset.type = tileType;
                tile.className += ` tile-${tileType}`;
                
                // Ajouter le symbole appropri√©
                tile.innerHTML = getTileSymbol(tileType);
                
                // Ajouter l'√©v√©nement de clic
                tile.addEventListener('click', () => activateTile(i));
                
                board.appendChild(tile);
                gameBoard.push({
                    type: tileType,
                    active: false,
                    locked: false
                });
            }
        }

        function generateRandomTileType(availableTypes) {
            // Distribution pond√©r√©e selon le niveau
            const weights = {
                'energy': 0.4,
                'matter': 0.3,
                'quantum': 0.15,
                'void': 0.1,
                'nexus': 0.05
            };
            
            const filteredTypes = availableTypes.filter(type => weights[type]);
            const random = Math.random();
            let cumulative = 0;
            
            for (let type of filteredTypes) {
                cumulative += weights[type];
                if (random <= cumulative) {
                    return type;
                }
            }
            
            return filteredTypes[0] || 'energy';
        }

        function getTileSymbol(type) {
            const symbols = {
                'empty': '',
                'energy': 'üîÆ',
                'matter': 'üåü',
                'quantum': '‚ö°',
                'void': 'üï≥Ô∏è',
                'nexus': 'üíé'
            };
            return symbols[type] || '';
        }

        function activateTile(index) {
            if (!gameStarted || gameBoard[index].locked) return;
            
            const tile = document.querySelector(`[data-index="${index}"]`);
            const tileData = gameBoard[index];
            
            // Effet visuel d'activation
            tile.classList.add('active');
            setTimeout(() => tile.classList.remove('active'), 500);
            
            moves++;
            let actionResult = { points: 0, effects: [] };
            
            // Logique selon le type de tuile
            switch (tileData.type) {
                case 'energy':
                    actionResult = activateEnergyTile(index);
                    break;
                case 'matter':
                    actionResult = activateMatterTile(index);
                    break;
                case 'quantum':
                    actionResult = activateQuantumTile(index);
                    break;
                case 'void':
                    actionResult = activateVoidTile(index);
                    break;
                case 'nexus':
                    actionResult = activateNexusTile(index);
                    break;
            }
            
            // Appliquer les points
            score += actionResult.points;
            
            // V√©rifier les alignements et cha√Ænes
            const alignmentResult = checkAlignments(index);
            if (alignmentResult.found) {
                score += alignmentResult.bonus;
                actionResult.effects.push(`Alignement de ${alignmentResult.count}! +${alignmentResult.bonus} pts`);
            }
            
            // Consommer de l'√©nergie
            energy = Math.max(0, energy - 2);
            
            updateDisplay();
            
            // Afficher les r√©sultats de l'action
            let message = `${getTileSymbol(tileData.type)} `;
            if (actionResult.points > 0) {
                message += `+${actionResult.points} pts `;
            }
            if (actionResult.effects.length > 0) {
                message += actionResult.effects.join(', ');
            }
            
            showNotification(message, 'activation');
            
            // V√©rifier les objectifs apr√®s un d√©lai pour voir les effets
            setTimeout(() => checkObjectives(), 500);
        }

        function activateEnergyTile(index) {
            // Les tuiles d'√©nergie propagent leur effet aux tuiles adjacentes
            const adjacentIndices = getAdjacentIndices(index);
            let energyConnections = 0;
            
            adjacentIndices.forEach(adjIndex => {
                if (gameBoard[adjIndex].type === 'energy') {
                    const tile = document.querySelector(`[data-index="${adjIndex}"]`);
                    tile.classList.add('quantum-enhanced');
                    setTimeout(() => tile.classList.remove('quantum-enhanced'), 1000);
                    energyConnections++;
                }
            });
            
            const basePoints = 50;
            const points = basePoints * (1 + energyConnections * 0.5);
            currentCombo++;
            
            return {
                points: Math.round(points),
                effects: energyConnections > 0 ? [`${energyConnections} connexions d'√©nergie`] : ['√ânergie activ√©e']
            };
        }

        function activateMatterTile(index) {
            // Les tuiles de mati√®re sont stables mais donnent des bonus
            const basePoints = 75;
            const points = basePoints * (1 + currentCombo * 0.3);
            quantumParticles += 2;
            
            // Effet de stabilisation sur les tuiles adjacentes
            const adjacentIndices = getAdjacentIndices(index);
            let stabilized = 0;
            adjacentIndices.forEach(adjIndex => {
                if (gameBoard[adjIndex].locked) {
                    gameBoard[adjIndex].locked = false;
                    stabilized++;
                }
            });
            
            return {
                points: Math.round(points),
                effects: [`+2 particules Q`, stabilized > 0 ? `${stabilized} tuiles stabilis√©es` : 'Mati√®re stable'].filter(Boolean)
            };
        }

        function activateQuantumTile(index) {
            // Les tuiles quantiques ont des effets sp√©ciaux al√©atoires
            const effects = ['chain', 'transform', 'multiply', 'teleport'];
            const effect = effects[Math.floor(Math.random() * effects.length)];
            
            let effectDescription = '';
            let bonusPoints = 0;
            
            switch (effect) {
                case 'chain':
                    const chainResult = createChainReaction(index);
                    effectDescription = `Cha√Æne de ${chainResult.count} tuiles`;
                    bonusPoints = chainResult.bonus;
                    break;
                case 'transform':
                    const transformResult = transformAdjacentTiles(index);
                    effectDescription = `${transformResult.count} tuiles transform√©es`;
                    bonusPoints = transformResult.count * 50;
                    break;
                case 'multiply':
                    const multiplier = multiplyScore();
                    effectDescription = `Score x${multiplier}`;
                    bonusPoints = score * (multiplier - 1);
                    break;
                case 'teleport':
                    const teleportResult = teleportTile(index);
                    effectDescription = teleportResult.success ? 'T√©l√©portation r√©ussie' : 'T√©l√©portation √©chou√©e';
                    bonusPoints = teleportResult.success ? 100 : 0;
                    break;
            }
            
            const basePoints = 150;
            const points = basePoints * (1 + currentCombo * 0.8);
            currentCombo += 2;
            quantumParticles += 5;
            
            return {
                points: Math.round(points + bonusPoints),
                effects: [effectDescription, '+5 particules Q']
            };
        }

        function activateVoidTile(index) {
            // Les tuiles de vide absorbent l'√©nergie mais peuvent √™tre √©limin√©es
            energy = Math.max(0, energy - 10);
            
            // Chance d'√©liminer le vide avec assez d'√©nergie
            if (energy > 50 && Math.random() < 0.3) {
                const eliminateResult = eliminateVoid(index);
                return {
                    points: 300,
                    effects: ['Vide √©limin√©!', '+10 particules Q']
                };
            } else {
                return {
                    points: 0,
                    effects: ['Vide absorbe -10 √©nergie']
                };
            }
        }

        function activateNexusTile(index) {
            // Les tuiles nexus connectent et amplifient les effets
            const connectedTiles = findConnectedTiles(index);
            
            connectedTiles.forEach(tileIndex => {
                const tile = document.querySelector(`[data-index="${tileIndex}"]`);
                tile.classList.add('quantum-enhanced');
                gameBoard[tileIndex].active = true;
            });
            
            const points = 200 * connectedTiles.length;
            currentCombo += connectedTiles.length;
            chains++;
            
            return {
                points: points,
                effects: [`${connectedTiles.length} connexions √©tablies`, '+1 cha√Æne']
            };
        }

        function getAdjacentIndices(index) {
            const row = Math.floor(index / boardSize);
            const col = index % boardSize;
            const adjacent = [];
            
            // V√©rifier les 8 directions
            for (let dr = -1; dr <= 1; dr++) {
                for (let dc = -1; dc <= 1; dc++) {
                    if (dr === 0 && dc === 0) continue;
                    
                    const newRow = row + dr;
                    const newCol = col + dc;
                    
                    if (newRow >= 0 && newRow < boardSize && newCol >= 0 && newCol < boardSize) {
                        adjacent.push(newRow * boardSize + newCol);
                    }
                }
            }
            
            return adjacent;
        }

        function checkAlignments(index) {
            const tileType = gameBoard[index].type;
            const alignments = findAlignments(index, tileType);
            
            if (alignments.length >= 3) {
                // Alignement trouv√©!
                const bonus = alignments.length * 100 * (1 + currentCombo);
                currentCombo++;
                maxCombo = Math.max(maxCombo, currentCombo);
                
                // Effet visuel
                alignments.forEach(alignIndex => {
                    const tile = document.querySelector(`[data-index="${alignIndex}"]`);
                    tile.classList.add('quantum-enhanced');
                });
                
                showComboEffect(alignments.length);
                
                return {
                    found: true,
                    count: alignments.length,
                    bonus: bonus
                };
            } else {
                currentCombo = 0;
                return {
                    found: false,
                    count: 0,
                    bonus: 0
                };
            }
        }

        function findAlignments(index, tileType) {
            const row = Math.floor(index / boardSize);
            const col = index % boardSize;
            let aligned = [index];
            
            // V√©rifier horizontalement
            let left = col - 1;
            while (left >= 0 && gameBoard[row * boardSize + left].type === tileType) {
                aligned.push(row * boardSize + left);
                left--;
            }
            
            let right = col + 1;
            while (right < boardSize && gameBoard[row * boardSize + right].type === tileType) {
                aligned.push(row * boardSize + right);
                right++;
            }
            
            // V√©rifier verticalement
            let up = row - 1;
            while (up >= 0 && gameBoard[up * boardSize + col].type === tileType) {
                aligned.push(up * boardSize + col);
                up--;
            }
            
            let down = row + 1;
            while (down < boardSize && gameBoard[down * boardSize + col].type === tileType) {
                aligned.push(down * boardSize + col);
                down++;
            }
            
            return [...new Set(aligned)]; // Supprimer les doublons
        }

        function createChainReaction(startIndex) {
            const reactionTiles = [];
            const visited = new Set();
            const queue = [startIndex];
            
            while (queue.length > 0 && reactionTiles.length < 10) {
                const currentIndex = queue.shift();
                if (visited.has(currentIndex)) continue;
                
                visited.add(currentIndex);
                reactionTiles.push(currentIndex);
                
                const adjacent = getAdjacentIndices(currentIndex);
                adjacent.forEach(adjIndex => {
                    if (!visited.has(adjIndex) && 
                        (gameBoard[adjIndex].type === 'energy' || gameBoard[adjIndex].type === 'quantum')) {
                        queue.push(adjIndex);
                    }
                });
            }
            
            // Animer la r√©action en cha√Æne
            reactionTiles.forEach((tileIndex, i) => {
                setTimeout(() => {
                    const tile = document.querySelector(`[data-index="${tileIndex}"]`);
                    tile.classList.add('quantum-enhanced');
                    createExplosionEffect(tile);
                }, i * 200);
            });
            
            chains++;
            const chainBonus = reactionTiles.length * 200;
            
            return {
                count: reactionTiles.length,
                bonus: chainBonus
            };
        }

        function transformAdjacentTiles(index) {
            const adjacent = getAdjacentIndices(index);
            const newType = 'quantum';
            let transformedCount = 0;
            
            adjacent.forEach(adjIndex => {
                if (gameBoard[adjIndex].type !== 'void' && gameBoard[adjIndex].type !== 'nexus') {
                    gameBoard[adjIndex].type = newType;
                    const tile = document.querySelector(`[data-index="${adjIndex}"]`);
                    tile.dataset.type = newType;
                    tile.className = `quantum-tile tile-${newType}`;
                    tile.innerHTML = getTileSymbol(newType);
                    
                    // Effet de transformation
                    tile.style.transform = 'scale(1.3) rotate(360deg)';
                    setTimeout(() => {
                        tile.style.transform = '';
                    }, 500);
                    
                    transformedCount++;
                }
            });
            
            return {
                count: transformedCount
            };
        }

        function multiplyScore() {
            const multiplier = 2 + Math.floor(currentCombo / 3);
            return multiplier;
        }

        function teleportTile(index) {
            // T√©l√©porter la tuile vers une position al√©atoire
            const emptyIndices = [];
            for (let i = 0; i < gameBoard.length; i++) {
                if (gameBoard[i].type === 'empty' || i === index) {
                    emptyIndices.push(i);
                }
            }
            
            if (emptyIndices.length > 1) {
                const targetIndex = emptyIndices[Math.floor(Math.random() * emptyIndices.length)];
                if (targetIndex !== index) {
                    // √âchanger les tuiles
                    const tempType = gameBoard[index].type;
                    gameBoard[index] = { ...gameBoard[targetIndex] };
                    gameBoard[targetIndex] = { type: tempType, active: false, locked: false };
                    
                    // Mettre √† jour visuellement
                    updateTileVisual(index);
                    updateTileVisual(targetIndex);
                    
                    return { success: true };
                }
            }
            
            return { success: false };
        }

        function eliminateVoid(index) {
            gameBoard[index].type = 'energy';
            updateTileVisual(index);
            
            score += 300;
            quantumParticles += 10;
            
            createEliminationEffect(index);
            showNotification(`üí• Vide √©limin√©! +300 points!`, 'eliminate');
        }

        function findConnectedTiles(nexusIndex) {
            const connected = [];
            const nexusType = gameBoard[nexusIndex].type;
            
            // Recherche en profondeur pour trouver les tuiles connect√©es
            const visited = new Set();
            const stack = [nexusIndex];
            
            while (stack.length > 0) {
                const currentIndex = stack.pop();
                if (visited.has(currentIndex)) continue;
                
                visited.add(currentIndex);
                connected.push(currentIndex);
                
                const adjacent = getAdjacentIndices(currentIndex);
                adjacent.forEach(adjIndex => {
                    if (!visited.has(adjIndex) && 
                        (gameBoard[adjIndex].type === nexusType || 
                         gameBoard[adjIndex].type === 'energy' ||
                         gameBoard[adjIndex].type === 'quantum')) {
                        stack.push(adjIndex);
                    }
                });
            }
            
            return connected;
        }

        function updateTileVisual(index) {
            const tile = document.querySelector(`[data-index="${index}"]`);
            const tileData = gameBoard[index];
            
            tile.dataset.type = tileData.type;
            tile.className = `quantum-tile tile-${tileData.type}`;
            tile.innerHTML = getTileSymbol(tileData.type);
        }

        function startNewGame() {
            gameStarted = true;
            score = 0;
            moves = 0;
            currentCombo = 0;
            maxCombo = 0;
            energy = 100;
            quantumParticles = 0;
            chains = 0;
            
            initializeGame();
            
            // D√©marrer le timer si n√©cessaire
            const config = levelConfig[currentLevel];
            if (config.timeLimit) {
                startGameTimer(config.timeLimit);
            }
            
            showNotification("üöÄ Nouvelle partie quantique commenc√©e! Manipulez la r√©alit√©!", 'start');
        }

        function resetGame() {
            if (gameTimer) {
                clearInterval(gameTimer);
                gameTimer = null;
            }
            
            gameStarted = false;
            initializeGame();
            showNotification("üîÑ Jeu r√©initialis√©!", 'reset');
        }

        function startGameTimer(seconds) {
            timeRemaining = seconds;
            
            gameTimer = setInterval(() => {
                timeRemaining--;
                updateTimeDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(gameTimer);
                    endGame('timeout');
                }
            }, 1000);
        }

        function updateTimeDisplay() {
            const timeElement = document.getElementById('timeRemaining');
            if (timeRemaining === null) {
                timeElement.textContent = '‚àû';
            } else {
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                timeElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeRemaining <= 30) {
                    timeElement.style.color = '#ff6b6b';
                } else if (timeRemaining <= 60) {
                    timeElement.style.color = '#feca57';
                } else {
                    timeElement.style.color = '#00ff88';
                }
            }
        }

        function activateAIHint() {
            if (aiHintActive || energy < 30) {
                showNotification("‚ö†Ô∏è √ânergie insuffisante pour l'assistant IA!", 'warning');
                return;
            }
            
            aiHintActive = true;
            energy -= 30;
            
            // Afficher l'assistant IA
            const aiAssistant = document.getElementById('aiAssistant');
            const aiSuggestion = document.getElementById('aiSuggestion');
            
            aiAssistant.style.display = 'block';
            aiSuggestion.textContent = 'Analyse des patterns quantiques...';
            
            setTimeout(() => {
                const hint = generateAIHint();
                aiSuggestion.textContent = hint;
                
                // Mettre en √©vidence les tuiles sugg√©r√©es
                highlightSuggestedTiles();
                
                showNotification("ü§ñ Assistant IA activ√©! Suivez les suggestions quantiques!", 'ai');
                
                setTimeout(() => {
                    aiAssistant.style.display = 'none';
                    aiHintActive = false;
                }, 5000);
            }, 2000);
            
            updateDisplay();
        }

        function generateAIHint() {
            const hints = [
                "Cherchez des alignements d'√©nergie dans le coin sup√©rieur",
                "Activez les tuiles quantiques pour des r√©actions en cha√Æne",
                "Les nexus peuvent connecter des zones distantes",
                "√âliminez les vides avec des tuiles d'√©nergie adjacentes",
                "Cr√©ez des combos en activant des tuiles similaires",
                "Les tuiles de mati√®re stabilisent les zones chaotiques"
            ];
            
            return hints[Math.floor(Math.random() * hints.length)];
        }

        function highlightSuggestedTiles() {
            // Mettre en √©vidence quelques tuiles strat√©giques
            const energyTiles = [];
            const quantumTiles = [];
            
            gameBoard.forEach((tile, index) => {
                if (tile.type === 'energy') energyTiles.push(index);
                if (tile.type === 'quantum') quantumTiles.push(index);
            });
            
            // S√©lectionner quelques tuiles √† mettre en √©vidence
            const tilesToHighlight = [
                ...energyTiles.slice(0, 2),
                ...quantumTiles.slice(0, 1)
            ];
            
            tilesToHighlight.forEach(index => {
                const tile = document.querySelector(`[data-index="${index}"]`);
                tile.style.border = '3px solid #ffff00';
                tile.style.boxShadow = '0 0 20px #ffff00';
                
                setTimeout(() => {
                    tile.style.border = '';
                    tile.style.boxShadow = '';
                }, 5000);
            });
        }

        function activateQuantumBoost() {
            if (quantumBoostActive || energy < 50) {
                showNotification("‚ö†Ô∏è √ânergie insuffisante pour le boost quantique!", 'warning');
                return;
            }
            
            quantumBoostActive = true;
            energy -= 50;
            
            // Effet visuel sur toutes les tuiles
            document.querySelectorAll('.quantum-tile').forEach(tile => {
                tile.classList.add('quantum-enhanced');
            });
            
            // Multiplier les effets pendant 10 secondes
            setTimeout(() => {
                quantumBoostActive = false;
                document.querySelectorAll('.quantum-tile').forEach(tile => {
                    tile.classList.remove('quantum-enhanced');
                });
                showNotification("‚ö° Boost quantique termin√©!", 'info');
            }, 10000);
            
            showNotification("‚ö° Boost quantique activ√©! Tous les effets sont amplifi√©s!", 'boost');
            updateDisplay();
        }

        function showSolution() {
            if (!gameStarted) {
                showNotification("‚ö†Ô∏è Commencez d'abord une partie!", 'warning');
                return;
            }
            
            // Analyser le plateau et trouver la meilleure s√©quence
            const solution = findOptimalSolution();
            
            if (solution.length === 0) {
                showNotification("ü§î Aucune solution optimale d√©tect√©e. Continuez √† explorer!", 'info');
                return;
            }
            
            // Afficher la solution √©tape par √©tape avec explications
            showNotification(`üí° Solution IA trouv√©e! ${solution.length} √©tapes recommand√©es.`, 'solution');
            
            // Afficher l'explication de la strat√©gie
            const config = levelConfig[currentLevel];
            let strategyExplanation = '';
            
            switch (config.objective) {
                case 'align3':
                    strategyExplanation = 'Strat√©gie: Cr√©er des alignements d\'√©nergie pour atteindre 500 points';
                    break;
                case 'chain5':
                    strategyExplanation = 'Strat√©gie: Utiliser les tuiles quantiques pour cr√©er 2 cha√Ænes de r√©action';
                    break;
                case 'nexus3':
                    strategyExplanation = 'Strat√©gie: Activer 3 nexus pour √©tablir des connexions puissantes';
                    break;
                case 'clearVoids':
                    strategyExplanation = 'Strat√©gie: √âliminer tous les vides avec des tuiles d\'√©nergie adjacentes';
                    break;
                case 'transcend':
                    strategyExplanation = 'Strat√©gie: Combiner nexus et quantum pour 5000 pts + combo de 5';
                    break;
            }
            
            setTimeout(() => {
                showNotification(`üéØ ${strategyExplanation}`, 'ai');
            }, 1000);
            
            solution.forEach((step, index) => {
                setTimeout(() => {
                    const tile = document.querySelector(`[data-index="${step.index}"]`);
                    if (tile) {
                        // Effet visuel sp√©cial pour la solution
                        tile.style.border = '3px solid #ffff00';
                        tile.style.boxShadow = '0 0 25px #ffff00';
                        tile.style.animation = 'solutionPulse 2s ease-in-out infinite';
                        
                        // Afficher le num√©ro d'√©tape et la raison
                        const stepIndicator = document.createElement('div');
                        stepIndicator.textContent = index + 1;
                        stepIndicator.style.cssText = `
                            position: absolute;
                            top: -5px;
                            right: -5px;
                            background: #ffff00;
                            color: #000;
                            border-radius: 50%;
                            width: 20px;
                            height: 20px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 0.8rem;
                            font-weight: bold;
                            z-index: 100;
                        `;
                        tile.appendChild(stepIndicator);
                        
                        // Afficher la raison de cette √©tape
                        setTimeout(() => {
                            showNotification(`√âtape ${index + 1}: ${step.reason}`, 'ai');
                        }, 200);
                        
                        // Nettoyer apr√®s 10 secondes
                        setTimeout(() => {
                            tile.style.border = '';
                            tile.style.boxShadow = '';
                            tile.style.animation = '';
                            if (stepIndicator.parentNode) {
                                stepIndicator.remove();
                            }
                        }, 10000);
                    }
                }, index * 1000);
            });
            
            updateDisplay();
        }

        function findOptimalSolution() {
            const config = levelConfig[currentLevel];
            const solution = [];
            
            switch (config.objective) {
                case 'align3':
                    solution.push(...findAlignmentSolution());
                    break;
                case 'chain5':
                    solution.push(...findChainSolution());
                    break;
                case 'nexus3':
                    solution.push(...findNexusSolution());
                    break;
                case 'clearVoids':
                    solution.push(...findVoidClearSolution());
                    break;
                case 'transcend':
                    solution.push(...findTranscendentSolution());
                    break;
            }
            
            return solution.slice(0, 5); // Limiter √† 5 √©tapes max
        }

        function findAlignmentSolution() {
            const solution = [];
            
            // Chercher les tuiles d'√©nergie qui peuvent former des alignements
            for (let i = 0; i < gameBoard.length; i++) {
                if (gameBoard[i].type === 'energy') {
                    const alignments = findAlignments(i, 'energy');
                    if (alignments.length >= 2) {
                        solution.push({ index: i, reason: 'Cr√©er alignement d\'√©nergie' });
                        break;
                    }
                }
            }
            
            // Ajouter des tuiles quantiques pour amplifier
            for (let i = 0; i < gameBoard.length && solution.length < 3; i++) {
                if (gameBoard[i].type === 'quantum') {
                    solution.push({ index: i, reason: 'Amplifier avec quantum' });
                }
            }
            
            return solution;
        }

        function findChainSolution() {
            const solution = [];
            
            // Chercher les tuiles quantiques pour d√©marrer des cha√Ænes
            for (let i = 0; i < gameBoard.length; i++) {
                if (gameBoard[i].type === 'quantum') {
                    const adjacent = getAdjacentIndices(i);
                    const energyAdjacent = adjacent.filter(idx => gameBoard[idx].type === 'energy');
                    
                    if (energyAdjacent.length >= 2) {
                        solution.push({ index: i, reason: 'D√©marrer cha√Æne quantique' });
                        energyAdjacent.slice(0, 2).forEach(idx => {
                            solution.push({ index: idx, reason: 'Propager cha√Æne' });
                        });
                        break;
                    }
                }
            }
            
            return solution;
        }

        function findNexusSolution() {
            const solution = [];
            
            // Trouver tous les nexus
            for (let i = 0; i < gameBoard.length; i++) {
                if (gameBoard[i].type === 'nexus') {
                    solution.push({ index: i, reason: 'Activer nexus' });
                    if (solution.length >= 3) break;
                }
            }
            
            return solution;
        }

        function findVoidClearSolution() {
            const solution = [];
            
            // Trouver les vides et les tuiles d'√©nergie adjacentes
            for (let i = 0; i < gameBoard.length; i++) {
                if (gameBoard[i].type === 'void') {
                    const adjacent = getAdjacentIndices(i);
                    const energyAdjacent = adjacent.find(idx => gameBoard[idx].type === 'energy');
                    
                    if (energyAdjacent !== undefined) {
                        solution.push({ index: energyAdjacent, reason: '√âliminer vide adjacent' });
                    }
                }
            }
            
            return solution;
        }

        function findTranscendentSolution() {
            const solution = [];
            
            // Strat√©gie complexe : combiner plusieurs types
            const quantumTiles = [];
            const energyTiles = [];
            const nexusTiles = [];
            
            for (let i = 0; i < gameBoard.length; i++) {
                if (gameBoard[i].type === 'quantum') quantumTiles.push(i);
                if (gameBoard[i].type === 'energy') energyTiles.push(i);
                if (gameBoard[i].type === 'nexus') nexusTiles.push(i);
            }
            
            // Prioriser les nexus, puis quantum, puis √©nergie
            solution.push(...nexusTiles.slice(0, 2).map(idx => ({ index: idx, reason: 'Nexus transcendant' })));
            solution.push(...quantumTiles.slice(0, 2).map(idx => ({ index: idx, reason: 'Quantum transcendant' })));
            solution.push(...energyTiles.slice(0, 1).map(idx => ({ index: idx, reason: '√ânergie transcendante' })));
            
            return solution;
        }

        function updateObjectiveDisplay() {
            const t = translations[currentLanguage];
            const config = levelConfig[currentLevel];
            const objectiveText = t.objectives[currentLevel - 1] || t.objectives[0];
            
            document.getElementById('currentObjective').textContent = objectiveText;
        }

        function checkObjectives() {
            const config = levelConfig[currentLevel];
            let objectiveComplete = false;
            let progressMessage = '';
            
            switch (config.objective) {
                case 'align3':
                    // V√©rifier s'il y a des alignements de 3+
                    objectiveComplete = score >= 500; // Plus r√©aliste
                    progressMessage = `Score: ${score}/500`;
                    break;
                case 'chain5':
                    // V√©rifier si une cha√Æne de 5+ a √©t√© cr√©√©e
                    objectiveComplete = chains >= 2;
                    progressMessage = `Cha√Ænes: ${chains}/2`;
                    break;
                case 'nexus3':
                    // V√©rifier si 3 nexus ont √©t√© activ√©s
                    const activatedNexus = countActivatedNexus();
                    objectiveComplete = activatedNexus >= 3;
                    progressMessage = `Nexus activ√©s: ${activatedNexus}/3`;
                    break;
                case 'clearVoids':
                    // V√©rifier si tous les vides ont √©t√© √©limin√©s
                    const remainingVoids = gameBoard.filter(tile => tile.type === 'void').length;
                    objectiveComplete = remainingVoids === 0;
                    progressMessage = `Vides restants: ${remainingVoids}`;
                    break;
                case 'transcend':
                    // Objectif complexe bas√© sur le score et les combos
                    objectiveComplete = score >= 5000 && maxCombo >= 5;
                    progressMessage = `Score: ${score}/5000, Combo: ${maxCombo}/5`;
                    break;
            }
            
            // Afficher le progr√®s
            if (moves % 5 === 0 && moves > 0) { // Afficher le progr√®s tous les 5 mouvements
                showNotification(`üìä Progr√®s: ${progressMessage}`, 'info');
            }
            
            if (objectiveComplete) {
                setTimeout(() => endGame('victory'), 1000); // D√©lai pour voir les effets
            }
            
            // Mettre √† jour la barre de progression
            updateProgressBar();
        }

        function checkForAlignments(minLength) {
            for (let i = 0; i < gameBoard.length; i++) {
                const alignments = findAlignments(i, gameBoard[i].type);
                if (alignments.length >= minLength) {
                    return true;
                }
            }
            return false;
        }

        function countActivatedNexus() {
            return gameBoard.filter(tile => tile.type === 'nexus' && tile.active).length;
        }

        function updateProgressBar() {
            const config = levelConfig[currentLevel];
            let progress = 0;
            
            switch (config.objective) {
                case 'align3':
                    progress = Math.min(100, (score / 1000) * 100);
                    break;
                case 'chain5':
                    progress = Math.min(100, (chains / 1) * 100);
                    break;
                case 'nexus3':
                    progress = Math.min(100, (countActivatedNexus() / 3) * 100);
                    break;
                case 'clearVoids':
                    const totalVoids = levelConfig[currentLevel].size * levelConfig[currentLevel].size * 0.1;
                    const remainingVoids = gameBoard.filter(tile => tile.type === 'void').length;
                    progress = Math.min(100, ((totalVoids - remainingVoids) / totalVoids) * 100);
                    break;
                case 'transcend':
                    const scoreProgress = Math.min(50, (score / 10000) * 50);
                    const comboProgress = Math.min(50, (maxCombo / 10) * 50);
                    progress = scoreProgress + comboProgress;
                    break;
            }
            
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function endGame(reason) {
            gameStarted = false;
            
            if (gameTimer) {
                clearInterval(gameTimer);
                gameTimer = null;
            }
            
            const efficiency = moves > 0 ? Math.round((score / moves) * 100) / 100 : 0;
            
            showGameOverModal({
                reason: reason,
                score: score,
                level: currentLevel,
                moves: moves,
                efficiency: efficiency,
                maxCombo: maxCombo,
                chains: chains,
                quantumParticles: quantumParticles
            });
        }

        function updateDisplay() {
            // Score avec animation
            const scoreElement = document.getElementById('score');
            const oldScore = parseInt(scoreElement.textContent.replace(/[^\d]/g, '')) || 0;
            
            if (score > oldScore) {
                scoreElement.style.transform = 'scale(1.2)';
                scoreElement.style.color = '#00ff88';
                setTimeout(() => {
                    scoreElement.style.transform = 'scale(1)';
                    scoreElement.style.color = 'inherit';
                }, 300);
            }
            
            scoreElement.textContent = score.toLocaleString();
            
            document.getElementById('currentLevel').textContent = currentLevel;
            document.getElementById('moves').textContent = moves;
            document.getElementById('maxCombo').textContent = maxCombo;
            document.getElementById('currentCombo').textContent = currentCombo;
            document.getElementById('quantumParticles').textContent = quantumParticles;
            document.getElementById('chains').textContent = chains;
            
            // √ânergie
            const energyElement = document.getElementById('energy');
            energyElement.textContent = energy + '%';
            if (energy >= 80) {
                energyElement.style.color = '#00ff88';
            } else if (energy >= 40) {
                energyElement.style.color = '#feca57';
            } else {
                energyElement.style.color = '#ff6b6b';
            }
            
            // Efficacit√©
            const efficiency = moves > 0 ? Math.round((score / moves) * 100) / 100 : 0;
            document.getElementById('efficiency').textContent = efficiency + '%';
            
            // Rang bas√© sur le score
            const t = translations[currentLanguage];
            let rank = t.ranks[0]; // Novice
            if (score >= 50000) rank = t.ranks[5]; // Transcendant
            else if (score >= 20000) rank = t.ranks[4]; // Ma√Ætre
            else if (score >= 10000) rank = t.ranks[3]; // Expert
            else if (score >= 5000) rank = t.ranks[2]; // Adepte
            else if (score >= 1000) rank = t.ranks[1]; // Apprenti
            
            document.getElementById('rank').textContent = rank;
            
            // Mettre √† jour l'affichage du temps
            updateTimeDisplay();
        }

        function showRules() {
            const modal = document.getElementById('rulesModal');
            const t = translations[currentLanguage];
            
            document.getElementById('rulesTitle').textContent = t.rulesTitle;
            document.getElementById('rulesContent').innerHTML = t.rulesContent;
            
            modal.style.display = 'block';
        }

        function hideRules() {
            document.getElementById('rulesModal').style.display = 'none';
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            
            let bgColor = 'linear-gradient(45deg, #1a0033, #330066)';
            if (type === 'success' || type === 'combo') bgColor = 'linear-gradient(45deg, #00ff88, #00cc6a)';
            else if (type === 'warning') bgColor = 'linear-gradient(45deg, #ffa500, #ff8c00)';
            else if (type === 'ai') bgColor = 'linear-gradient(45deg, #9c27b0, #673ab7)';
            else if (type === 'boost') bgColor = 'linear-gradient(45deg, #00ffff, #0099cc)';
            else if (type === 'activation') bgColor = 'linear-gradient(45deg, #e94560, #f27121)';
            else if (type === 'chain') bgColor = 'linear-gradient(45deg, #ffff00, #ff8800)';
            else if (type === 'nexus') bgColor = 'linear-gradient(45deg, #ffffff, #cccccc)';
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${bgColor};
                color: ${type === 'nexus' ? '#000' : 'white'};
                padding: 15px 20px;
                border-radius: 15px;
                border: 2px solid #00ffff;
                box-shadow: 0 6px 25px rgba(0, 255, 255, 0.4);
                z-index: 1000;
                max-width: 350px;
                font-size: 1rem;
                animation: slideIn 0.3s ease-out;
            `;
            
            notification.innerHTML = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        function showComboEffect(comboSize) {
            const comboIndicator = document.getElementById('comboIndicator');
            comboIndicator.textContent = `COMBO x${comboSize}!`;
            comboIndicator.style.display = 'block';
            
            setTimeout(() => {
                comboIndicator.style.display = 'none';
            }, 1000);
        }

        function createExplosionEffect(tile) {
            const effect = document.createElement('div');
            effect.innerHTML = 'üí•';
            effect.style.cssText = `
                position: absolute;
                left: ${tile.offsetLeft + 15}px;
                top: ${tile.offsetTop + 15}px;
                font-size: 2rem;
                pointer-events: none;
                z-index: 200;
                animation: explosionEffect 1s ease-out forwards;
            `;
            
            tile.parentElement.appendChild(effect);
            setTimeout(() => effect.remove(), 1000);
        }

        function createEliminationEffect(index) {
            const tile = document.querySelector(`[data-index="${index}"]`);
            const effect = document.createElement('div');
            effect.innerHTML = '‚ú®üí´‚ú®';
            effect.style.cssText = `
                position: absolute;
                left: ${tile.offsetLeft}px;
                top: ${tile.offsetTop}px;
                font-size: 1.5rem;
                pointer-events: none;
                z-index: 200;
                animation: eliminationEffect 1.5s ease-out forwards;
            `;
            
            tile.parentElement.appendChild(effect);
            setTimeout(() => effect.remove(), 1500);
        }

        function showGameOverModal(stats) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            
            const t = translations[currentLanguage];
            const resultText = stats.reason === 'victory' ? 'üèÜ Victoire Quantique!' : 
                              stats.reason === 'timeout' ? '‚è∞ Temps √âcoul√©!' : 'üéÆ Partie Termin√©e!';
            const resultColor = stats.reason === 'victory' ? '#00ff88' : '#feca57';
            
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="close-btn" onclick="this.parentElement.parentElement.remove()">&times;</button>
                    <h2 style="color: ${resultColor}; text-align: center; margin-bottom: 10px;">üîÆ Quantum Tiles</h2>
                    <p style="text-align: center; margin-bottom: 30px; color: #feca57; font-size: 1.5rem;">${resultText}</p>
                    
                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-item">
                            <div>Score Final</div>
                            <div style="font-size: 1.8rem; color: #00ff88;">${stats.score.toLocaleString()}</div>
                        </div>
                        <div class="stat-item">
                            <div>Efficacit√©</div>
                            <div style="color: ${stats.efficiency >= 100 ? '#00ff88' : stats.efficiency >= 50 ? '#feca57' : '#ff6b6b'}">${stats.efficiency}%</div>
                        </div>
                        <div class="stat-item">
                            <div>Combo Maximum</div>
                            <div style="color: #ffd700;">${stats.maxCombo}</div>
                        </div>
                        <div class="stat-item">
                            <div>Mouvements</div>
                            <div>${stats.moves}</div>
                        </div>
                        <div class="stat-item">
                            <div>Cha√Ænes Cr√©√©es</div>
                            <div style="color: #ff00ff;">${stats.chains}</div>
                        </div>
                        <div class="stat-item">
                            <div>Particules Q</div>
                            <div style="color: #00ffff;">${stats.quantumParticles}</div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="startNewGame(); this.parentElement.parentElement.parentElement.remove();" 
                                style="background: linear-gradient(45deg, #00ff88, #00cc6a); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; font-size: 1.1rem;">
                            üöÄ Nouvelle Partie
                        </button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove();" 
                                style="background: linear-gradient(45deg, #660099, #9900cc); color: white; border: none; padding: 15px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; font-size: 1.1rem;">
                            üè† Menu Principal
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Styles d'animation suppl√©mentaires
        const additionalStyles = `
            @keyframes slideIn {
                0% { transform: translateX(100%); opacity: 0; }
                100% { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOut {
                0% { transform: translateX(0); opacity: 1; }
                100% { transform: translateX(100%); opacity: 0; }
            }
            
            @keyframes explosionEffect {
                0% { transform: scale(0.5); opacity: 1; }
                50% { transform: scale(1.5); opacity: 0.8; }
                100% { transform: scale(2); opacity: 0; }
            }
            
            @keyframes eliminationEffect {
                0% { transform: scale(1) rotate(0deg); opacity: 1; }
                50% { transform: scale(1.5) rotate(180deg); opacity: 0.8; }
                100% { transform: scale(2) rotate(360deg); opacity: 0; }
            }
            
            @keyframes solutionPulse {
                0%, 100% { transform: scale(1); box-shadow: 0 0 25px #ffff00; }
                50% { transform: scale(1.05); box-shadow: 0 0 35px #ffff00, 0 0 50px #ffff00; }
            }
        `;
        
        const styleSheet = document.createElement('style');
        styleSheet.textContent = additionalStyles;
        document.head.appendChild(styleSheet);

        // R√©g√©n√©ration d'√©nergie automatique
        setInterval(() => {
            if (gameStarted && energy < 100) {
                energy = Math.min(100, energy + 2);
                updateDisplay();
            }
        }, 2000);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'987a11b203ae1f97',t:'MTc1OTMwMTg4MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
